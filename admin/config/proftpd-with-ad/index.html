<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Setting up ProFTPd for galaxy uploads in an Active Directory environment - Galaxy Community Hub</title><meta name="gridsome:hash" content="64a9e8afa68c1466f7ef441294c96aecf9a68066"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="All about Galaxy and its community."><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.7d4a227415c9d9b704d56a079d49a3e1.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.7d4a227415c9d9b704d56a079d49a3e1.png"><link rel="preload" href="/assets/css/0.styles.5b1099da.css" as="style"><link rel="preload" href="/assets/js/app.6a2146ae.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--article-vue.59a31f82.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.9b913011.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-vue.b9d631d5.js"><link rel="prefetch" href="/assets/js/page--src--pages--careers-vue.7bdfa9aa.js"><link rel="prefetch" href="/assets/js/page--src--pages--data-explorer-vue.50f81452.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--archive-vue.bdcb994f.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--cofests--papercuts-vue.9624a935.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--cofests-vue.3da6c251.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--webinars-vue.4cf7aa8a.js"><link rel="prefetch" href="/assets/js/page--src--pages--events-vue.3f22c4a9.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.8b7e39d4.js"><link rel="prefetch" href="/assets/js/page--src--pages--news-vue.357930b0.js"><link rel="prefetch" href="/assets/js/page--src--pages--search-vue.1a4d1477.js"><link rel="prefetch" href="/assets/js/page--src--pages--tests-vue.093ab612.js"><link rel="prefetch" href="/assets/js/page--src--pages--use-vue.c890644b.js"><link rel="prefetch" href="/assets/js/page--src--templates--platform-vue.0db261b0.js"><link rel="prefetch" href="/assets/js/page--src--templates--vue-article-vue.454443f9.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--careers-vue~page--src--pages--use-vue~page--src--templates--article-vue~pa~efade918.c3041708.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--search-vue.5670e8f9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--index-md.7ef1364e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--md--imgtests--imgdir--index-md.2e934c33.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--partials--index-md.eeba3cb6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--imgtests--imgdir--index-md.92886b7f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--imgtests--index-md.eab5717f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--index-md.e1baaf22.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--syntaxtests--index-md.861c549e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--syntaxtests--reldir--index-md.aa6f3c64.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--capacity-planning--index-md.bfc3219e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--config--index-md.bec55add.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--config--performance--cluster--legacy--index-md.e37560d2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--datatypes--index-md.534701f8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--disk-quotas--index-md.33c98ae0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--faq--index-md.8a142c3e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--internals--data-model--index-md.dbe6d521.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--internals--galaxy-ops--index-md.ae261eb0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--ten-simple-steps-galaxy-as-a-service--index-md.7f58c8af.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--tools--tool-config-syntax--index-md.cd8060f8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--tools--writing-tests--index-md.67221f9c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--allocation--index-md.de0ec1f4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--faq--index-md.4669ecb3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--index-md.cf67f110.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--ssh--index-md.0e243102.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--troubleshooting--index-md.35efbe50.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--capacity-planning--index-md.dc90802a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--getting-started--index-md.2ca2f401.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--index-md.8415a706.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--building--index-md.d98aeff8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--capacity-planning--index-md.4510948e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--cluster-types--index-md.cac4089c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--customizing--index-md.e2b286b6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--faq--index-md.2b285c3a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--getting-started--index-md.ea2ebc17.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--getting-started--pre-201703--index-md.11c5fe6a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--hadoop--index-md.bb206ee6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--ht-condor--index-md.9da34f44.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--index-md.233a66d8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--openstack--index-md.ab85a30a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--services--index-md.10c9f181.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--sharing--index-md.d6d1b6d6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--troubleshooting--index-md.9c79821f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--userdata--index-md.53f02454.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--future--index-md.57f97361.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--index-md.9651e1c9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-07-09--index-md.ad9dcbc5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-07-27--index-md.7471bbe4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-09-19--index-md.e1e5e8d8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-11-14--index-md.9f83078a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-01-16--index-md.4539d357.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-03-20--index-md.70ed6c95.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-05-15--index-md.4688a0b3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-11-20--index-md.f2ba774b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-02-19--index-md.79bdf65d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-04-16--index-md.4a242376.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-06-18--index-md.440620d8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-08-20--index-md.376ae2ed.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-10-15--index-md.27dc34e9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-02-18--index-md.fdb95229.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-04-21--index-md.f92b0f6d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-06-16--index-md.fe11d204.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-08-18--index-md.f52ed1f8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--index-md.9f7dc20a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--webinar-tech--index-md.d949fe23.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--2012--index-md.c7266273.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--2014--index-md.e4286fb0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--index-md.d66e06d1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--data--index-md.20e48791.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--datafiles--index-md.2d10c564.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--architecture--index-md.4629c460.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--bitbucket--index-md.74b0114b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--css--index-md.657cefe3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--getting-started--index-md.328bffc8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--index-md.09543e4e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--jsa--index-md.6375449f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--mercurial--index-md.86dc9b7b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--security-tool-tips--index-md.f4faf0d9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--galaxy-project--index-md.3e02395c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--index-md.4d9d00ba.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--papers--index-md.c7f4278a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--posters--index-md.75155b75.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--presentations--index-md.28312b2f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--videos--index-md.53f176ff.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--advanced-session--index-md.6bd7cd89.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--basics-session--index-md.a7aa2234.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--index-md.881dccf2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--logistics--index-md.1a0b965f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--publicity--index-md.5fc8d7c6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--registration--index-md.a85019e7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--abstracts--index-md.f45d8543.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--index-md.41cde30b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--key-dates--index-md.eb4461fb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--lightning-talks--index-md.416549ba.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--logistics--index-md.a40269b5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--organizing-committee--index-md.b5fc35e6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--photos--index-md.a9d9d78d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--automation-strategies--index-md.53a84cb2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--bioinformatics-training--index-md.5576edcf.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--end-users--index-md.0b5fa62e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--workflows-and-api--index-md.03c0504a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--index-md.b8fa162b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--promotion--index-md.f38b09af.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--register--index-md.f4320c18.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--sponsorships--index-md.3e9b6ca4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--training-day--index-md.30df8ca8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--index-md.53afc104.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--posters--index-md.5a1c5bbd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--talks--index-md.24bf003b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--clinical-use-hpc-file-systems--index-md.54a9c0d6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-admins--index-md.4e804331.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-blast--index-md.5d5d7573.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-professionals--index-md.ee96dc73.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--index-md.e819dfd1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--proteomics--index-md.adb5209b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--public-galaxy-servers--index-md.5b535d3b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--tool-developers--index-md.934ab089.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--index-md.fc9e5d60.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--key-dates--index-md.9feb96c8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--lightning--index-md.986b956c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--logistics--index-md.aafc45da.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--organizers--index-md.8129c4fe.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--photos--index-md.9f48888b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--program--index-md.afd0b377.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--promotion--index-md.84a5ce7a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--register--index-md.e8a8cb9e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--sponsorships--index-md.f3562bcc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--advance-tool-data--index-md.f69ec61d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--api--index-md.e7ae288d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--index-md.4419ab24.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--intro-tool-data--index-md.2505a2c4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--vms--index-md.31fa2f12.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--index-md.44077d78.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--posters--index-md.968309e7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--talks--index-md.3bd80461.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--branch-release-merge--index-md.cc4e0d0a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-admins--index-md.c1aa37dd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-end-users--index-md.3ddb7f3b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-training-network--index-md.43cdc565.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--heterogeneous--index-md.810f499a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--index-md.27205369.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--using-galaxy-ui-overview--index-md.770275d4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--hackathon--index-md.23dc0e2f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--index-md.b84a33d4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--key-dates--index-md.afa58daf.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--lightning--index-md.6722fb11.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--logistics--index-md.74e0dab1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--organizers--index-md.80304844.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--photos--index-md.976fd862.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--program--index-md.d8e5ebc7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--promotion--index-md.577f91cb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--register--index-md.09b57f47.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--sponsor-exhibit--index-md.d28c30a0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--admin-walkthrough--index-md.e70f4130.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--api--index-md.3e466840.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--data-managers--index-md.c4c90feb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--index-md.09eceaad.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--vms--index-md.a9f99c81.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--cwl--index-md.572d144e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--data-management-challenges--index-md.6519a99a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--data-splitting-and-parallelism--index-md.f9225e89.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--elixir--index-md.83e340c0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--extended-workflow--index-md.84d907aa.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--fots--index-md.9eb9fbae.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-admins--index-md.013a0661.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-community-uk--index-md.73da832e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-scientists--index-md.8271737e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-training-network--index-md.2c5cf472.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--index-md.50db5ff8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--data-hack-roundup--index-md.54209e2d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--header--index-md.99f7b8a4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--index-md.b607d569.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2016--bofs--index-md.1a1d782b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--abstracts--index-md.8a86f254.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--childcare--index-md.46870d68.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--cofest--index-md.558efeda.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--conduct--index-md.4cdcc7b1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--faq--index-md.54d3f72a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--index-md.03d62056.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--organizers--index-md.0ca6c313.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--promotion--index-md.a0d7a442.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--registration--index-md.be067239.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--sponsors--index-md.b823edb9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--training--index-md.8e06e99f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--venue--index-md.bd503783.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--abstracts--index-md.7206d890.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--childcare--index-md.7f23990a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--code-of-conduct--index-md.9c7749ad.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--collaboration--index-md.d2df60a9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--faq--index-md.3263be33.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--icebreaker--index-md.ab42ed08.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--index-md.2726d22d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--keynotes--index-md.dfee893e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--organizers--index-md.7cdb9d53.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--promotion--index-md.3881bf6d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--register--index-md.5ca35f56.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--sponsors--index-md.8fef601a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--training--index-md.37b79dad.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--venue--index-md.7c4dd44e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--germany-2014--index-md.286c0184.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--germany-2016--index-md.6c02f7a2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--sg-2014--index-md.e1f8864b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--sg-2016--index-md.eed2cd9b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2014--index-md.5356abdf.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2014--trainingday--index-md.45d2d738.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2016--index-md.837d1830.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--example--vue-remark--index-md.972b7a38.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--faqs--index-md.ecb23aeb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--galaxy-updates--2013-06--index-md.dfe44fb6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--galaxy-updates--2013-07--index-md.c147ef3d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--icons--index-md.b3e66524.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--index-md.27f20470.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--logos--index-md.5cf6a844.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--news-graphics--index-md.68e69490.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--photos--index-md.96cfd5fc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--screenshots--index-md.6188b2ad.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--basic-editing--index-md.c0be3976.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--basic-editing--workflow-editor-unannotated--index-md.c7e004d5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--extract--index-md.1f732370.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--tool-panel--index-md.861a5048.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--variables--index-md.c521b297.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--faq--index-md.1591ea49.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--galaxy-pages--index-md.321b9ce8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--interval-operations--index-md.cab27468.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--main--faq--index-md.7ee220fd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--tools--requirements--index-md.bcb851a8.js"><link rel="stylesheet" href="/assets/css/0.styles.5b1099da.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout" data-v-14d6d1e0><header id="masthead"><nav class="container navbar navbar-expand-lg navbar-dark justify-content-center"><a href="/" class="navbar-brand active"><img id="masthead-logo" src="/images/galaxy_logo_hub_white.svg" alt="Galaxy Community Hub" height="30"></a><div id="navbarToggleWrapper" class="collapse navbar-collapse mx-auto"><ul class="navbar-nav"><li class="nav-item"><a href="/use/" role="button" aria-expanded="false" class="nav-link dropdown">
          Use
        </a></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" aria-expanded="false" class="nav-link dropdown-toggle">
          Learn
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/learn/" class="dropdown-item">How to use Galaxy</a></li><li><a href="https://training.galaxyproject.org/" class="dropdown-item">Teach with Galaxy</a></li></ul></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" class="nav-link dropdown-toggle">
          Community
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/community/" class="dropdown-item">About</a></li><li><a href="/events/" class="dropdown-item">Events</a></li><li><a href="/news/" class="dropdown-item">News</a></li><li><a href="/blog/" class="dropdown-item">Blog</a></li><li><a href="/publication-library/" class="dropdown-item">Publications</a></li><li><a href="/galaxy-project/statistics/" class="dropdown-item">Stats</a></li><li><a href="/careers/" class="dropdown-item">Careers</a></li></ul></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" class="nav-link dropdown-toggle">
          Deploy &amp; Develop
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/admin/get-galaxy/" class="dropdown-item">Install Galaxy</a></li><li><a href="/admin/" class="dropdown-item active">Server administration</a></li><li><a href="/tools/" class="dropdown-item">Tools</a></li><li><a href="/develop/api/" class="dropdown-item">Working with the API</a></li><li><a href="/develop/" class="dropdown-item">Contributing</a></li><li><a href="/docs/" class="dropdown-item">Code documentation</a></li></ul></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" class="nav-link dropdown-toggle">
          Support
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/support/" class="dropdown-item">FAQ</a></li><li><a href="https://help.galaxyproject.org/" class="dropdown-item">Galaxy Help Forum</a></li></ul></li><li class="nav-item"><a href="/jxtx/" role="button" aria-expanded="false" class="nav-link dropdown">
          @jxtx
        </a></li></ul><ul class="navbar-nav ml-auto"><li><form method="get" action="/search/" class="my-2 navbar-form"><div class="input-group"><input id="search-input" name="q" placeholder="Search Galaxy" class="form-control"><span class="input-group-btn"><button type="submit" class="btn btn-secondary"><span class="fa fa-search"></span></button></span></div></form></li></ul></div></nav></header><section id="maincontainer" class="container"><header data-v-08ecca1f data-v-14d6d1e0><a href="/" class="link active" data-v-08ecca1f>← Back to Home</a><!----><h1 class="title" data-v-08ecca1f>Setting up ProFTPd for galaxy uploads in an Active Directory environment</h1><!----><section class="metadata freetext" data-v-08ecca1f><!----><!----><!----></section><!----><!----></header><div class="content markdown" data-v-14d6d1e0><div class="toc-wrapper col-md-3">
<ul>
<li><a href="#some-background">Some background</a></li>
<li><a href="#assumptions">Assumptions</a></li>
<li><a href="#getting-a-version-of-proftpd-that-will-actually-do-what-it-says-it-will">Getting a version of ProFTPd that will actually do what it says it will</a></li>
<li><a href="#discussion">Discussion</a></li>
<li><a href="#configuring-proftpd">Configuring ProFTPd</a></li>
<li><a href="#discussion-1">Discussion</a></li>
<li><a href="#configuring-proftpd-with-openldap">Configuring ProFTPD with OpenLDAP</a></li>
<li><a href="#tls-configuration">TLS Configuration</a></li>
</ul>
</div>
<div class="body-wrapper col-md-9">
<ul>
<li>You want to enable FTP file uploads?</li>
<li>You are happy and able to use ProFTPd?</li>
<li>You want to authenticate off Active Directory?</li>
<li>You want Galaxy to actually find the uploaded files?</li>
</ul>
<p>Yes, Yes, Yes and Of_Course?  Read on..</p>
<h2 id="some-background"><a href="#some-background" aria-hidden="true"><span class="icon icon-link"></span></a>Some background</h2>
<p>Galaxy grew up serving the entire internet and cannot assume a username is unique so it uses email-addresses as its user-names.</p>
<p>Once an  "ftp_upload_dir"  is configured, it assumes that any uploaded files are to be found in the directory  \&#x3C;ftp_upload_dir>/<email></p>
<p>If it's empty or not there Galaxy reports, "Your FTP upload directory contains no files."</p>
<p>Galaxy checks every time you click Get Data : Upload File</p>
<p>Galaxy exchanges no messages directly with the FTP server, if files are there, it shows them no matter how they got there.</p>
<h2 id="assumptions"><a href="#assumptions" aria-hidden="true"><span class="icon icon-link"></span></a>Assumptions</h2>
<p>Your Galaxy serves a single institution with an AD domain and you're already using it to authenticate users in the Galaxy web pages.</p>
<p>So your <code>config/galaxy.ini</code> file probably has lines like this in the section <code># Enable Galaxy's "Upload via FTP" interface.</code>:</p>
<pre><code class="language-bash"> use_remote_user = True
 remote_user_maildomain = example.domain
 ftp_upload_dir = /galaxy/database/ftp
</code></pre>
<p>Line 1 means you are already using remote (apache or nginx) authentication and that your users log in using their ident as their name not their email.</p>
<p>Line 2 means Galaxy is appending a fixed string  "@example.domain"  to ALL users to convert from ident to email.</p>
<p>Line 3 tells Galaxy to look in  "/galaxy/database/ftp/<user>@example.domain"</p>
<h2 id="getting-a-version-of-proftpd-that-will-actually-do-what-it-says-it-will"><a href="#getting-a-version-of-proftpd-that-will-actually-do-what-it-says-it-will" aria-hidden="true"><span class="icon icon-link"></span></a>Getting a version of ProFTPd that will actually do what it says it will</h2>
<p>For this recipe to work will need at least these versions</p>
<ul>
<li>proftpd            version 1.3.4</li>
<li>proftpd-mod-ldap   version 2.9.2   NOTE: Ubuntu-12.10 apt-get gives you version 2.9.0 which WILL NOT WORK!</li>
</ul>
<p>Go to :  <a href="http://horde.net/~jwm/software/mod_ldap/#current-release" target="_blank" rel="noopener noreferrer">http://horde.net/~jwm/software/mod_ldap/#current-release</a></p>
<h2 id="discussion"><a href="#discussion" aria-hidden="true"><span class="icon icon-link"></span></a>Discussion</h2>
<p>The functionality of defining where home dir is and creating it has just been moved from mod_ldap into proftpd itself.</p>
<p>The extra functionality specifying it using a string containing %u is new to the internal proftpd.</p>
<p>Using the versions specified and re-specifying the %u string to both proftpd and mod-ldap makes it not just accept the string but actually create the directory if it doesn't already exist.</p>
<pre><code class="language-apache"># This tells proftpd to create it if necessary and chroot to it
DefaultRoot     "/galaxy/database/ftp/%u@example.domain"
CreateHome              on 700

# This tells mod_ldap the same thing
LDAPGenerateHomedir     on 700
LDAPGenerateHomedirPrefix "/galaxy/database/ftp/%u@example.domain"
LDAPForceGeneratedHomedir on
LDAPGenerateHomedirPrefixNoUsername     on
</code></pre>
<h2 id="configuring-proftpd"><a href="#configuring-proftpd" aria-hidden="true"><span class="icon icon-link"></span></a>Configuring ProFTPd</h2>
<p>Here is a commented more complete file from  /etc/proftpd/proftpd.conf</p>
<pre><code class="language-apache"># Load LDAP module
LoadModule mod_ldap.c

# Include some other modules
Include /etc/proftpd/modules.conf

# Users require a valid shell listed in /etc/shells to login.
# Use this directive to release that constrain.
RequireValidShell       off

# Set the user and group that the server normally runs at.
User                    galaxy
Group                   galaxy

# Umask 022 is a good standard umask to prevent new files and dirs
# (second parm) from being group and world writable.
Umask                   137 027
# Normally, we want files to be overwriteable.
AllowOverwrite          on

# Uncomment this if you are using NIS or LDAP via NSS to retrieve passwords:
# PersistentPasswd      off

# Galaxy users are not necessarily SSH users, so don't authenticate against real (system) users
AuthPAM                 off

# All authentication is via LDAP to AD
#AuthOrder              mod_auth_pam.c* mod_auth_unix.c
AuthOrder               mod_ldap.c

# You MUST NOT use URL style LDAPServer
LDAPServer      ad-server.example.domain:389

# I can't get this to work, need to fiddle with certificates more
#LDAPUseTLS on

# You can map fields using LDAPAttr
# LDAPAttr      expectedField   "weird AD name with spaces and all sorts of crap"
LDAPAttr        homeDirectory   "unixHomeDirectory"

# 
LDAPBindDN      "CN=&#x3C;read-only-account>,OU=Special Accounts,DC=ad,DC=example,DC=domain"    "password"

# This defines the scope and search filter to find a user in AD
LDAPUsers       "OU=People,DC=ad,DC=example,DC=domain"  "(cn=%u)"

# With this LDAP re-binds to AD as the user using the password supplied
# If it works, you're in!
LDAPAuthBinds   on

LDAPDefaultUID          "&#x3C;uid-number-galaxy-is-running-as>"
LDAPDefaultGID          "&#x3C;gid-number-galaxy-is-running-as>"

# Force those numbers even if LDAP finds a valid UID/GID
LDAPForceDefaultUID     on
LDAPForceDefaultGID     on

LDAPGenerateHomedir     on 700
LDAPGenerateHomedirPrefix "/galaxy/database/ftp/%u@example.domain"

# Force this homedir even if LDAP said something different
LDAPForceGeneratedHomedir on

# The username is already incorporated in the %u, use this or it will get appended again
LDAPGenerateHomedirPrefixNoUsername     on


TransferLog             /var/log/proftpd/xferlog
SystemLog               /var/log/proftpd/proftpd.log


# You need this or users will get their passwords exposed across the network in the clear
Include /etc/proftpd/tls.conf

# These "virtuals" allow more than 1 proftpd
#       to run on the same host using different IPs.
#Include /etc/proftpd/virtuals.conf

# Cause every FTP user to be "jailed" (chrooted) into their home directory
DefaultRoot     "/galaxy/database/ftp/%u@example.com"

# Automatically create home directory if it doesn't exist
CreateHome              on 700

# Allow users to overwrite their files
AllowOverwrite          on

# Allow users to resume interrupted uploads
AllowStoreRestart       on
</code></pre>
<h2 id="discussion-1"><a href="#discussion-1" aria-hidden="true"><span class="icon icon-link"></span></a>Discussion</h2>
<p>Where ever it's getting the information mod_ldap is looking for:</p>
<ul>
<li>uid</li>
<li>gid</li>
<li>uidNumber</li>
<li>gidNumber</li>
<li>homeDirectory</li>
</ul>
<h2 id="configuring-proftpd-with-openldap"><a href="#configuring-proftpd-with-openldap" aria-hidden="true"><span class="icon icon-link"></span></a>Configuring ProFTPD with OpenLDAP</h2>
<p>Helena Rasche found a set of working options for using ProFTPD with OpenLDAP
servers (instead of AD).</p>
<p>This configuration file can be modified and placed in
<code>/etc/proftpd/conf.d/galaxy.conf</code></p>
<p>Using the /conf.d/ directory, you can allow the ProFTPd to serve both
local users (with PAM authentication) in the main configuration file,
AND galaxy users on another port.</p>
<pre><code class="language-apache">&#x3C;VirtualHost xxx.yyy.zzz>
        RequireValidShell       off
        User                    galaxy
        Group                   galaxy
        Umask                   137 027
        AllowOverwrite          on

        # Ensure auth is LDAP
        AuthPAM                 off
        AuthOrder               mod_ldap.c

        # Serve this VirtualHost on port 4000
        Port                    4000

        # LDAP Bind information
        LDAPServer              ldaps://xxx.yyy.zzz/??sub
        LDAPUsers               "ou=People,dc=yyy,dc=zzz"  "(uid=%u)"
        LDAPAuthBinds           on

        # Force those numbers even if LDAP finds a valid UID/GID
        LDAPDefaultUID          1003
        LDAPDefaultGID          1003
        LDAPForceDefaultUID     on
        LDAPForceDefaultGID     on

        # Please generate home dir with user/group rwx permissions. Could probably be stricter
        CreateHome              on 770
        LDAPGenerateHomedir     on 770

        # Force this homedir even if LDAP said something different
        LDAPForceGeneratedHomedir               on
        LDAPGenerateHomedirPrefix               "/home/galaxy/galaxy/database/ftp/%u@cpt.tamu.edu"

        # The username is already incorporated in the %u, use this or it will get appended again
        LDAPGenerateHomedirPrefixNoUsername     on

        TransferLog             /var/log/proftpd/xfer-galaxy.log

        # Cause every FTP user to be "jailed" (chrooted) into their home directory
        DefaultRoot             "/home/galaxy/galaxy/database/ftp/%u@cpt.tamu.edu"
        # Allow users to resume interrupted uploads
        AllowStoreRestart       on
        # I set these as my passive ports because I run a very strict firewall. Change as needed
        PassivePorts            49152 50000
&#x3C;/VirtualHost>
</code></pre>
<p>Notably, this configuration allows a galaxy virtualhost to coexist with
the normal FTP capabilities provided by ProFTPd, so users can still
access their home directories AND galaxy users can upload to galaxy.
Authentication can of course be changed to suit one's needs.</p>
<h2 id="tls-configuration"><a href="#tls-configuration" aria-hidden="true"><span class="icon icon-link"></span></a>TLS Configuration</h2>
<p>If you're running the galaxy FTP portion under a VirtualHost, like
described above, you'll notice that TLS directives placed in the main
proftpd.conf file do not apply to VirtualHosts. As such, you can add a
section that looks like this to every VirtualHost that needs to be secured</p>
<pre><code class="language-apache">&#x3C;IfModule mod_tls.c>
        TLSEngine                       on
        TLSLog                          /var/log/proftpd/tls.galaxy.log
        # Your cert and private key
        TLSRSACertificateFile           /etc/ssl/certs/my.crt
        TLSRSACertificateKeyFile        /etc/ssl/private/my.key
        TLSCACertificateFile            /etc/ssl/certs/ca.bundle
        # I've found that this is required for FileZilla
        TLSOptions    NoCertRequest EnableDiags NoSessionReuseRequired
        # Most clients won't be sending certs
        TLSVerifyClient                 off
        TLSRequired                     on
&#x3C;/IfModule>
</code></pre>
</div>
</div><footer data-v-fcf53fc4 data-v-14d6d1e0><!----></footer><footer class="static-footer markdown"><p>The Galaxy Project is supported in part by NSF, NHGRI, The Huck Institutes of the Life Sciences, The Institute for CyberScience at Penn State, and Johns Hopkins University.</p>
</footer></section></div>
    <script>window.__INITIAL_STATE__={"data":{"article":{"id":"853b84dc2e9d8531c5c89ae35facdfb8","title":"Setting up ProFTPd for galaxy uploads in an Active Directory environment","tease":"","category":null,"date":null,"days":null,"contact":"","contact_url":"","authors":"","location":"","location_url":"","source_blog":"","source_blog_url":"","skip_title_render":null,"links":[],"image":"","images":{},"external_url":"","content":"\u003Cdiv class=\"toc-wrapper col-md-3\"\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"#some-background\"\u003ESome background\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#assumptions\"\u003EAssumptions\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#getting-a-version-of-proftpd-that-will-actually-do-what-it-says-it-will\"\u003EGetting a version of ProFTPd that will actually do what it says it will\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#discussion\"\u003EDiscussion\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#configuring-proftpd\"\u003EConfiguring ProFTPd\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#discussion-1\"\u003EDiscussion\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#configuring-proftpd-with-openldap\"\u003EConfiguring ProFTPD with OpenLDAP\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#tls-configuration\"\u003ETLS Configuration\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"body-wrapper col-md-9\"\u003E\n\u003Cul\u003E\n\u003Cli\u003EYou want to enable FTP file uploads?\u003C\u002Fli\u003E\n\u003Cli\u003EYou are happy and able to use ProFTPd?\u003C\u002Fli\u003E\n\u003Cli\u003EYou want to authenticate off Active Directory?\u003C\u002Fli\u003E\n\u003Cli\u003EYou want Galaxy to actually find the uploaded files?\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EYes, Yes, Yes and Of_Course?  Read on..\u003C\u002Fp\u003E\n\u003Ch2 id=\"some-background\"\u003E\u003Ca href=\"#some-background\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ESome background\u003C\u002Fh2\u003E\n\u003Cp\u003EGalaxy grew up serving the entire internet and cannot assume a username is unique so it uses email-addresses as its user-names.\u003C\u002Fp\u003E\n\u003Cp\u003EOnce an  \"ftp_upload_dir\"  is configured, it assumes that any uploaded files are to be found in the directory  \\&#x3C;ftp_upload_dir\u003E\u002F\u003Cemail\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EIf it's empty or not there Galaxy reports, \"Your FTP upload directory contains no files.\"\u003C\u002Fp\u003E\n\u003Cp\u003EGalaxy checks every time you click Get Data : Upload File\u003C\u002Fp\u003E\n\u003Cp\u003EGalaxy exchanges no messages directly with the FTP server, if files are there, it shows them no matter how they got there.\u003C\u002Fp\u003E\n\u003Ch2 id=\"assumptions\"\u003E\u003Ca href=\"#assumptions\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EAssumptions\u003C\u002Fh2\u003E\n\u003Cp\u003EYour Galaxy serves a single institution with an AD domain and you're already using it to authenticate users in the Galaxy web pages.\u003C\u002Fp\u003E\n\u003Cp\u003ESo your \u003Ccode\u003Econfig\u002Fgalaxy.ini\u003C\u002Fcode\u003E file probably has lines like this in the section \u003Ccode\u003E# Enable Galaxy's \"Upload via FTP\" interface.\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003E use_remote_user = True\n remote_user_maildomain = example.domain\n ftp_upload_dir = \u002Fgalaxy\u002Fdatabase\u002Fftp\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ELine 1 means you are already using remote (apache or nginx) authentication and that your users log in using their ident as their name not their email.\u003C\u002Fp\u003E\n\u003Cp\u003ELine 2 means Galaxy is appending a fixed string  \"@example.domain\"  to ALL users to convert from ident to email.\u003C\u002Fp\u003E\n\u003Cp\u003ELine 3 tells Galaxy to look in  \"\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F\u003Cuser\u003E@example.domain\"\u003C\u002Fp\u003E\n\u003Ch2 id=\"getting-a-version-of-proftpd-that-will-actually-do-what-it-says-it-will\"\u003E\u003Ca href=\"#getting-a-version-of-proftpd-that-will-actually-do-what-it-says-it-will\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EGetting a version of ProFTPd that will actually do what it says it will\u003C\u002Fh2\u003E\n\u003Cp\u003EFor this recipe to work will need at least these versions\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Eproftpd            version 1.3.4\u003C\u002Fli\u003E\n\u003Cli\u003Eproftpd-mod-ldap   version 2.9.2   NOTE: Ubuntu-12.10 apt-get gives you version 2.9.0 which WILL NOT WORK!\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EGo to :  \u003Ca href=\"http:\u002F\u002Fhorde.net\u002F~jwm\u002Fsoftware\u002Fmod_ldap\u002F#current-release\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Ehttp:\u002F\u002Fhorde.net\u002F~jwm\u002Fsoftware\u002Fmod_ldap\u002F#current-release\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Ch2 id=\"discussion\"\u003E\u003Ca href=\"#discussion\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EDiscussion\u003C\u002Fh2\u003E\n\u003Cp\u003EThe functionality of defining where home dir is and creating it has just been moved from mod_ldap into proftpd itself.\u003C\u002Fp\u003E\n\u003Cp\u003EThe extra functionality specifying it using a string containing %u is new to the internal proftpd.\u003C\u002Fp\u003E\n\u003Cp\u003EUsing the versions specified and re-specifying the %u string to both proftpd and mod-ldap makes it not just accept the string but actually create the directory if it doesn't already exist.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-apache\"\u003E# This tells proftpd to create it if necessary and chroot to it\nDefaultRoot     \"\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@example.domain\"\nCreateHome              on 700\n\n# This tells mod_ldap the same thing\nLDAPGenerateHomedir     on 700\nLDAPGenerateHomedirPrefix \"\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@example.domain\"\nLDAPForceGeneratedHomedir on\nLDAPGenerateHomedirPrefixNoUsername     on\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 id=\"configuring-proftpd\"\u003E\u003Ca href=\"#configuring-proftpd\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EConfiguring ProFTPd\u003C\u002Fh2\u003E\n\u003Cp\u003EHere is a commented more complete file from  \u002Fetc\u002Fproftpd\u002Fproftpd.conf\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-apache\"\u003E# Load LDAP module\nLoadModule mod_ldap.c\n\n# Include some other modules\nInclude \u002Fetc\u002Fproftpd\u002Fmodules.conf\n\n# Users require a valid shell listed in \u002Fetc\u002Fshells to login.\n# Use this directive to release that constrain.\nRequireValidShell       off\n\n# Set the user and group that the server normally runs at.\nUser                    galaxy\nGroup                   galaxy\n\n# Umask 022 is a good standard umask to prevent new files and dirs\n# (second parm) from being group and world writable.\nUmask                   137 027\n# Normally, we want files to be overwriteable.\nAllowOverwrite          on\n\n# Uncomment this if you are using NIS or LDAP via NSS to retrieve passwords:\n# PersistentPasswd      off\n\n# Galaxy users are not necessarily SSH users, so don't authenticate against real (system) users\nAuthPAM                 off\n\n# All authentication is via LDAP to AD\n#AuthOrder              mod_auth_pam.c* mod_auth_unix.c\nAuthOrder               mod_ldap.c\n\n# You MUST NOT use URL style LDAPServer\nLDAPServer      ad-server.example.domain:389\n\n# I can't get this to work, need to fiddle with certificates more\n#LDAPUseTLS on\n\n# You can map fields using LDAPAttr\n# LDAPAttr      expectedField   \"weird AD name with spaces and all sorts of crap\"\nLDAPAttr        homeDirectory   \"unixHomeDirectory\"\n\n# \nLDAPBindDN      \"CN=&#x3C;read-only-account\u003E,OU=Special Accounts,DC=ad,DC=example,DC=domain\"    \"password\"\n\n# This defines the scope and search filter to find a user in AD\nLDAPUsers       \"OU=People,DC=ad,DC=example,DC=domain\"  \"(cn=%u)\"\n\n# With this LDAP re-binds to AD as the user using the password supplied\n# If it works, you're in!\nLDAPAuthBinds   on\n\nLDAPDefaultUID          \"&#x3C;uid-number-galaxy-is-running-as\u003E\"\nLDAPDefaultGID          \"&#x3C;gid-number-galaxy-is-running-as\u003E\"\n\n# Force those numbers even if LDAP finds a valid UID\u002FGID\nLDAPForceDefaultUID     on\nLDAPForceDefaultGID     on\n\nLDAPGenerateHomedir     on 700\nLDAPGenerateHomedirPrefix \"\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@example.domain\"\n\n# Force this homedir even if LDAP said something different\nLDAPForceGeneratedHomedir on\n\n# The username is already incorporated in the %u, use this or it will get appended again\nLDAPGenerateHomedirPrefixNoUsername     on\n\n\nTransferLog             \u002Fvar\u002Flog\u002Fproftpd\u002Fxferlog\nSystemLog               \u002Fvar\u002Flog\u002Fproftpd\u002Fproftpd.log\n\n\n# You need this or users will get their passwords exposed across the network in the clear\nInclude \u002Fetc\u002Fproftpd\u002Ftls.conf\n\n# These \"virtuals\" allow more than 1 proftpd\n#       to run on the same host using different IPs.\n#Include \u002Fetc\u002Fproftpd\u002Fvirtuals.conf\n\n# Cause every FTP user to be \"jailed\" (chrooted) into their home directory\nDefaultRoot     \"\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@example.com\"\n\n# Automatically create home directory if it doesn't exist\nCreateHome              on 700\n\n# Allow users to overwrite their files\nAllowOverwrite          on\n\n# Allow users to resume interrupted uploads\nAllowStoreRestart       on\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 id=\"discussion-1\"\u003E\u003Ca href=\"#discussion-1\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EDiscussion\u003C\u002Fh2\u003E\n\u003Cp\u003EWhere ever it's getting the information mod_ldap is looking for:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Euid\u003C\u002Fli\u003E\n\u003Cli\u003Egid\u003C\u002Fli\u003E\n\u003Cli\u003EuidNumber\u003C\u002Fli\u003E\n\u003Cli\u003EgidNumber\u003C\u002Fli\u003E\n\u003Cli\u003EhomeDirectory\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"configuring-proftpd-with-openldap\"\u003E\u003Ca href=\"#configuring-proftpd-with-openldap\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EConfiguring ProFTPD with OpenLDAP\u003C\u002Fh2\u003E\n\u003Cp\u003EHelena Rasche found a set of working options for using ProFTPD with OpenLDAP\nservers (instead of AD).\u003C\u002Fp\u003E\n\u003Cp\u003EThis configuration file can be modified and placed in\n\u003Ccode\u003E\u002Fetc\u002Fproftpd\u002Fconf.d\u002Fgalaxy.conf\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EUsing the \u002Fconf.d\u002F directory, you can allow the ProFTPd to serve both\nlocal users (with PAM authentication) in the main configuration file,\nAND galaxy users on another port.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-apache\"\u003E&#x3C;VirtualHost xxx.yyy.zzz\u003E\n        RequireValidShell       off\n        User                    galaxy\n        Group                   galaxy\n        Umask                   137 027\n        AllowOverwrite          on\n\n        # Ensure auth is LDAP\n        AuthPAM                 off\n        AuthOrder               mod_ldap.c\n\n        # Serve this VirtualHost on port 4000\n        Port                    4000\n\n        # LDAP Bind information\n        LDAPServer              ldaps:\u002F\u002Fxxx.yyy.zzz\u002F??sub\n        LDAPUsers               \"ou=People,dc=yyy,dc=zzz\"  \"(uid=%u)\"\n        LDAPAuthBinds           on\n\n        # Force those numbers even if LDAP finds a valid UID\u002FGID\n        LDAPDefaultUID          1003\n        LDAPDefaultGID          1003\n        LDAPForceDefaultUID     on\n        LDAPForceDefaultGID     on\n\n        # Please generate home dir with user\u002Fgroup rwx permissions. Could probably be stricter\n        CreateHome              on 770\n        LDAPGenerateHomedir     on 770\n\n        # Force this homedir even if LDAP said something different\n        LDAPForceGeneratedHomedir               on\n        LDAPGenerateHomedirPrefix               \"\u002Fhome\u002Fgalaxy\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@cpt.tamu.edu\"\n\n        # The username is already incorporated in the %u, use this or it will get appended again\n        LDAPGenerateHomedirPrefixNoUsername     on\n\n        TransferLog             \u002Fvar\u002Flog\u002Fproftpd\u002Fxfer-galaxy.log\n\n        # Cause every FTP user to be \"jailed\" (chrooted) into their home directory\n        DefaultRoot             \"\u002Fhome\u002Fgalaxy\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@cpt.tamu.edu\"\n        # Allow users to resume interrupted uploads\n        AllowStoreRestart       on\n        # I set these as my passive ports because I run a very strict firewall. Change as needed\n        PassivePorts            49152 50000\n&#x3C;\u002FVirtualHost\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENotably, this configuration allows a galaxy virtualhost to coexist with\nthe normal FTP capabilities provided by ProFTPd, so users can still\naccess their home directories AND galaxy users can upload to galaxy.\nAuthentication can of course be changed to suit one's needs.\u003C\u002Fp\u003E\n\u003Ch2 id=\"tls-configuration\"\u003E\u003Ca href=\"#tls-configuration\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ETLS Configuration\u003C\u002Fh2\u003E\n\u003Cp\u003EIf you're running the galaxy FTP portion under a VirtualHost, like\ndescribed above, you'll notice that TLS directives placed in the main\nproftpd.conf file do not apply to VirtualHosts. As such, you can add a\nsection that looks like this to every VirtualHost that needs to be secured\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-apache\"\u003E&#x3C;IfModule mod_tls.c\u003E\n        TLSEngine                       on\n        TLSLog                          \u002Fvar\u002Flog\u002Fproftpd\u002Ftls.galaxy.log\n        # Your cert and private key\n        TLSRSACertificateFile           \u002Fetc\u002Fssl\u002Fcerts\u002Fmy.crt\n        TLSRSACertificateKeyFile        \u002Fetc\u002Fssl\u002Fprivate\u002Fmy.key\n        TLSCACertificateFile            \u002Fetc\u002Fssl\u002Fcerts\u002Fca.bundle\n        # I've found that this is required for FileZilla\n        TLSOptions    NoCertRequest EnableDiags NoSessionReuseRequired\n        # Most clients won't be sending certs\n        TLSVerifyClient                 off\n        TLSRequired                     on\n&#x3C;\u002FIfModule\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.6a2146ae.js" defer></script><script src="/assets/js/page--src--templates--article-vue.59a31f82.js" defer></script>
  </body>
</html>
