<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Setting up ProFTPd for galaxy uploads in an Active Directory environment - Galaxy Community Hub</title><meta name="gridsome:hash" content="c32ecfdb33b075b0057598b5b9118f3554a398cf"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="All about Galaxy and its community."><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.7d4a227415c9d9b704d56a079d49a3e1.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.7d4a227415c9d9b704d56a079d49a3e1.png"><link rel="preload" href="/assets/css/0.styles.28333459.css" as="style"><link rel="preload" href="/assets/js/app.f7f9943a.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--article-vue.9c961af0.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.54a07ec7.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-vue.72cfdf23.js"><link rel="prefetch" href="/assets/js/page--src--pages--careers-vue.51f7f627.js"><link rel="prefetch" href="/assets/js/page--src--pages--data-explorer-vue.cda0b563.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--archive-vue.54bd407e.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--cofests--papercuts-vue.d73bf9af.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--cofests-vue.f9ca327e.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--webinars-vue.2b0c4b1f.js"><link rel="prefetch" href="/assets/js/page--src--pages--events-vue.2bc0181e.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.9e6f30c2.js"><link rel="prefetch" href="/assets/js/page--src--pages--news-vue.c55be461.js"><link rel="prefetch" href="/assets/js/page--src--pages--tests-vue.4730afa8.js"><link rel="prefetch" href="/assets/js/page--src--pages--use-vue.8c7d1a05.js"><link rel="prefetch" href="/assets/js/page--src--templates--platform-vue.672f4f9e.js"><link rel="prefetch" href="/assets/js/page--src--templates--vue-article-vue.d03e3b77.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--careers-vue~page--src--pages--use-vue~page--src--templates--article-vue~pa~efade918.71d44943.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--index-md.b120794f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--md--imgtests--imgdir--index-md.8a720dc7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--partials--index-md.88a2cc0b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--imgtests--imgdir--index-md.a7da7426.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--imgtests--index-md.ab7ce26b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--index-md.ac0f0339.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--syntaxtests--index-md.7388aadd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--syntaxtests--reldir--index-md.78e6d088.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--capacity-planning--index-md.532d558e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--config--index-md.f596bca3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--config--performance--cluster--legacy--index-md.9900d899.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--datatypes--index-md.37a06167.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--disk-quotas--index-md.99623880.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--faq--index-md.dfcae1f0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--internals--data-model--index-md.f6811d25.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--internals--galaxy-ops--index-md.da494b7d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--ten-simple-steps-galaxy-as-a-service--index-md.f0b31fa8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--tools--tool-config-syntax--index-md.c133b049.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--tools--writing-tests--index-md.d3ed2aee.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--allocation--index-md.88a6f777.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--faq--index-md.6b5ae7d2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--index-md.54b831ad.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--ssh--index-md.c431c940.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--troubleshooting--index-md.2bbf34e9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--capacity-planning--index-md.8d2c9c03.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--getting-started--index-md.63fe5edc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--index-md.1387a7bc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--building--index-md.ea5bc352.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--capacity-planning--index-md.bdfd10d5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--cluster-types--index-md.83943371.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--customizing--index-md.6b8b3678.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--faq--index-md.12c74d13.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--getting-started--index-md.e3fa7dae.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--getting-started--pre-201703--index-md.9b084a41.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--hadoop--index-md.95f1458a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--ht-condor--index-md.f973feff.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--index-md.37f11743.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--openstack--index-md.f4d0e62a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--services--index-md.e26413ae.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--sharing--index-md.c15fa6cb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--troubleshooting--index-md.953f49c4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--userdata--index-md.1116e088.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--future--index-md.ec7dff38.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--index-md.f0bd7fb5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-07-09--index-md.ed1d541b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-07-27--index-md.5a2cbe0c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-09-19--index-md.36fcc10e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-11-14--index-md.5155dfcc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-01-16--index-md.e740402b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-03-20--index-md.fa75b1de.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-05-15--index-md.ad74e436.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-11-20--index-md.6a1074f1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-02-19--index-md.bdefdea8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-04-16--index-md.ce613da7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-06-18--index-md.9253a34b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-08-20--index-md.8ac977c4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-10-15--index-md.3a558b10.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-02-18--index-md.ae82f681.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-04-21--index-md.4cd1f8fc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-06-16--index-md.7b1572c5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-08-18--index-md.5b3383d1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--index-md.da754856.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--webinar-tech--index-md.c5c416a6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--2012--index-md.4eddb972.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--2014--index-md.5d7b4578.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--index-md.afac4bb5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--data--index-md.f2ba0502.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--datafiles--index-md.4dfd4db7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--architecture--index-md.8035154b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--bitbucket--index-md.7cc7d8d1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--css--index-md.710209d9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--getting-started--index-md.930b3a22.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--index-md.1cbec221.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--jsa--index-md.134e6a35.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--mercurial--index-md.9026901a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--security-tool-tips--index-md.2d704e67.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--galaxy-project--index-md.230e8088.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--index-md.e5883590.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--papers--index-md.db9c7f1b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--posters--index-md.04432e3d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--presentations--index-md.92923a05.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--videos--index-md.f680b009.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--advanced-session--index-md.4227a5ac.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--basics-session--index-md.08c5b284.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--index-md.9844ef78.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--logistics--index-md.6f6b160a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--publicity--index-md.dfbc1a41.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--registration--index-md.5232161d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--abstracts--index-md.697fe169.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--index-md.ca51927e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--key-dates--index-md.606cfcac.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--lightning-talks--index-md.6a60add5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--logistics--index-md.06ca864d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--organizing-committee--index-md.0500ed90.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--photos--index-md.ab68ac2c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--automation-strategies--index-md.2d8a9043.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--bioinformatics-training--index-md.43a55fdc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--end-users--index-md.5f46cd2a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--workflows-and-api--index-md.07da71b4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--index-md.cb8d0657.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--promotion--index-md.4eb64cde.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--register--index-md.49c36527.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--sponsorships--index-md.db0f3791.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--training-day--index-md.c8f12515.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--index-md.3c67479f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--posters--index-md.728aa734.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--talks--index-md.7f93c9db.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--clinical-use-hpc-file-systems--index-md.030a88bd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-admins--index-md.f12f7b4d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-blast--index-md.59e8820f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-professionals--index-md.dcb27276.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--index-md.cfaaca20.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--proteomics--index-md.abba045c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--public-galaxy-servers--index-md.bd34ea15.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--tool-developers--index-md.a5a0a8b6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--index-md.df6174ac.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--key-dates--index-md.f7630162.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--lightning--index-md.0dfb5a95.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--logistics--index-md.4759076c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--organizers--index-md.6fc11b96.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--photos--index-md.aef50972.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--program--index-md.05c5d87a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--promotion--index-md.e34ad376.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--register--index-md.8ea1785f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--sponsorships--index-md.3cde86d8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--advance-tool-data--index-md.2210b6c4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--api--index-md.57c06e35.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--index-md.4cd32016.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--intro-tool-data--index-md.75a7abbd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--vms--index-md.1c86a58b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--index-md.9abee1c6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--posters--index-md.810cd33b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--talks--index-md.c9751906.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--branch-release-merge--index-md.f6ed714e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-admins--index-md.5f9fcb01.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-end-users--index-md.00b4cd3b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-training-network--index-md.a843f5f7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--heterogeneous--index-md.8313575f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--index-md.f878a9f6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--using-galaxy-ui-overview--index-md.5b284474.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--hackathon--index-md.20172bcf.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--index-md.9ea6d61e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--key-dates--index-md.bac2859e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--lightning--index-md.96c8f509.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--logistics--index-md.c1318807.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--organizers--index-md.b183376c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--photos--index-md.e0b61b7a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--program--index-md.a93fc58b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--promotion--index-md.df1d2b77.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--register--index-md.54adaeb3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--sponsor-exhibit--index-md.64ef93be.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--admin-walkthrough--index-md.c82adb0e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--api--index-md.a936c5d1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--data-managers--index-md.348024f8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--index-md.030f1ebd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--vms--index-md.507d7d15.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--cwl--index-md.a8a9aa76.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--data-management-challenges--index-md.409c72aa.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--data-splitting-and-parallelism--index-md.6332a3a3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--elixir--index-md.982da27f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--extended-workflow--index-md.f2b42ad0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--fots--index-md.52645a6e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-admins--index-md.ffda743c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-community-uk--index-md.060ecf60.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-scientists--index-md.ae9e7e59.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-training-network--index-md.a412fdd5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--index-md.22f27d14.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--data-hack-roundup--index-md.60bc6484.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--header--index-md.dbba4e7d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--index-md.2f85a581.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2016--bofs--index-md.5a3032e2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--abstracts--index-md.57e795e8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--childcare--index-md.096b34d2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--cofest--index-md.8b0a9b93.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--conduct--index-md.8e51f30c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--faq--index-md.0f0f1b46.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--index-md.641b44a6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--organizers--index-md.787e0ccf.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--promotion--index-md.e6e58e52.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--registration--index-md.52f1b4f7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--sponsors--index-md.ef140359.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--training--index-md.ee0d3a7c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--venue--index-md.30256085.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--abstracts--index-md.137e7bc6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--childcare--index-md.84f642d3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--code-of-conduct--index-md.2789988f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--collaboration--index-md.a48ddf3b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--faq--index-md.4fd33733.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--icebreaker--index-md.ce20a106.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--index-md.9c798d19.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--keynotes--index-md.080e361c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--organizers--index-md.a3b956fb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--promotion--index-md.de985f84.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--register--index-md.05d6bc90.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--sponsors--index-md.4c398a30.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--training--index-md.ce0ef35c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--venue--index-md.4a3ddfec.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--germany-2014--index-md.d56576b3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--germany-2016--index-md.9f18f6ac.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--sg-2014--index-md.6fd15769.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--sg-2016--index-md.c0b34aae.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2014--index-md.ba91d0c6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2014--trainingday--index-md.e89c50c3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2016--index-md.6afda26b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--example--vue-remark--index-md.c96a8cd8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--faqs--index-md.3bba7da9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--galaxy-updates--2013-06--index-md.a5232112.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--galaxy-updates--2013-07--index-md.19df6105.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--icons--index-md.ff92f6d4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--index-md.246f22cd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--logos--index-md.5a8a4cdf.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--news-graphics--index-md.844f04b7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--photos--index-md.7a556820.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--screenshots--index-md.290a5433.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--basic-editing--index-md.467e2afe.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--basic-editing--workflow-editor-unannotated--index-md.bc93cd9f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--extract--index-md.940bc220.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--tool-panel--index-md.7ac3e984.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--variables--index-md.a3612f7c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--faq--index-md.599e559f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--galaxy-pages--index-md.51df5ee9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--interval-operations--index-md.71022235.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--main--faq--index-md.f6a425fa.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--tools--requirements--index-md.1aef8fd3.js"><link rel="stylesheet" href="/assets/css/0.styles.28333459.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout" data-v-3a128d75><header id="masthead"><nav class="container navbar navbar-expand-lg navbar-dark justify-content-center"><a href="/" class="navbar-brand active"><img id="masthead-logo" src="/images/galaxy_logo_hub_white.svg" alt="Galaxy Community Hub" height="30"></a><div id="navbarToggleWrapper" class="collapse navbar-collapse mx-auto"><ul class="navbar-nav"><li class="nav-item"><a href="/use/" role="button" aria-expanded="false" class="nav-link dropdown">
          Use
        </a></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" aria-expanded="false" class="nav-link dropdown-toggle">
          Learn
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/learn/" class="dropdown-item">How to use Galaxy</a></li><li><a href="https://training.galaxyproject.org/" class="dropdown-item">Teach with Galaxy</a></li></ul></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" class="nav-link dropdown-toggle">
          Community
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/community/" class="dropdown-item">About</a></li><li><a href="/events/" class="dropdown-item">Events</a></li><li><a href="/news/" class="dropdown-item">News</a></li><li><a href="/blog/" class="dropdown-item">Blog</a></li><li><a href="/publication-library/" class="dropdown-item">Publications</a></li><li><a href="/galaxy-project/statistics/" class="dropdown-item">Stats</a></li><li><a href="/careers/" class="dropdown-item">Careers</a></li></ul></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" class="nav-link dropdown-toggle">
          Deploy &amp; Develop
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/admin/get-galaxy/" class="dropdown-item">Install Galaxy</a></li><li><a href="/admin/" class="dropdown-item active">Server administration</a></li><li><a href="/tools/" class="dropdown-item">Tools</a></li><li><a href="/develop/api/" class="dropdown-item">Working with the API</a></li><li><a href="/develop/" class="dropdown-item">Contributing</a></li><li><a href="/docs/" class="dropdown-item">Code documentation</a></li></ul></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" class="nav-link dropdown-toggle">
          Support
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/support/" class="dropdown-item">FAQ</a></li><li><a href="https://help.galaxyproject.org/" class="dropdown-item">Galaxy Help Forum</a></li></ul></li><li class="nav-item"><a href="/jxtx/" role="button" aria-expanded="false" class="nav-link dropdown">
          @jxtx
        </a></li></ul></div></nav></header><section id="maincontainer" class="container"><a href="/" class="link active" data-v-3a128d75> ← Home</a><header data-v-3a128d75><!----><h1 class="title" data-v-3a128d75>Setting up ProFTPd for galaxy uploads in an Active Directory environment</h1><div class="metadata" data-v-3a128d75><!----><!----><!----></div></header><div class="content markdown" data-v-3a128d75><ul>
<li>You want to enable FTP file uploads?</li>
<li>You are happy and able to use ProFTPd?</li>
<li>You want to authenticate off Active Directory?</li>
<li>You want Galaxy to actually find the uploaded files?</li>
</ul>
<p>Yes, Yes, Yes and Of_Course?  Read on..</p>
<h2 id="some-background"><a href="#some-background" aria-hidden="true"><span class="icon icon-link"></span></a>Some background</h2>
<p>Galaxy grew up serving the entire internet and cannot assume a username is unique so it uses email-addresses as its user-names.</p>
<p>Once an  "ftp_upload_dir"  is configured, it assumes that any uploaded files are to be found in the directory  &#x3C;ftp_upload_dir>/<email></p>
<p>If it's empty or not there Galaxy reports, "Your FTP upload directory contains no files."</p>
<p>Galaxy checks every time you click Get Data : Upload File</p>
<p>Galaxy exchanges no messages directly with the FTP server, if files are there, it shows them no matter how they got there.</p>
<h2 id="assumptions"><a href="#assumptions" aria-hidden="true"><span class="icon icon-link"></span></a>Assumptions</h2>
<p>Your Galaxy serves a single institution with an AD domain and you're already using it to authenticate users in the Galaxy web pages.</p>
<p>So your <code>config/galaxy.ini</code> file probably has lines like this in the section <code># Enable Galaxy's "Upload via FTP" interface.</code>:
<code>bash use_remote_user = True remote_user_maildomain = example.domain ftp_upload_dir = /galaxy/database/ftp</code></p>
<p>Line 1 means you are already using remote (apache or nginx) authentication and that your users log in using their ident as their name not their email.</p>
<p>Line 2 means Galaxy is appending a fixed string  "@example.domain"  to ALL users to convert from ident to email.</p>
<p>Line 3 tells Galaxy to look in  "/galaxy/database/ftp/<user>@example.domain"</p>
<h2 id="getting-a-version-of-proftpd-that-will-actually-do-what-it-says-it-will"><a href="#getting-a-version-of-proftpd-that-will-actually-do-what-it-says-it-will" aria-hidden="true"><span class="icon icon-link"></span></a>Getting a version of ProFTPd that will actually do what it says it will</h2>
<p>For this recipe to work will need at least these versions</p>
<ul>
<li>proftpd            version 1.3.4</li>
<li>proftpd-mod-ldap   version 2.9.2   NOTE: Ubuntu-12.10 apt-get gives you version 2.9.0 which WILL NOT WORK!</li>
</ul>
<p>Go to :  <a href="http://horde.net/~jwm/software/mod_ldap/#current-release" target="_blank" rel="noopener noreferrer">http://horde.net/~jwm/software/mod_ldap/#current-release</a></p>
<h2 id="discussion"><a href="#discussion" aria-hidden="true"><span class="icon icon-link"></span></a>Discussion</h2>
<p>The functionality of defining where home dir is and creating it has just been moved from mod_ldap into proftpd itself.</p>
<p>The extra functionality specifying it using a string containing %u is new to the internal proftpd.</p>
<p>Using the versions specified and re-specifying the %u string to both proftpd and mod-ldap makes it not just accept the string but actually create the directory if it doesn't already exist.</p>
<pre><code class="language-apache"># This tells proftpd to create it if necessary and chroot to it
DefaultRoot     "/galaxy/database/ftp/%u@example.domain"
CreateHome              on 700

# This tells mod_ldap the same thing
LDAPGenerateHomedir     on 700
LDAPGenerateHomedirPrefix "/galaxy/database/ftp/%u@example.domain"
LDAPForceGeneratedHomedir on
LDAPGenerateHomedirPrefixNoUsername     on
</code></pre>
<h2 id="configuring-proftpd"><a href="#configuring-proftpd" aria-hidden="true"><span class="icon icon-link"></span></a>Configuring ProFTPd</h2>
<p>Here is a commented more complete file from  /etc/proftpd/proftpd.conf
`<code></code>apache
# Load LDAP module
LoadModule mod_ldap.c</p>
<h1 id="include-some-other-modules"><a href="#include-some-other-modules" aria-hidden="true"><span class="icon icon-link"></span></a>Include some other modules</h1>
<p>Include /etc/proftpd/modules.conf</p>
<h1 id="users-require-a-valid-shell-listed-in-etcshells-to-login"><a href="#users-require-a-valid-shell-listed-in-etcshells-to-login" aria-hidden="true"><span class="icon icon-link"></span></a>Users require a valid shell listed in /etc/shells to login.</h1>
<h1 id="use-this-directive-to-release-that-constrain"><a href="#use-this-directive-to-release-that-constrain" aria-hidden="true"><span class="icon icon-link"></span></a>Use this directive to release that constrain.</h1>
<p>RequireValidShell       off</p>
<h1 id="set-the-user-and-group-that-the-server-normally-runs-at"><a href="#set-the-user-and-group-that-the-server-normally-runs-at" aria-hidden="true"><span class="icon icon-link"></span></a>Set the user and group that the server normally runs at.</h1>
<p>User                    galaxy
Group                   galaxy</p>
<h1 id="umask-022-is-a-good-standard-umask-to-prevent-new-files-and-dirs"><a href="#umask-022-is-a-good-standard-umask-to-prevent-new-files-and-dirs" aria-hidden="true"><span class="icon icon-link"></span></a>Umask 022 is a good standard umask to prevent new files and dirs</h1>
<h1 id="second-parm-from-being-group-and-world-writable"><a href="#second-parm-from-being-group-and-world-writable" aria-hidden="true"><span class="icon icon-link"></span></a>(second parm) from being group and world writable.</h1>
<p>Umask                   137 027
# Normally, we want files to be overwriteable.
AllowOverwrite          on</p>
<h1 id="uncomment-this-if-you-are-using-nis-or-ldap-via-nss-to-retrieve-passwords"><a href="#uncomment-this-if-you-are-using-nis-or-ldap-via-nss-to-retrieve-passwords" aria-hidden="true"><span class="icon icon-link"></span></a>Uncomment this if you are using NIS or LDAP via NSS to retrieve passwords:</h1>
<h1 id="persistentpasswd------off"><a href="#persistentpasswd------off" aria-hidden="true"><span class="icon icon-link"></span></a>PersistentPasswd      off</h1>
<h1 id="galaxy-users-are-not-necessarily-ssh-users-so-dont-authenticate-against-real-system-users"><a href="#galaxy-users-are-not-necessarily-ssh-users-so-dont-authenticate-against-real-system-users" aria-hidden="true"><span class="icon icon-link"></span></a>Galaxy users are not necessarily SSH users, so don't authenticate against real (system) users</h1>
<p>AuthPAM                 off</p>
<h1 id="all-authentication-is-via-ldap-to-ad"><a href="#all-authentication-is-via-ldap-to-ad" aria-hidden="true"><span class="icon icon-link"></span></a>All authentication is via LDAP to AD</h1>
<p>#AuthOrder              mod_auth_pam.c* mod_auth_unix.c
AuthOrder               mod_ldap.c</p>
<h1 id="you-must-not-use-url-style-ldapserver"><a href="#you-must-not-use-url-style-ldapserver" aria-hidden="true"><span class="icon icon-link"></span></a>You MUST NOT use URL style LDAPServer</h1>
<p>LDAPServer      ad-server.example.domain:389</p>
<h1 id="i-cant-get-this-to-work-need-to-fiddle-with-certificates-more"><a href="#i-cant-get-this-to-work-need-to-fiddle-with-certificates-more" aria-hidden="true"><span class="icon icon-link"></span></a>I can't get this to work, need to fiddle with certificates more</h1>
<p>#LDAPUseTLS on</p>
<h1 id="you-can-map-fields-using-ldapattr"><a href="#you-can-map-fields-using-ldapattr" aria-hidden="true"><span class="icon icon-link"></span></a>You can map fields using LDAPAttr</h1>
<h1 id="ldapattr------expectedfield---weird-ad-name-with-spaces-and-all-sorts-of-crap"><a href="#ldapattr------expectedfield---weird-ad-name-with-spaces-and-all-sorts-of-crap" aria-hidden="true"><span class="icon icon-link"></span></a>LDAPAttr      expectedField   "weird AD name with spaces and all sorts of crap"</h1>
<p>LDAPAttr        homeDirectory   "unixHomeDirectory"</p>
<h1 id=""></h1>
<p>LDAPBindDN      "CN=<read-only-account>,OU=Special Accounts,DC=ad,DC=example,DC=domain"    "password"</p>
<h1 id="this-defines-the-scope-and-search-filter-to-find-a-user-in-ad"><a href="#this-defines-the-scope-and-search-filter-to-find-a-user-in-ad" aria-hidden="true"><span class="icon icon-link"></span></a>This defines the scope and search filter to find a user in AD</h1>
<p>LDAPUsers       "OU=People,DC=ad,DC=example,DC=domain"  "(cn=%u)"</p>
<h1 id="with-this-ldap-re-binds-to-ad-as-the-user-using-the-password-supplied"><a href="#with-this-ldap-re-binds-to-ad-as-the-user-using-the-password-supplied" aria-hidden="true"><span class="icon icon-link"></span></a>With this LDAP re-binds to AD as the user using the password supplied</h1>
<h1 id="if-it-works-youre-in"><a href="#if-it-works-youre-in" aria-hidden="true"><span class="icon icon-link"></span></a>If it works, you're in!</h1>
<p>LDAPAuthBinds   on</p>
<p>LDAPDefaultUID          "<uid-number-galaxy-is-running-as>"
LDAPDefaultGID          "<gid-number-galaxy-is-running-as>"</p>
<h1 id="force-those-numbers-even-if-ldap-finds-a-valid-uidgid"><a href="#force-those-numbers-even-if-ldap-finds-a-valid-uidgid" aria-hidden="true"><span class="icon icon-link"></span></a>Force those numbers even if LDAP finds a valid UID/GID</h1>
<p>LDAPForceDefaultUID     on
LDAPForceDefaultGID     on</p>
<p>LDAPGenerateHomedir     on 700
LDAPGenerateHomedirPrefix "/galaxy/database/ftp/%u@example.domain"</p>
<h1 id="force-this-homedir-even-if-ldap-said-something-different"><a href="#force-this-homedir-even-if-ldap-said-something-different" aria-hidden="true"><span class="icon icon-link"></span></a>Force this homedir even if LDAP said something different</h1>
<p>LDAPForceGeneratedHomedir on</p>
<h1 id="the-username-is-already-incorporated-in-the-u-use-this-or-it-will-get-appended-again"><a href="#the-username-is-already-incorporated-in-the-u-use-this-or-it-will-get-appended-again" aria-hidden="true"><span class="icon icon-link"></span></a>The username is already incorporated in the %u, use this or it will get appended again</h1>
<p>LDAPGenerateHomedirPrefixNoUsername     on</p>
<p>TransferLog             /var/log/proftpd/xferlog
SystemLog               /var/log/proftpd/proftpd.log</p>
<h1 id="you-need-this-or-users-will-get-their-passwords-exposed-across-the-network-in-the-clear"><a href="#you-need-this-or-users-will-get-their-passwords-exposed-across-the-network-in-the-clear" aria-hidden="true"><span class="icon icon-link"></span></a>You need this or users will get their passwords exposed across the network in the clear</h1>
<p>Include /etc/proftpd/tls.conf</p>
<h1 id="these-virtuals-allow-more-than-1-proftpd"><a href="#these-virtuals-allow-more-than-1-proftpd" aria-hidden="true"><span class="icon icon-link"></span></a>These "virtuals" allow more than 1 proftpd</h1>
<h1 id="to-run-on-the-same-host-using-different-ips"><a href="#to-run-on-the-same-host-using-different-ips" aria-hidden="true"><span class="icon icon-link"></span></a>to run on the same host using different IPs.</h1>
<p>#Include /etc/proftpd/virtuals.conf</p>
<h1 id="cause-every-ftp-user-to-be-jailed-chrooted-into-their-home-directory"><a href="#cause-every-ftp-user-to-be-jailed-chrooted-into-their-home-directory" aria-hidden="true"><span class="icon icon-link"></span></a>Cause every FTP user to be "jailed" (chrooted) into their home directory</h1>
<p>DefaultRoot     "/galaxy/database/ftp/%u@example.com"</p>
<h1 id="automatically-create-home-directory-if-it-doesnt-exist"><a href="#automatically-create-home-directory-if-it-doesnt-exist" aria-hidden="true"><span class="icon icon-link"></span></a>Automatically create home directory if it doesn't exist</h1>
<p>CreateHome              on 700</p>
<h1 id="allow-users-to-overwrite-their-files"><a href="#allow-users-to-overwrite-their-files" aria-hidden="true"><span class="icon icon-link"></span></a>Allow users to overwrite their files</h1>
<p>AllowOverwrite          on</p>
<h1 id="allow-users-to-resume-interrupted-uploads"><a href="#allow-users-to-resume-interrupted-uploads" aria-hidden="true"><span class="icon icon-link"></span></a>Allow users to resume interrupted uploads</h1>
<p>AllowStoreRestart       on</p>
<pre><code>## Discussion

Where ever it's getting the information mod_ldap is looking for:
* uid
* gid
* uidNumber
* gidNumber
* homeDirectory

## Configuring ProFTPD with OpenLDAP

Helena Rasche found a set of working options for using ProFTPD with OpenLDAP
servers (instead of AD).

This configuration file can be modified and placed in
`/etc/proftpd/conf.d/galaxy.conf`

Using the /conf.d/ directory, you can allow the ProFTPd to serve both
local users (with PAM authentication) in the main configuration file,
AND galaxy users on another port.

```apache
&#x3C;VirtualHost xxx.yyy.zzz>
        RequireValidShell       off
        User                    galaxy
        Group                   galaxy
        Umask                   137 027
        AllowOverwrite          on

        # Ensure auth is LDAP
        AuthPAM                 off
        AuthOrder               mod_ldap.c

        # Serve this VirtualHost on port 4000
        Port                    4000

        # LDAP Bind information
        LDAPServer              ldaps://xxx.yyy.zzz/??sub
        LDAPUsers               "ou=People,dc=yyy,dc=zzz"  "(uid=%u)"
        LDAPAuthBinds           on

        # Force those numbers even if LDAP finds a valid UID/GID
        LDAPDefaultUID          1003
        LDAPDefaultGID          1003
        LDAPForceDefaultUID     on
        LDAPForceDefaultGID     on

        # Please generate home dir with user/group rwx permissions. Could probably be stricter
        CreateHome              on 770
        LDAPGenerateHomedir     on 770

        # Force this homedir even if LDAP said something different
        LDAPForceGeneratedHomedir               on
        LDAPGenerateHomedirPrefix               "/home/galaxy/galaxy/database/ftp/%u@cpt.tamu.edu"

        # The username is already incorporated in the %u, use this or it will get appended again
        LDAPGenerateHomedirPrefixNoUsername     on

        TransferLog             /var/log/proftpd/xfer-galaxy.log

        # Cause every FTP user to be "jailed" (chrooted) into their home directory
        DefaultRoot             "/home/galaxy/galaxy/database/ftp/%u@cpt.tamu.edu"
        # Allow users to resume interrupted uploads
        AllowStoreRestart       on
        # I set these as my passive ports because I run a very strict firewall. Change as needed
        PassivePorts            49152 50000
&#x3C;/VirtualHost>
</code></pre>
<p>Notably, this configuration allows a galaxy virtualhost to coexist with
the normal FTP capabilities provided by ProFTPd, so users can still
access their home directories AND galaxy users can upload to galaxy.
Authentication can of course be changed to suit one's needs.</p>
<h2 id="tls-configuration"><a href="#tls-configuration" aria-hidden="true"><span class="icon icon-link"></span></a>TLS Configuration</h2>
<p>If you're running the galaxy FTP portion under a VirtualHost, like
described above, you'll notice that TLS directives placed in the main
proftpd.conf file do not apply to VirtualHosts. As such, you can add a
section that looks like this to every VirtualHost that needs to be secured</p>
<pre><code class="language-apache">&#x3C;IfModule mod_tls.c>
        TLSEngine                       on
        TLSLog                          /var/log/proftpd/tls.galaxy.log
        # Your cert and private key
        TLSRSACertificateFile           /etc/ssl/certs/my.crt
        TLSRSACertificateKeyFile        /etc/ssl/private/my.key
        TLSCACertificateFile            /etc/ssl/certs/ca.bundle
        # I've found that this is required for FileZilla
        TLSOptions    NoCertRequest EnableDiags NoSessionReuseRequired
        # Most clients won't be sending certs
        TLSVerifyClient                 off
        TLSRequired                     on
&#x3C;/IfModule>
</code></pre>
</div><footer class="static-footer markdown"><p>The Galaxy Project is supported in part by NSF, NHGRI, The Huck Institutes of the Life Sciences, The Institute for CyberScience at Penn State, and Johns Hopkins University.</p>
</footer></section></div>
    <script>window.__INITIAL_STATE__={"data":{"article":{"id":"853b84dc2e9d8531c5c89ae35facdfb8","title":"Setting up ProFTPd for galaxy uploads in an Active Directory environment","tease":"","image":"","images":{},"category":null,"contact":"","date":null,"content":"\u003Cul\u003E\n\u003Cli\u003EYou want to enable FTP file uploads?\u003C\u002Fli\u003E\n\u003Cli\u003EYou are happy and able to use ProFTPd?\u003C\u002Fli\u003E\n\u003Cli\u003EYou want to authenticate off Active Directory?\u003C\u002Fli\u003E\n\u003Cli\u003EYou want Galaxy to actually find the uploaded files?\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EYes, Yes, Yes and Of_Course?  Read on..\u003C\u002Fp\u003E\n\u003Ch2 id=\"some-background\"\u003E\u003Ca href=\"#some-background\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ESome background\u003C\u002Fh2\u003E\n\u003Cp\u003EGalaxy grew up serving the entire internet and cannot assume a username is unique so it uses email-addresses as its user-names.\u003C\u002Fp\u003E\n\u003Cp\u003EOnce an  \"ftp_upload_dir\"  is configured, it assumes that any uploaded files are to be found in the directory  &#x3C;ftp_upload_dir\u003E\u002F\u003Cemail\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EIf it's empty or not there Galaxy reports, \"Your FTP upload directory contains no files.\"\u003C\u002Fp\u003E\n\u003Cp\u003EGalaxy checks every time you click Get Data : Upload File\u003C\u002Fp\u003E\n\u003Cp\u003EGalaxy exchanges no messages directly with the FTP server, if files are there, it shows them no matter how they got there.\u003C\u002Fp\u003E\n\u003Ch2 id=\"assumptions\"\u003E\u003Ca href=\"#assumptions\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EAssumptions\u003C\u002Fh2\u003E\n\u003Cp\u003EYour Galaxy serves a single institution with an AD domain and you're already using it to authenticate users in the Galaxy web pages.\u003C\u002Fp\u003E\n\u003Cp\u003ESo your \u003Ccode\u003Econfig\u002Fgalaxy.ini\u003C\u002Fcode\u003E file probably has lines like this in the section \u003Ccode\u003E# Enable Galaxy's \"Upload via FTP\" interface.\u003C\u002Fcode\u003E:\n\u003Ccode\u003Ebash use_remote_user = True remote_user_maildomain = example.domain ftp_upload_dir = \u002Fgalaxy\u002Fdatabase\u002Fftp\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ELine 1 means you are already using remote (apache or nginx) authentication and that your users log in using their ident as their name not their email.\u003C\u002Fp\u003E\n\u003Cp\u003ELine 2 means Galaxy is appending a fixed string  \"@example.domain\"  to ALL users to convert from ident to email.\u003C\u002Fp\u003E\n\u003Cp\u003ELine 3 tells Galaxy to look in  \"\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F\u003Cuser\u003E@example.domain\"\u003C\u002Fp\u003E\n\u003Ch2 id=\"getting-a-version-of-proftpd-that-will-actually-do-what-it-says-it-will\"\u003E\u003Ca href=\"#getting-a-version-of-proftpd-that-will-actually-do-what-it-says-it-will\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EGetting a version of ProFTPd that will actually do what it says it will\u003C\u002Fh2\u003E\n\u003Cp\u003EFor this recipe to work will need at least these versions\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Eproftpd            version 1.3.4\u003C\u002Fli\u003E\n\u003Cli\u003Eproftpd-mod-ldap   version 2.9.2   NOTE: Ubuntu-12.10 apt-get gives you version 2.9.0 which WILL NOT WORK!\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EGo to :  \u003Ca href=\"http:\u002F\u002Fhorde.net\u002F~jwm\u002Fsoftware\u002Fmod_ldap\u002F#current-release\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Ehttp:\u002F\u002Fhorde.net\u002F~jwm\u002Fsoftware\u002Fmod_ldap\u002F#current-release\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Ch2 id=\"discussion\"\u003E\u003Ca href=\"#discussion\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EDiscussion\u003C\u002Fh2\u003E\n\u003Cp\u003EThe functionality of defining where home dir is and creating it has just been moved from mod_ldap into proftpd itself.\u003C\u002Fp\u003E\n\u003Cp\u003EThe extra functionality specifying it using a string containing %u is new to the internal proftpd.\u003C\u002Fp\u003E\n\u003Cp\u003EUsing the versions specified and re-specifying the %u string to both proftpd and mod-ldap makes it not just accept the string but actually create the directory if it doesn't already exist.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-apache\"\u003E# This tells proftpd to create it if necessary and chroot to it\nDefaultRoot     \"\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@example.domain\"\nCreateHome              on 700\n\n# This tells mod_ldap the same thing\nLDAPGenerateHomedir     on 700\nLDAPGenerateHomedirPrefix \"\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@example.domain\"\nLDAPForceGeneratedHomedir on\nLDAPGenerateHomedirPrefixNoUsername     on\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 id=\"configuring-proftpd\"\u003E\u003Ca href=\"#configuring-proftpd\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EConfiguring ProFTPd\u003C\u002Fh2\u003E\n\u003Cp\u003EHere is a commented more complete file from  \u002Fetc\u002Fproftpd\u002Fproftpd.conf\n`\u003Ccode\u003E\u003C\u002Fcode\u003Eapache\n# Load LDAP module\nLoadModule mod_ldap.c\u003C\u002Fp\u003E\n\u003Ch1 id=\"include-some-other-modules\"\u003E\u003Ca href=\"#include-some-other-modules\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInclude some other modules\u003C\u002Fh1\u003E\n\u003Cp\u003EInclude \u002Fetc\u002Fproftpd\u002Fmodules.conf\u003C\u002Fp\u003E\n\u003Ch1 id=\"users-require-a-valid-shell-listed-in-etcshells-to-login\"\u003E\u003Ca href=\"#users-require-a-valid-shell-listed-in-etcshells-to-login\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EUsers require a valid shell listed in \u002Fetc\u002Fshells to login.\u003C\u002Fh1\u003E\n\u003Ch1 id=\"use-this-directive-to-release-that-constrain\"\u003E\u003Ca href=\"#use-this-directive-to-release-that-constrain\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EUse this directive to release that constrain.\u003C\u002Fh1\u003E\n\u003Cp\u003ERequireValidShell       off\u003C\u002Fp\u003E\n\u003Ch1 id=\"set-the-user-and-group-that-the-server-normally-runs-at\"\u003E\u003Ca href=\"#set-the-user-and-group-that-the-server-normally-runs-at\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ESet the user and group that the server normally runs at.\u003C\u002Fh1\u003E\n\u003Cp\u003EUser                    galaxy\nGroup                   galaxy\u003C\u002Fp\u003E\n\u003Ch1 id=\"umask-022-is-a-good-standard-umask-to-prevent-new-files-and-dirs\"\u003E\u003Ca href=\"#umask-022-is-a-good-standard-umask-to-prevent-new-files-and-dirs\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EUmask 022 is a good standard umask to prevent new files and dirs\u003C\u002Fh1\u003E\n\u003Ch1 id=\"second-parm-from-being-group-and-world-writable\"\u003E\u003Ca href=\"#second-parm-from-being-group-and-world-writable\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E(second parm) from being group and world writable.\u003C\u002Fh1\u003E\n\u003Cp\u003EUmask                   137 027\n# Normally, we want files to be overwriteable.\nAllowOverwrite          on\u003C\u002Fp\u003E\n\u003Ch1 id=\"uncomment-this-if-you-are-using-nis-or-ldap-via-nss-to-retrieve-passwords\"\u003E\u003Ca href=\"#uncomment-this-if-you-are-using-nis-or-ldap-via-nss-to-retrieve-passwords\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EUncomment this if you are using NIS or LDAP via NSS to retrieve passwords:\u003C\u002Fh1\u003E\n\u003Ch1 id=\"persistentpasswd------off\"\u003E\u003Ca href=\"#persistentpasswd------off\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPersistentPasswd      off\u003C\u002Fh1\u003E\n\u003Ch1 id=\"galaxy-users-are-not-necessarily-ssh-users-so-dont-authenticate-against-real-system-users\"\u003E\u003Ca href=\"#galaxy-users-are-not-necessarily-ssh-users-so-dont-authenticate-against-real-system-users\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EGalaxy users are not necessarily SSH users, so don't authenticate against real (system) users\u003C\u002Fh1\u003E\n\u003Cp\u003EAuthPAM                 off\u003C\u002Fp\u003E\n\u003Ch1 id=\"all-authentication-is-via-ldap-to-ad\"\u003E\u003Ca href=\"#all-authentication-is-via-ldap-to-ad\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EAll authentication is via LDAP to AD\u003C\u002Fh1\u003E\n\u003Cp\u003E#AuthOrder              mod_auth_pam.c* mod_auth_unix.c\nAuthOrder               mod_ldap.c\u003C\u002Fp\u003E\n\u003Ch1 id=\"you-must-not-use-url-style-ldapserver\"\u003E\u003Ca href=\"#you-must-not-use-url-style-ldapserver\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EYou MUST NOT use URL style LDAPServer\u003C\u002Fh1\u003E\n\u003Cp\u003ELDAPServer      ad-server.example.domain:389\u003C\u002Fp\u003E\n\u003Ch1 id=\"i-cant-get-this-to-work-need-to-fiddle-with-certificates-more\"\u003E\u003Ca href=\"#i-cant-get-this-to-work-need-to-fiddle-with-certificates-more\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EI can't get this to work, need to fiddle with certificates more\u003C\u002Fh1\u003E\n\u003Cp\u003E#LDAPUseTLS on\u003C\u002Fp\u003E\n\u003Ch1 id=\"you-can-map-fields-using-ldapattr\"\u003E\u003Ca href=\"#you-can-map-fields-using-ldapattr\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EYou can map fields using LDAPAttr\u003C\u002Fh1\u003E\n\u003Ch1 id=\"ldapattr------expectedfield---weird-ad-name-with-spaces-and-all-sorts-of-crap\"\u003E\u003Ca href=\"#ldapattr------expectedfield---weird-ad-name-with-spaces-and-all-sorts-of-crap\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ELDAPAttr      expectedField   \"weird AD name with spaces and all sorts of crap\"\u003C\u002Fh1\u003E\n\u003Cp\u003ELDAPAttr        homeDirectory   \"unixHomeDirectory\"\u003C\u002Fp\u003E\n\u003Ch1 id=\"\"\u003E\u003C\u002Fh1\u003E\n\u003Cp\u003ELDAPBindDN      \"CN=\u003Cread-only-account\u003E,OU=Special Accounts,DC=ad,DC=example,DC=domain\"    \"password\"\u003C\u002Fp\u003E\n\u003Ch1 id=\"this-defines-the-scope-and-search-filter-to-find-a-user-in-ad\"\u003E\u003Ca href=\"#this-defines-the-scope-and-search-filter-to-find-a-user-in-ad\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EThis defines the scope and search filter to find a user in AD\u003C\u002Fh1\u003E\n\u003Cp\u003ELDAPUsers       \"OU=People,DC=ad,DC=example,DC=domain\"  \"(cn=%u)\"\u003C\u002Fp\u003E\n\u003Ch1 id=\"with-this-ldap-re-binds-to-ad-as-the-user-using-the-password-supplied\"\u003E\u003Ca href=\"#with-this-ldap-re-binds-to-ad-as-the-user-using-the-password-supplied\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EWith this LDAP re-binds to AD as the user using the password supplied\u003C\u002Fh1\u003E\n\u003Ch1 id=\"if-it-works-youre-in\"\u003E\u003Ca href=\"#if-it-works-youre-in\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EIf it works, you're in!\u003C\u002Fh1\u003E\n\u003Cp\u003ELDAPAuthBinds   on\u003C\u002Fp\u003E\n\u003Cp\u003ELDAPDefaultUID          \"\u003Cuid-number-galaxy-is-running-as\u003E\"\nLDAPDefaultGID          \"\u003Cgid-number-galaxy-is-running-as\u003E\"\u003C\u002Fp\u003E\n\u003Ch1 id=\"force-those-numbers-even-if-ldap-finds-a-valid-uidgid\"\u003E\u003Ca href=\"#force-those-numbers-even-if-ldap-finds-a-valid-uidgid\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EForce those numbers even if LDAP finds a valid UID\u002FGID\u003C\u002Fh1\u003E\n\u003Cp\u003ELDAPForceDefaultUID     on\nLDAPForceDefaultGID     on\u003C\u002Fp\u003E\n\u003Cp\u003ELDAPGenerateHomedir     on 700\nLDAPGenerateHomedirPrefix \"\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@example.domain\"\u003C\u002Fp\u003E\n\u003Ch1 id=\"force-this-homedir-even-if-ldap-said-something-different\"\u003E\u003Ca href=\"#force-this-homedir-even-if-ldap-said-something-different\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EForce this homedir even if LDAP said something different\u003C\u002Fh1\u003E\n\u003Cp\u003ELDAPForceGeneratedHomedir on\u003C\u002Fp\u003E\n\u003Ch1 id=\"the-username-is-already-incorporated-in-the-u-use-this-or-it-will-get-appended-again\"\u003E\u003Ca href=\"#the-username-is-already-incorporated-in-the-u-use-this-or-it-will-get-appended-again\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EThe username is already incorporated in the %u, use this or it will get appended again\u003C\u002Fh1\u003E\n\u003Cp\u003ELDAPGenerateHomedirPrefixNoUsername     on\u003C\u002Fp\u003E\n\u003Cp\u003ETransferLog             \u002Fvar\u002Flog\u002Fproftpd\u002Fxferlog\nSystemLog               \u002Fvar\u002Flog\u002Fproftpd\u002Fproftpd.log\u003C\u002Fp\u003E\n\u003Ch1 id=\"you-need-this-or-users-will-get-their-passwords-exposed-across-the-network-in-the-clear\"\u003E\u003Ca href=\"#you-need-this-or-users-will-get-their-passwords-exposed-across-the-network-in-the-clear\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EYou need this or users will get their passwords exposed across the network in the clear\u003C\u002Fh1\u003E\n\u003Cp\u003EInclude \u002Fetc\u002Fproftpd\u002Ftls.conf\u003C\u002Fp\u003E\n\u003Ch1 id=\"these-virtuals-allow-more-than-1-proftpd\"\u003E\u003Ca href=\"#these-virtuals-allow-more-than-1-proftpd\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EThese \"virtuals\" allow more than 1 proftpd\u003C\u002Fh1\u003E\n\u003Ch1 id=\"to-run-on-the-same-host-using-different-ips\"\u003E\u003Ca href=\"#to-run-on-the-same-host-using-different-ips\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Eto run on the same host using different IPs.\u003C\u002Fh1\u003E\n\u003Cp\u003E#Include \u002Fetc\u002Fproftpd\u002Fvirtuals.conf\u003C\u002Fp\u003E\n\u003Ch1 id=\"cause-every-ftp-user-to-be-jailed-chrooted-into-their-home-directory\"\u003E\u003Ca href=\"#cause-every-ftp-user-to-be-jailed-chrooted-into-their-home-directory\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECause every FTP user to be \"jailed\" (chrooted) into their home directory\u003C\u002Fh1\u003E\n\u003Cp\u003EDefaultRoot     \"\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@example.com\"\u003C\u002Fp\u003E\n\u003Ch1 id=\"automatically-create-home-directory-if-it-doesnt-exist\"\u003E\u003Ca href=\"#automatically-create-home-directory-if-it-doesnt-exist\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EAutomatically create home directory if it doesn't exist\u003C\u002Fh1\u003E\n\u003Cp\u003ECreateHome              on 700\u003C\u002Fp\u003E\n\u003Ch1 id=\"allow-users-to-overwrite-their-files\"\u003E\u003Ca href=\"#allow-users-to-overwrite-their-files\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EAllow users to overwrite their files\u003C\u002Fh1\u003E\n\u003Cp\u003EAllowOverwrite          on\u003C\u002Fp\u003E\n\u003Ch1 id=\"allow-users-to-resume-interrupted-uploads\"\u003E\u003Ca href=\"#allow-users-to-resume-interrupted-uploads\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EAllow users to resume interrupted uploads\u003C\u002Fh1\u003E\n\u003Cp\u003EAllowStoreRestart       on\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E## Discussion\n\nWhere ever it's getting the information mod_ldap is looking for:\n* uid\n* gid\n* uidNumber\n* gidNumber\n* homeDirectory\n\n## Configuring ProFTPD with OpenLDAP\n\nHelena Rasche found a set of working options for using ProFTPD with OpenLDAP\nservers (instead of AD).\n\nThis configuration file can be modified and placed in\n`\u002Fetc\u002Fproftpd\u002Fconf.d\u002Fgalaxy.conf`\n\nUsing the \u002Fconf.d\u002F directory, you can allow the ProFTPd to serve both\nlocal users (with PAM authentication) in the main configuration file,\nAND galaxy users on another port.\n\n```apache\n&#x3C;VirtualHost xxx.yyy.zzz\u003E\n        RequireValidShell       off\n        User                    galaxy\n        Group                   galaxy\n        Umask                   137 027\n        AllowOverwrite          on\n\n        # Ensure auth is LDAP\n        AuthPAM                 off\n        AuthOrder               mod_ldap.c\n\n        # Serve this VirtualHost on port 4000\n        Port                    4000\n\n        # LDAP Bind information\n        LDAPServer              ldaps:\u002F\u002Fxxx.yyy.zzz\u002F??sub\n        LDAPUsers               \"ou=People,dc=yyy,dc=zzz\"  \"(uid=%u)\"\n        LDAPAuthBinds           on\n\n        # Force those numbers even if LDAP finds a valid UID\u002FGID\n        LDAPDefaultUID          1003\n        LDAPDefaultGID          1003\n        LDAPForceDefaultUID     on\n        LDAPForceDefaultGID     on\n\n        # Please generate home dir with user\u002Fgroup rwx permissions. Could probably be stricter\n        CreateHome              on 770\n        LDAPGenerateHomedir     on 770\n\n        # Force this homedir even if LDAP said something different\n        LDAPForceGeneratedHomedir               on\n        LDAPGenerateHomedirPrefix               \"\u002Fhome\u002Fgalaxy\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@cpt.tamu.edu\"\n\n        # The username is already incorporated in the %u, use this or it will get appended again\n        LDAPGenerateHomedirPrefixNoUsername     on\n\n        TransferLog             \u002Fvar\u002Flog\u002Fproftpd\u002Fxfer-galaxy.log\n\n        # Cause every FTP user to be \"jailed\" (chrooted) into their home directory\n        DefaultRoot             \"\u002Fhome\u002Fgalaxy\u002Fgalaxy\u002Fdatabase\u002Fftp\u002F%u@cpt.tamu.edu\"\n        # Allow users to resume interrupted uploads\n        AllowStoreRestart       on\n        # I set these as my passive ports because I run a very strict firewall. Change as needed\n        PassivePorts            49152 50000\n&#x3C;\u002FVirtualHost\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENotably, this configuration allows a galaxy virtualhost to coexist with\nthe normal FTP capabilities provided by ProFTPd, so users can still\naccess their home directories AND galaxy users can upload to galaxy.\nAuthentication can of course be changed to suit one's needs.\u003C\u002Fp\u003E\n\u003Ch2 id=\"tls-configuration\"\u003E\u003Ca href=\"#tls-configuration\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ETLS Configuration\u003C\u002Fh2\u003E\n\u003Cp\u003EIf you're running the galaxy FTP portion under a VirtualHost, like\ndescribed above, you'll notice that TLS directives placed in the main\nproftpd.conf file do not apply to VirtualHosts. As such, you can add a\nsection that looks like this to every VirtualHost that needs to be secured\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-apache\"\u003E&#x3C;IfModule mod_tls.c\u003E\n        TLSEngine                       on\n        TLSLog                          \u002Fvar\u002Flog\u002Fproftpd\u002Ftls.galaxy.log\n        # Your cert and private key\n        TLSRSACertificateFile           \u002Fetc\u002Fssl\u002Fcerts\u002Fmy.crt\n        TLSRSACertificateKeyFile        \u002Fetc\u002Fssl\u002Fprivate\u002Fmy.key\n        TLSCACertificateFile            \u002Fetc\u002Fssl\u002Fcerts\u002Fca.bundle\n        # I've found that this is required for FileZilla\n        TLSOptions    NoCertRequest EnableDiags NoSessionReuseRequired\n        # Most clients won't be sending certs\n        TLSVerifyClient                 off\n        TLSRequired                     on\n&#x3C;\u002FIfModule\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.f7f9943a.js" defer></script><script src="/assets/js/page--src--templates--article-vue.9c961af0.js" defer></script>
  </body>
</html>
