<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Cleaning up Dataset Objects - Galaxy Community Hub</title><meta name="gridsome:hash" content="413b95c96e3c2a1187afbfe2a34414202ea5b44f"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="All about Galaxy and its community."><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.7d4a227415c9d9b704d56a079d49a3e1.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.7d4a227415c9d9b704d56a079d49a3e1.png"><link rel="preload" href="/assets/css/0.styles.72a588e3.css" as="style"><link rel="preload" href="/assets/js/app.fcdfbc15.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--article-vue.d39bea03.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.9b913011.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-vue.0374e127.js"><link rel="prefetch" href="/assets/js/page--src--pages--careers-vue.40dbc67b.js"><link rel="prefetch" href="/assets/js/page--src--pages--data-explorer-vue.7be764f6.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--archive-vue.74914e11.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--cofests--papercuts-vue.e9671322.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--cofests-vue.475ee9ea.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--webinars-vue.a92f69ed.js"><link rel="prefetch" href="/assets/js/page--src--pages--events-vue.86633aef.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.5d7f31a2.js"><link rel="prefetch" href="/assets/js/page--src--pages--news-vue.8bbabb7a.js"><link rel="prefetch" href="/assets/js/page--src--pages--search-vue.5743b76f.js"><link rel="prefetch" href="/assets/js/page--src--pages--tests-vue.3b995c11.js"><link rel="prefetch" href="/assets/js/page--src--pages--use-vue.b58be75c.js"><link rel="prefetch" href="/assets/js/page--src--templates--platform-vue.a5091f48.js"><link rel="prefetch" href="/assets/js/page--src--templates--vue-article-vue.47072703.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--careers-vue~page--src--pages--search-vue~page--src--pages--use-vue~page--s~03b83bcf.92a3a9c1.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--search-vue.1f4550c9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--index-md.f2a5f31e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--md--imgtests--imgdir--index-md.2b79d079.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--partials--index-md.628e30c8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--imgtests--imgdir--index-md.f03bb4c4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--imgtests--index-md.35d1c6cc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--index-md.75510b9d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--syntaxtests--index-md.4a83ec34.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--syntaxtests--reldir--index-md.75397503.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--capacity-planning--index-md.efd8e2ee.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--config--index-md.2b0bf7b2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--config--performance--cluster--legacy--index-md.3249b26e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--datatypes--index-md.01ea7204.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--disk-quotas--index-md.b8078def.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--faq--index-md.0fc57d04.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--internals--data-model--index-md.8466e76f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--internals--galaxy-ops--index-md.0a4af811.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--ten-simple-steps-galaxy-as-a-service--index-md.f99b3aa4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--tools--tool-config-syntax--index-md.11123b3a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--tools--writing-tests--index-md.9f073e1f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--allocation--index-md.d0d6cb19.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--faq--index-md.2f511812.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--index-md.c41eb1f1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--ssh--index-md.37407149.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--troubleshooting--index-md.e3b93bfb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--capacity-planning--index-md.3e3f08ed.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--getting-started--index-md.34edc5b0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--index-md.085298a6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--building--index-md.48c7928e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--capacity-planning--index-md.dc28801d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--cluster-types--index-md.782a776c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--customizing--index-md.b66ff518.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--faq--index-md.249d6dea.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--getting-started--index-md.d784cfc7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--getting-started--pre-201703--index-md.26b7433d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--hadoop--index-md.9b5d2d97.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--ht-condor--index-md.d69bbf95.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--index-md.03699c7b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--openstack--index-md.e3ab5241.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--services--index-md.a43786e4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--sharing--index-md.635322cc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--troubleshooting--index-md.7d6ac8fd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--userdata--index-md.6d88c037.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--future--index-md.2846f256.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--index-md.c8826f29.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-07-09--index-md.525d3254.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-07-27--index-md.6cacb399.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-09-19--index-md.d2ab996f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-11-14--index-md.f452e906.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-01-16--index-md.06b4ce78.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-03-20--index-md.eb2d2bfa.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-05-15--index-md.8eb40b44.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-11-20--index-md.894311a9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-02-19--index-md.9911b153.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-04-16--index-md.b64e304f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-06-18--index-md.d46ca3b2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-08-20--index-md.5155d643.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-10-15--index-md.ac219386.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-02-18--index-md.19fe7a17.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-04-21--index-md.d33e9890.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-06-16--index-md.ca26ec4d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-08-18--index-md.2e1f2914.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--index-md.f14a9e57.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--webinar-tech--index-md.71f2c349.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--2012--index-md.0e31b179.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--2014--index-md.45610e7a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--index-md.229be9e2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--data--index-md.de84465b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--datafiles--index-md.36e5ea43.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--architecture--index-md.aba0641d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--bitbucket--index-md.2bafcb32.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--css--index-md.6a390b11.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--getting-started--index-md.0c47dcfb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--index-md.0fdad384.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--jsa--index-md.eec7bf13.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--mercurial--index-md.67ae694f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--security-tool-tips--index-md.99c0b6ff.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--galaxy-project--index-md.30907eb9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--index-md.59e77e37.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--papers--index-md.84e1f8bc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--posters--index-md.e744899d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--presentations--index-md.36edf2dd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--videos--index-md.5809666e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--advanced-session--index-md.9f668609.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--basics-session--index-md.d1026fa6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--index-md.54b7607d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--logistics--index-md.4d576443.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--publicity--index-md.71957150.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--registration--index-md.d35deca3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--abstracts--index-md.bece521b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--index-md.fc6f37c1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--key-dates--index-md.268bcca9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--lightning-talks--index-md.0eabcf6c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--logistics--index-md.256fbd75.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--organizing-committee--index-md.bc3f374e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--photos--index-md.c945298b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--automation-strategies--index-md.007aed7b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--bioinformatics-training--index-md.025c8892.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--end-users--index-md.1267c416.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--workflows-and-api--index-md.33e73245.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--index-md.ae92c5b8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--promotion--index-md.c6b8bf8f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--register--index-md.6002857b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--sponsorships--index-md.a47b6a40.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--training-day--index-md.82031bf0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--index-md.aefd207c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--posters--index-md.491d0d97.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--talks--index-md.52379345.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--clinical-use-hpc-file-systems--index-md.e8f8010f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-admins--index-md.12cc062d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-blast--index-md.91f4a8e4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-professionals--index-md.4d7911f2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--index-md.35b144ff.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--proteomics--index-md.65bf3160.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--public-galaxy-servers--index-md.85529c92.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--tool-developers--index-md.aa1367ce.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--index-md.824a5335.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--key-dates--index-md.2f29ae58.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--lightning--index-md.419f1ab0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--logistics--index-md.d1290147.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--organizers--index-md.ab999725.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--photos--index-md.b2539a8d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--program--index-md.46107079.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--promotion--index-md.39979c96.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--register--index-md.54b81d52.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--sponsorships--index-md.31402e62.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--advance-tool-data--index-md.d30161ad.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--api--index-md.152c09eb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--index-md.d9a032a9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--intro-tool-data--index-md.4ad696de.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--vms--index-md.43551777.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--index-md.2de90984.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--posters--index-md.954a027c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--talks--index-md.cb466034.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--branch-release-merge--index-md.509e5efa.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-admins--index-md.d18af831.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-end-users--index-md.b43f25fa.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-training-network--index-md.ad69401d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--heterogeneous--index-md.d5283f8e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--index-md.78732336.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--using-galaxy-ui-overview--index-md.4e1b83fa.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--hackathon--index-md.ef48baf4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--index-md.8eeff65d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--key-dates--index-md.ac1b2ce4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--lightning--index-md.7966a262.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--logistics--index-md.67a3bf88.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--organizers--index-md.8add8e0a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--photos--index-md.f9340238.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--program--index-md.91a8cb9c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--promotion--index-md.677938b6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--register--index-md.7edc6038.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--sponsor-exhibit--index-md.570c97e5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--admin-walkthrough--index-md.a75c82c6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--api--index-md.1aa3091e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--data-managers--index-md.ddd7b1d0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--index-md.1e69be67.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--vms--index-md.4bdd705d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--cwl--index-md.149c3975.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--data-management-challenges--index-md.1cfb2e2a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--data-splitting-and-parallelism--index-md.0ef71c50.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--elixir--index-md.41af4a0c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--extended-workflow--index-md.fba0e235.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--fots--index-md.6b066209.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-admins--index-md.90ad7b28.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-community-uk--index-md.834a9d27.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-scientists--index-md.dc4d471e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-training-network--index-md.dfec5ad9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--index-md.e964bbbc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--data-hack-roundup--index-md.a8e80079.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--header--index-md.e41ba19d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--index-md.3a48509b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2016--bofs--index-md.20cf0102.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--abstracts--index-md.8c30af0f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--childcare--index-md.76481903.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--cofest--index-md.885fc4f0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--conduct--index-md.3ba19fc4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--faq--index-md.f529111b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--index-md.078e57a2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--organizers--index-md.c81da5e1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--promotion--index-md.60b148a3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--registration--index-md.b6d2109b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--sponsors--index-md.cc313f0f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--training--index-md.37849240.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--venue--index-md.b4fdb14c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--abstracts--index-md.32d083d2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--childcare--index-md.824c7641.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--code-of-conduct--index-md.b69baa14.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--collaboration--index-md.57cfe157.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--faq--index-md.ca719686.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--icebreaker--index-md.43e62fad.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--index-md.32966a5c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--keynotes--index-md.ad018a46.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--organizers--index-md.d8c63e11.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--promotion--index-md.9770e962.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--register--index-md.81755779.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--sponsors--index-md.1ddc1b15.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--training--index-md.a962dccd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--venue--index-md.ddca2ef3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--germany-2014--index-md.97a02bf9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--germany-2016--index-md.1e844eaa.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--sg-2014--index-md.66eb2bdb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--sg-2016--index-md.7fae3751.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2014--index-md.fbe95ffb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2014--trainingday--index-md.2cb6bd54.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2016--index-md.73b9647e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--example--vue-remark--index-md.50588fa2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--faqs--index-md.766ea234.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--galaxy-updates--2013-06--index-md.991b0b71.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--galaxy-updates--2013-07--index-md.cec51cf2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--icons--index-md.6f3080f1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--index-md.68e143df.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--logos--index-md.e2d4de57.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--news-graphics--index-md.99a3f1a3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--photos--index-md.f4296d49.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--screenshots--index-md.b2707870.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--basic-editing--index-md.b813bed3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--basic-editing--workflow-editor-unannotated--index-md.96a31256.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--extract--index-md.b557db83.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--tool-panel--index-md.804a6f1d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--variables--index-md.dbd8d323.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--faq--index-md.87d3d644.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--galaxy-pages--index-md.07fcf13f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--interval-operations--index-md.99a16397.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--main--faq--index-md.f4015810.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--tools--requirements--index-md.cde2a0cf.js"><link rel="stylesheet" href="/assets/css/0.styles.72a588e3.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout" data-v-340f7abc><header id="masthead"><nav class="navbar container justify-content-center navbar-dark bg-transparent navbar-expand-lg"><a href="/" target="_self" class="navbar-brand router-link-active"><img id="masthead-logo" src="/images/galaxy_logo_hub_white.svg" alt="Galaxy Community Hub" height="30"></a><button type="button" aria-label="Toggle navigation" class="navbar-toggler"><span class="navbar-toggler-icon"></span></button><div id="nav-collapse" class="navbar-collapse collapse" style="display:none;"><ul class="navbar-nav"><li class="nav-item"><a href="/use/" target="_self" class="nav-link">Use</a></li><li class="nav-item b-nav-dropdown dropdown"><a role="button" aria-haspopup="true" aria-expanded="false" href="#" target="_self" class="nav-link dropdown-toggle"><span>Learn</span></a><ul tabindex="-1" class="dropdown-menu"><li role="presentation"><a href="/learn/" role="menuitem" target="_self" class="dropdown-item">How to use Galaxy</a></li><li role="presentation"><a role="menuitem" href="https://training.galaxyproject.org/" target="_self" class="dropdown-item">Teach with Galaxy</a></li></ul></li><li class="nav-item b-nav-dropdown dropdown"><a role="button" aria-haspopup="true" aria-expanded="false" href="#" target="_self" class="nav-link dropdown-toggle"><span>Community</span></a><ul tabindex="-1" class="dropdown-menu"><li role="presentation"><a href="/community/" role="menuitem" target="_self" class="dropdown-item">About</a></li><li role="presentation"><a href="/events/" role="menuitem" target="_self" class="dropdown-item">Events</a></li><li role="presentation"><a href="/news/" role="menuitem" target="_self" class="dropdown-item">News</a></li><li role="presentation"><a href="/blog/" role="menuitem" target="_self" class="dropdown-item">Blog</a></li><li role="presentation"><a href="/publication-library/" role="menuitem" target="_self" class="dropdown-item">Publications</a></li><li role="presentation"><a href="/galaxy-project/statistics/" role="menuitem" target="_self" class="dropdown-item">Stats</a></li><li role="presentation"><a href="/careers/" role="menuitem" target="_self" class="dropdown-item">Careers</a></li></ul></li><li class="nav-item b-nav-dropdown dropdown"><a role="button" aria-haspopup="true" aria-expanded="false" href="#" target="_self" class="nav-link dropdown-toggle"><span>Deploy &amp; Develop</span></a><ul tabindex="-1" class="dropdown-menu"><li role="presentation"><a href="/admin/get-galaxy/" role="menuitem" target="_self" class="dropdown-item">Install Galaxy</a></li><li role="presentation"><a href="/admin/" role="menuitem" target="_self" class="dropdown-item router-link-active">Server administration</a></li><li role="presentation"><a href="/tools/" role="menuitem" target="_self" class="dropdown-item">Tools</a></li><li role="presentation"><a href="/develop/api/" role="menuitem" target="_self" class="dropdown-item">Working with the API</a></li><li role="presentation"><a href="/develop/" role="menuitem" target="_self" class="dropdown-item">Contributing</a></li><li role="presentation"><a href="/docs/" role="menuitem" target="_self" class="dropdown-item">Code documentation</a></li></ul></li><li class="nav-item b-nav-dropdown dropdown"><a role="button" aria-haspopup="true" aria-expanded="false" href="#" target="_self" class="nav-link dropdown-toggle"><span>Support</span></a><ul tabindex="-1" class="dropdown-menu"><li role="presentation"><a href="/support/" role="menuitem" target="_self" class="dropdown-item">FAQ</a></li><li role="presentation"><a role="menuitem" href="https://help.galaxyproject.org/" target="_self" class="dropdown-item">Galaxy Help Forum</a></li></ul></li><li class="nav-item"><a href="/jxtx/" target="_self" class="nav-link">@jxtx</a></li></ul><ul class="navbar-nav ml-auto"><li class="form-inline"><form action="/search/" method="get" class="form-inline"><input id="search-input" name="q" type="text" placeholder="Search Galaxy" value="" class="mr-sm-2 form-control form-control-sm"><button type="submit" class="btn my-2 my-sm-0 btn-secondary btn-sm"><span class="fa fa-search"></span></button></form></li></ul></div></nav></header><section id="maincontainer" class="container"><header data-v-42ee6b0f data-v-340f7abc><a href="/" class="link active" data-v-42ee6b0f>‚Üê Back to Home</a><!----><h1 class="title" data-v-42ee6b0f>Cleaning up Dataset Objects</h1><!----><section class="metadata freetext" data-v-42ee6b0f><!----><!----><!----></section><!----><!----></header><div class="content markdown" data-v-340f7abc><div class="toc-wrapper col-md-3">
<ul>
<li><a href="#background-on-dataset-objects">Background on Dataset Objects</a></li>
<li>
<p><a href="#purging-unwanted-histories-libraries-and-datasets">Purging Unwanted Histories, Libraries and Datasets</a></p>
<ul>
<li><a href="#available-flags">Available Flags:</a></li>
<li><a href="#deleting-userless-histories">Deleting Userless Histories</a></li>
<li><a href="#purging-deleted-histories">Purging Deleted Histories</a></li>
<li><a href="#purging-deleted-datasets">Purging Deleted Datasets</a></li>
<li><a href="#purging-library-folders">Purging Library Folders</a></li>
<li><a href="#purging-libraries">Purging Libraries</a></li>
<li><a href="#deleting-datasets--purging-dataset-instances">Deleting Datasets / Purging Dataset Instances</a></li>
</ul>
</li>
</ul>
</div>
<div class="body-wrapper col-md-9">
<h2 id="background-on-dataset-objects"><a href="#background-on-dataset-objects" aria-hidden="true"><span class="icon icon-link"></span></a>Background on Dataset Objects</h2>
<p>Histories that are displayed in the history panel are stored as records in the
History table in the Galaxy database. Among other columns, the History table
includes the following:</p>
<pre><code>| id | update_time | user_id | deleted | purged |
</code></pre>
<p>When a user visits the Galaxy home page for the very first time, a new Galaxy
session is created and the session information is stored in a browser cookie. A
new history record is automatically created and associated with the session
cookie. At this point, neither the session nor the history is associated with a
user ID since the user has not logged in. Logging in is not required for using
Galaxy, but if the user logs in, their user ID is associated with both the
Galaxy session and the previously created history. In this case, the next time
the user visits the Galaxy home page and logs in, the history panel displays
the history that meets all of the following criteria:</p>
<ul>
<li>is associated with their user ID</li>
<li>contains the latest update time of any of their previously stored histories</li>
<li>is not deleted ( the history.deleted column contains the value False )</li>
</ul>
<p>When the user performs an analysis, items are added to the history which are
each associated with a dataset. These items are known as
<code>HistoryDatasetAssociation</code> objects. Information about datasets is stored in the
<code>Dataset</code> table in the Galaxy database, with the data itself stored on disk. The
Galaxy configuration file includes a <strong>file_path</strong> attribute which points to
the location on disk where the datasets are stored. Among other columns, the
Dataset table includes the following:</p>
<pre><code>| id | update_time | deleted | purged | file_size |
</code></pre>
<p>Among other columns, the <code>HistoryDatasetAssociation</code> table includes the
following:</p>
<pre><code>| id | update_time | history_id | deleted | dataset_id |
</code></pre>
<p>Every <code>HistoryDatasetAssociation</code> record associates a <code>Dataset</code> with a history
record via the values in the <code>HistoryDatasetAssociation.history_id</code> and
<code>HistoryDatasetAssociation.dataset_id</code> columns. Any number of
<code>HistoryDatasetAssociation</code> records can point to a base <code>Dataset</code> -- this is how
copying histories, history items, and libraries work without needing to copy
actual file contents.</p>
<p>Among other columns, the <code>LibraryDatasetDatasetAssociation</code> table includes the
following:</p>
<pre><code>| id | update_time | library_dataset_id | deleted | dataset_id |
</code></pre>
<p>Every <code>LibraryDatasetDatasetAssociation</code> record associates a Dataset with a
versionable library dataset record via the values in the
<code>LibraryDatasetDatasetAssociation.library_dataset_id</code> and
<code>LibraryDatasetDatasetAssociation.dataset_id columns</code>. Any number of
<code>LibraryDatasetDatasetAssociation</code> records can point to a base <code>Dataset</code>.</p>
<h2 id="purging-unwanted-histories-libraries-and-datasets"><a href="#purging-unwanted-histories-libraries-and-datasets" aria-hidden="true"><span class="icon icon-link"></span></a>Purging Unwanted Histories, Libraries and Datasets</h2>
<p>A <code>Dataset</code> can only be deleted (or purged) when all <code>HistoryDatasetAssociations</code>
and <code>LibraryDatasetDatasetAssociations</code> have been marked as deleted.</p>
<p>There are 6 scripts included in the Galaxy distribution that can be used to
clean up unwanted histories, libraries and datasets. There are located in the
<code>GALAXY_ROOT/scripts/cleanup_datasets</code> directory and are named:</p>
<ul>
<li>delete_userless_histories.sh</li>
<li>purge_histories.sh</li>
<li>purge_datasets.sh</li>
<li>purge_folders.sh</li>
<li>purge_libraries.sh</li>
<li>delete_datasets.sh</li>
</ul>
<p>Note that you should activate the Galaxy virtual environment before running the scripts, as it follows.</p>
<pre><code>source /path/to/galaxy/root/.venv/bin/activate
sh delete_userless_histories.sh
sh purge_histories.sh
</code></pre>
<p>These scripts all execute the Python script in the same directory named
<code>cleanup_datasets.py</code>, sending different parameter values on the command line. If
desired, these scripts can be ignored and the <code>cleanup_datasets.py</code> scripts can
be executed manually (using the <code>GALAXY_ROOT</code> as the working directory), passing
in desired parameter values. However, these scripts can be easily configured in
cron to execute automatically. The order in which the scripts are executed will
affect the outcome; for best results, the recommended running order is:</p>
<ol>
<li>delete_userless_histories.sh</li>
<li>purge_histories.sh</li>
<li>purge_libraries.sh</li>
<li>purge_folders.sh</li>
<li>purge_datasets.sh</li>
</ol>
<p>If it is desired that datasets be removed before their outer container
(history, library/library folder) has been deleted, the <code>delete_datasets.sh</code>
script can be used before the <code>purge_datasets.sh</code> script. This script may take
some time to complete.</p>
<h3 id="available-flags"><a href="#available-flags" aria-hidden="true"><span class="icon icon-link"></span></a>Available Flags:</h3>
<table>
<thead>
<tr>
<th>flag</th>
<th>short</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>--days</td>
<td>-d</td>
<td>number of days (60) to use as a cut off; do not act on objects updated more recently than this</td>
</tr>
<tr>
<td>--info_only</td>
<td>-i</td>
<td>only provide info about the requested action; no changes saved to database</td>
</tr>
<tr>
<td>--remove_from_disk</td>
<td>-r</td>
<td>remove files from disk during operations</td>
</tr>
<tr>
<td>--force_retry</td>
<td>-f</td>
<td>performs the requested actions, but ignores whether it might have been done before. Useful when -r wasn't used, but should have been</td>
</tr>
<tr>
<td>--delete_userless_histories</td>
<td>-1</td>
<td>delete userless histories and datasets</td>
</tr>
<tr>
<td>--purge_histories</td>
<td>-2</td>
<td>purge deleted histories</td>
</tr>
<tr>
<td>--purge_datasets</td>
<td>-3</td>
<td>purge deleted datasets</td>
</tr>
<tr>
<td>--purge_libraries</td>
<td>-4</td>
<td>purge deleted libraries</td>
</tr>
<tr>
<td>--purge_folders</td>
<td>-5</td>
<td>purge deleted library folders</td>
</tr>
<tr>
<td>--delete_datasets</td>
<td>-6</td>
<td>mark deletable datasets as deleted and purge associated dataset instances</td>
</tr>
</tbody>
</table>
<p>Here are more details about each of the functions that the <code>cleanup_datasets.py</code>
script can perform. Note that, in order to run the python script separately
you need to 1) activate Galaxy's virtual environment and 2) change into Galaxy's root
directory. Alternatively to 2) one can specify the galaxy configuration (galaxy.[yml|ini])
extra parameter.</p>
<h3 id="deleting-userless-histories"><a href="#deleting-userless-histories" aria-hidden="true"><span class="icon icon-link"></span></a>Deleting Userless Histories</h3>
<p>As mentioned above, logging in is not required for using Galaxy, and in many
cases users perform an analysis without logging in to review results in a
"1-off" fashion, not caring about keeping the analysis for later review. In
this case, history record(s) are created with no associated user ID. The
cleanup_dataset.py script can be used to delete these types of histories that
have not been altered for a specified period of time. The command for deleting
userless histories is something like:</p>
<pre><code>python cleanup_datasets.py -d 60 -1
</code></pre>
<p>Notice that the first parameter passed into the script is the Galaxy
configuration file. This is necessary for the script to acquire information
about the database connection and the location of data files on disk. The value
following the -d flag is the span of time in days that has passed since a
history was last updated ( i.e., the value in the <code>History.update_time</code> column is
older than 60 days in this example ). Based on this criteria, all <code>History</code>
records that do not include a value in the <code>user_id</code> column and whose <code>update_time</code>
column value is older than 60 days will be retrieved. The -1 flag tells the
<code>cleanup_datasets.py</code> script to execute the method named
<code>delete_userless_histories()</code>, which is included in the script. This method
deletes userless histories whose <code>update_time</code> value is older than the specified
number of days by setting the value of the <code>History.delete</code> column to <code>True</code>.
Executing the same command, but providing the -i flag will not write any
changes; info about the histories to be deleted will be provided.</p>
<h3 id="purging-deleted-histories"><a href="#purging-deleted-histories" aria-hidden="true"><span class="icon icon-link"></span></a>Purging Deleted Histories</h3>
<p>In the lifecycle of a <code>History</code> record, the stage following the "deleted" stage
is the "purged" stage, the last stage in the <code>History</code> record's lifecycle. When a
<code>History</code> record is purged, all <code>HistoryDatasetAssociation</code> records associated with
the History record are purged. When a <code>HistoryDatasetAssociation</code> is purged, it
is marked as deleted. Addionally the Dataset associated with the HDA is marked
as deleted only if all associations to that <code>Dataset</code> are also purged (HDA &#x26; LDDA
are all marked as deleted); when this happens, HDAs and LDDAs are no longer
undeletable by the user - if '-r' is used the associated files and metadata
files are removed from disk (the primary Dataset File still remains on disk and
can be retrieved by an admin) . The command for purging histories and
associated HDAs is something like:</p>
<pre><code>python cleanup_datasets.py -d 60 -2 -r
</code></pre>
<p>In this example, the -2 flag tells the <code>cleanup_dataset.py</code> script to execute the
<code>purge_histories()</code> method included in the script. This method retrieves all
<code>History</code> records whose <code>History.deleted</code> column value is True, <code>History.purged</code>
column value is <code>False</code> and whose <code>History.update_time</code> column value is older than
the specified number of days ( 60 in this example ). All
<code>HistoryDatasetAssociation</code> records associated with the History record are also
purged by setting the <code>HistoryDatasetAssociation.deleted</code> column value to <code>True</code>;
any additional <code>DatasetAssociations</code> (HDA/LDDA) are polled and if they all have
<code>HistoryDatasetAssociation.deleted==True</code>, the <code>Dataset.deleted</code> column is set to
<code>True</code>. The -r flag in this example tells the <code>cleanup_dataset.py</code> script to remove
the files (metadata etc) associated with the <code>HistoryDatasetAssociation</code> record
from disk (only if <code>Dataset.deleted</code> is to be set to True). Executing the same
command but replacing the -r flag with -i will print out all of the <code>History</code> and
associated <code>HistoryDatasetAssociation</code> records that will be purged if the -r flag
is used.</p>
<h3 id="purging-deleted-datasets"><a href="#purging-deleted-datasets" aria-hidden="true"><span class="icon icon-link"></span></a>Purging Deleted Datasets</h3>
<p>Dataset records are moved to the "deleted" stage when all <code>History</code> and <code>Library</code>
records associated with the dataset are deleted as described above.</p>
<p>The next stage in the lifecycle of a deleted Dataset record is the "purged"
stage, the last stage in the <code>Dataset</code> record's lifecycle. The command for
purging datasets is something like:</p>
<pre><code>python cleanup_datasets.py -d 60 -3 -r
</code></pre>
<p>In this example, the -3 flag tells the <code>cleanup_dataset.py</code> script to execute the
<code>purge_datasets()</code> method included in the script. This method retrieves all
<code>Dataset</code> records whose <code>Dataset.deleted</code> column value is True, <code>Dataset.purged</code> is
<code>False</code> and whose <code>Dataset.update_time</code> column value is older than the specified
number of days ( 60 in this example ). The Dataset records are purged by
setting the <code>Dataset.purged</code> column to True. As described above, the -r flag in
this example tells the <code>cleanup_dataset.py</code> script to remove the data file
associated with the Dataset record from disk. Executing the same command but
replacing the -r flag with -i will print out all of the Dataset records that
will be purged if the -r flag is used.</p>
<h3 id="purging-library-folders"><a href="#purging-library-folders" aria-hidden="true"><span class="icon icon-link"></span></a>Purging Library Folders</h3>
<p>Besides existing in user's history, dataset association objects exist with in
<code>Library</code> Folders; they are known as <code>LibraryDatasetDatasetAssociations</code> (LDDAs).
Purging a library folder is similar to purging a History. An example command
is:</p>
<pre><code>python cleanup_datasets.py -d 60 -5 -r
</code></pre>
<p>In this example, the -5 flag tells the <code>cleanup_dataset.py</code> script to execute the
<code>purge_folders()</code> method included in the script. This method retrieves all
<code>LibraryFolder</code> records whose <code>LibraryFolder.deleted</code> column value is <code>True</code>,
<code>LibraryFolder.purged</code> column value is <code>False</code> and whose <code>LibraryFolder.update_time</code>
column value is older than the specified number of days ( 60 in this example ).
It works recursively on all subfolders and their contents. All
<code>LibraryDatasetDatasetAssociations</code> records associated with the <code>LibraryFolder</code>
record are also purged by setting the <code>LibraryDatasetDatasetAssociation.deleted</code>
column value to <code>True</code>; any additional <code>DatasetAssociations</code> (HDA/LDDA) are polled
and if they all have
<code>HistoryDatasetAssociation(LibraryDatasetDatasetAssociation).deleted==True</code>, the
<code>Dataset.deleted</code> column is set to <code>True</code>. The -r flag in this example tells the
<code>cleanup_dataset.py</code> script to remove the files (metadata etc) associated with
the <code>LibraryDatasetDatasetAssociation</code> record (but not the actual Dataset file)
from disk (only if <code>Dataset.deleted</code> is to be set to <code>True</code>). Executing the same
command but replacing the -r flag with -i will print out all of the
<code>LibraryFolders</code> and associated <code>LibraryDatasetDatasetAssociation</code> records that
will be purged if the -r flag is used.</p>
<p>As is the case with <code>Histories</code>, the <code>purge_datasets</code> script will need to be used
to remove actual Datasets from disk.</p>
<h3 id="purging-libraries"><a href="#purging-libraries" aria-hidden="true"><span class="icon icon-link"></span></a>Purging Libraries</h3>
<p>Purging a library is similar to purging a <code>LibraryFolder</code>. All libraries which
are not purged, but are deleted and exceed the modified date are retrieved. The
library is marked as purged and <code>purge_folder</code> is called on the library's root
folder, deleting all contents. An example command is:</p>
<pre><code>python cleanup_datasets.py -d 60 -4 -r
</code></pre>
<p>In this example, the -4 flag tells the <code>cleanup_dataset.py</code> script to execute the
<code>purge_libraries()</code> method included in the script. This method retrieves all
<code>Library</code> records whose <code>Library.deleted</code> column value is True, <code>Library.purged</code>
column value is False and whose <code>LibraryFolder.update_time</code> column value is older
than the specified number of days ( 60 in this example ). The Library's Root
Folder is then obtained and all <code>LibraryDatasetDatasetAssociations</code> records
associated with the <code>LibraryFolder</code> record are also purged by setting the
<code>LibraryDatasetDatasetAssociation.deleted</code> column value to <code>True</code>; any additional
<code>DatasetAssociations</code> (HDA/LDDA) are polled and if they all have
<code>HistoryDatasetAssociation(LibraryDatasetDatasetAssociation).deleted==True</code>, the
<code>Dataset.deleted</code> column is set to <code>True</code>. The -r flag in this example tells the
<code>cleanup_dataset.py</code> script to remove the files (metadata etc) associated with
the <code>LibraryDatasetDatasetAssociation</code> record (but not the actual Dataset file)
from disk (only if Dataset.deleted is to be set to True). Executing the same
command but replacing the -r flag with -i will print out all of the <code>Libraries</code>,
<code>LibraryFolders</code> and associated <code>LibraryDatasetDatasetAssociation</code> records that
will be purged if the -r flag is used.</p>
<h3 id="deleting-datasets--purging-dataset-instances"><a href="#deleting-datasets--purging-dataset-instances" aria-hidden="true"><span class="icon icon-link"></span></a>Deleting Datasets / Purging Dataset Instances</h3>
<p>There are times when it is not desirable to wait for the containing <code>history</code> or
<code>library/library</code> folder to be deleted before purging a dataset instance and
marking the base dataset as deleted. The -6 flag is used for this purpose. This
script will find all Dataset records which are not deleted but are associated
with a <code>DatasetAssociation</code> that is marked as deleted and updated according to
the specified cut-off. If all associations are marked as deleted, the <code>Dataset</code>
is marked as deleted and each <code>DatasetAssociation</code> is purged. The
<code>purge_datasets.sh</code> script will need to be run afterwards to remove the base
datasets from disk.</p>
<p>An example command is: <code>python cleanup_datasets.py -d 60 -6 -r</code></p>
</div>
</div><footer data-v-54ece1d6 data-v-340f7abc><!----></footer><footer class="static-footer markdown"><p>The Galaxy Project is supported in part by NSF, NHGRI, The Huck Institutes of the Life Sciences, The Institute for CyberScience at Penn State, and Johns Hopkins University.</p>
</footer></section></div>
    <script>window.__INITIAL_STATE__={"data":{"article":{"id":"351057c8ac19af81b499a23842f9ad8b","title":"Cleaning up Dataset Objects","tease":"","category":null,"date":null,"days":null,"contact":"","contact_url":"","authors":"","location":"","location_url":"","source_blog":"","source_blog_url":"","skip_title_render":null,"links":[],"image":"","images":{},"external_url":"","content":"\u003Cdiv class=\"toc-wrapper col-md-3\"\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"#background-on-dataset-objects\"\u003EBackground on Dataset Objects\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca href=\"#purging-unwanted-histories-libraries-and-datasets\"\u003EPurging Unwanted Histories, Libraries and Datasets\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"#available-flags\"\u003EAvailable Flags:\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#deleting-userless-histories\"\u003EDeleting Userless Histories\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#purging-deleted-histories\"\u003EPurging Deleted Histories\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#purging-deleted-datasets\"\u003EPurging Deleted Datasets\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#purging-library-folders\"\u003EPurging Library Folders\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#purging-libraries\"\u003EPurging Libraries\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#deleting-datasets--purging-dataset-instances\"\u003EDeleting Datasets \u002F Purging Dataset Instances\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fdiv\u003E\n\u003Cdiv class=\"body-wrapper col-md-9\"\u003E\n\u003Ch2 id=\"background-on-dataset-objects\"\u003E\u003Ca href=\"#background-on-dataset-objects\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EBackground on Dataset Objects\u003C\u002Fh2\u003E\n\u003Cp\u003EHistories that are displayed in the history panel are stored as records in the\nHistory table in the Galaxy database. Among other columns, the History table\nincludes the following:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E| id | update_time | user_id | deleted | purged |\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EWhen a user visits the Galaxy home page for the very first time, a new Galaxy\nsession is created and the session information is stored in a browser cookie. A\nnew history record is automatically created and associated with the session\ncookie. At this point, neither the session nor the history is associated with a\nuser ID since the user has not logged in. Logging in is not required for using\nGalaxy, but if the user logs in, their user ID is associated with both the\nGalaxy session and the previously created history. In this case, the next time\nthe user visits the Galaxy home page and logs in, the history panel displays\nthe history that meets all of the following criteria:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Eis associated with their user ID\u003C\u002Fli\u003E\n\u003Cli\u003Econtains the latest update time of any of their previously stored histories\u003C\u002Fli\u003E\n\u003Cli\u003Eis not deleted ( the history.deleted column contains the value False )\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EWhen the user performs an analysis, items are added to the history which are\neach associated with a dataset. These items are known as\n\u003Ccode\u003EHistoryDatasetAssociation\u003C\u002Fcode\u003E objects. Information about datasets is stored in the\n\u003Ccode\u003EDataset\u003C\u002Fcode\u003E table in the Galaxy database, with the data itself stored on disk. The\nGalaxy configuration file includes a \u003Cstrong\u003Efile_path\u003C\u002Fstrong\u003E attribute which points to\nthe location on disk where the datasets are stored. Among other columns, the\nDataset table includes the following:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E| id | update_time | deleted | purged | file_size |\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EAmong other columns, the \u003Ccode\u003EHistoryDatasetAssociation\u003C\u002Fcode\u003E table includes the\nfollowing:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E| id | update_time | history_id | deleted | dataset_id |\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EEvery \u003Ccode\u003EHistoryDatasetAssociation\u003C\u002Fcode\u003E record associates a \u003Ccode\u003EDataset\u003C\u002Fcode\u003E with a history\nrecord via the values in the \u003Ccode\u003EHistoryDatasetAssociation.history_id\u003C\u002Fcode\u003E and\n\u003Ccode\u003EHistoryDatasetAssociation.dataset_id\u003C\u002Fcode\u003E columns. Any number of\n\u003Ccode\u003EHistoryDatasetAssociation\u003C\u002Fcode\u003E records can point to a base \u003Ccode\u003EDataset\u003C\u002Fcode\u003E -- this is how\ncopying histories, history items, and libraries work without needing to copy\nactual file contents.\u003C\u002Fp\u003E\n\u003Cp\u003EAmong other columns, the \u003Ccode\u003ELibraryDatasetDatasetAssociation\u003C\u002Fcode\u003E table includes the\nfollowing:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E| id | update_time | library_dataset_id | deleted | dataset_id |\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EEvery \u003Ccode\u003ELibraryDatasetDatasetAssociation\u003C\u002Fcode\u003E record associates a Dataset with a\nversionable library dataset record via the values in the\n\u003Ccode\u003ELibraryDatasetDatasetAssociation.library_dataset_id\u003C\u002Fcode\u003E and\n\u003Ccode\u003ELibraryDatasetDatasetAssociation.dataset_id columns\u003C\u002Fcode\u003E. Any number of\n\u003Ccode\u003ELibraryDatasetDatasetAssociation\u003C\u002Fcode\u003E records can point to a base \u003Ccode\u003EDataset\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Ch2 id=\"purging-unwanted-histories-libraries-and-datasets\"\u003E\u003Ca href=\"#purging-unwanted-histories-libraries-and-datasets\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPurging Unwanted Histories, Libraries and Datasets\u003C\u002Fh2\u003E\n\u003Cp\u003EA \u003Ccode\u003EDataset\u003C\u002Fcode\u003E can only be deleted (or purged) when all \u003Ccode\u003EHistoryDatasetAssociations\u003C\u002Fcode\u003E\nand \u003Ccode\u003ELibraryDatasetDatasetAssociations\u003C\u002Fcode\u003E have been marked as deleted.\u003C\u002Fp\u003E\n\u003Cp\u003EThere are 6 scripts included in the Galaxy distribution that can be used to\nclean up unwanted histories, libraries and datasets. There are located in the\n\u003Ccode\u003EGALAXY_ROOT\u002Fscripts\u002Fcleanup_datasets\u003C\u002Fcode\u003E directory and are named:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Edelete_userless_histories.sh\u003C\u002Fli\u003E\n\u003Cli\u003Epurge_histories.sh\u003C\u002Fli\u003E\n\u003Cli\u003Epurge_datasets.sh\u003C\u002Fli\u003E\n\u003Cli\u003Epurge_folders.sh\u003C\u002Fli\u003E\n\u003Cli\u003Epurge_libraries.sh\u003C\u002Fli\u003E\n\u003Cli\u003Edelete_datasets.sh\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003ENote that you should activate the Galaxy virtual environment before running the scripts, as it follows.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Esource \u002Fpath\u002Fto\u002Fgalaxy\u002Froot\u002F.venv\u002Fbin\u002Factivate\nsh delete_userless_histories.sh\nsh purge_histories.sh\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThese scripts all execute the Python script in the same directory named\n\u003Ccode\u003Ecleanup_datasets.py\u003C\u002Fcode\u003E, sending different parameter values on the command line. If\ndesired, these scripts can be ignored and the \u003Ccode\u003Ecleanup_datasets.py\u003C\u002Fcode\u003E scripts can\nbe executed manually (using the \u003Ccode\u003EGALAXY_ROOT\u003C\u002Fcode\u003E as the working directory), passing\nin desired parameter values. However, these scripts can be easily configured in\ncron to execute automatically. The order in which the scripts are executed will\naffect the outcome; for best results, the recommended running order is:\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003Edelete_userless_histories.sh\u003C\u002Fli\u003E\n\u003Cli\u003Epurge_histories.sh\u003C\u002Fli\u003E\n\u003Cli\u003Epurge_libraries.sh\u003C\u002Fli\u003E\n\u003Cli\u003Epurge_folders.sh\u003C\u002Fli\u003E\n\u003Cli\u003Epurge_datasets.sh\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003EIf it is desired that datasets be removed before their outer container\n(history, library\u002Flibrary folder) has been deleted, the \u003Ccode\u003Edelete_datasets.sh\u003C\u002Fcode\u003E\nscript can be used before the \u003Ccode\u003Epurge_datasets.sh\u003C\u002Fcode\u003E script. This script may take\nsome time to complete.\u003C\u002Fp\u003E\n\u003Ch3 id=\"available-flags\"\u003E\u003Ca href=\"#available-flags\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EAvailable Flags:\u003C\u002Fh3\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth\u003Eflag\u003C\u002Fth\u003E\n\u003Cth\u003Eshort\u003C\u002Fth\u003E\n\u003Cth\u003Edescription\u003C\u002Fth\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Fthead\u003E\n\u003Ctbody\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E--days\u003C\u002Ftd\u003E\n\u003Ctd\u003E-d\u003C\u002Ftd\u003E\n\u003Ctd\u003Enumber of days (60) to use as a cut off; do not act on objects updated more recently than this\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E--info_only\u003C\u002Ftd\u003E\n\u003Ctd\u003E-i\u003C\u002Ftd\u003E\n\u003Ctd\u003Eonly provide info about the requested action; no changes saved to database\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E--remove_from_disk\u003C\u002Ftd\u003E\n\u003Ctd\u003E-r\u003C\u002Ftd\u003E\n\u003Ctd\u003Eremove files from disk during operations\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E--force_retry\u003C\u002Ftd\u003E\n\u003Ctd\u003E-f\u003C\u002Ftd\u003E\n\u003Ctd\u003Eperforms the requested actions, but ignores whether it might have been done before. Useful when -r wasn't used, but should have been\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E--delete_userless_histories\u003C\u002Ftd\u003E\n\u003Ctd\u003E-1\u003C\u002Ftd\u003E\n\u003Ctd\u003Edelete userless histories and datasets\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E--purge_histories\u003C\u002Ftd\u003E\n\u003Ctd\u003E-2\u003C\u002Ftd\u003E\n\u003Ctd\u003Epurge deleted histories\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E--purge_datasets\u003C\u002Ftd\u003E\n\u003Ctd\u003E-3\u003C\u002Ftd\u003E\n\u003Ctd\u003Epurge deleted datasets\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E--purge_libraries\u003C\u002Ftd\u003E\n\u003Ctd\u003E-4\u003C\u002Ftd\u003E\n\u003Ctd\u003Epurge deleted libraries\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E--purge_folders\u003C\u002Ftd\u003E\n\u003Ctd\u003E-5\u003C\u002Ftd\u003E\n\u003Ctd\u003Epurge deleted library folders\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E--delete_datasets\u003C\u002Ftd\u003E\n\u003Ctd\u003E-6\u003C\u002Ftd\u003E\n\u003Ctd\u003Emark deletable datasets as deleted and purge associated dataset instances\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Ftbody\u003E\n\u003C\u002Ftable\u003E\n\u003Cp\u003EHere are more details about each of the functions that the \u003Ccode\u003Ecleanup_datasets.py\u003C\u002Fcode\u003E\nscript can perform. Note that, in order to run the python script separately\nyou need to 1) activate Galaxy's virtual environment and 2) change into Galaxy's root\ndirectory. Alternatively to 2) one can specify the galaxy configuration (galaxy.[yml|ini])\nextra parameter.\u003C\u002Fp\u003E\n\u003Ch3 id=\"deleting-userless-histories\"\u003E\u003Ca href=\"#deleting-userless-histories\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EDeleting Userless Histories\u003C\u002Fh3\u003E\n\u003Cp\u003EAs mentioned above, logging in is not required for using Galaxy, and in many\ncases users perform an analysis without logging in to review results in a\n\"1-off\" fashion, not caring about keeping the analysis for later review. In\nthis case, history record(s) are created with no associated user ID. The\ncleanup_dataset.py script can be used to delete these types of histories that\nhave not been altered for a specified period of time. The command for deleting\nuserless histories is something like:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Epython cleanup_datasets.py -d 60 -1\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENotice that the first parameter passed into the script is the Galaxy\nconfiguration file. This is necessary for the script to acquire information\nabout the database connection and the location of data files on disk. The value\nfollowing the -d flag is the span of time in days that has passed since a\nhistory was last updated ( i.e., the value in the \u003Ccode\u003EHistory.update_time\u003C\u002Fcode\u003E column is\nolder than 60 days in this example ). Based on this criteria, all \u003Ccode\u003EHistory\u003C\u002Fcode\u003E\nrecords that do not include a value in the \u003Ccode\u003Euser_id\u003C\u002Fcode\u003E column and whose \u003Ccode\u003Eupdate_time\u003C\u002Fcode\u003E\ncolumn value is older than 60 days will be retrieved. The -1 flag tells the\n\u003Ccode\u003Ecleanup_datasets.py\u003C\u002Fcode\u003E script to execute the method named\n\u003Ccode\u003Edelete_userless_histories()\u003C\u002Fcode\u003E, which is included in the script. This method\ndeletes userless histories whose \u003Ccode\u003Eupdate_time\u003C\u002Fcode\u003E value is older than the specified\nnumber of days by setting the value of the \u003Ccode\u003EHistory.delete\u003C\u002Fcode\u003E column to \u003Ccode\u003ETrue\u003C\u002Fcode\u003E.\nExecuting the same command, but providing the -i flag will not write any\nchanges; info about the histories to be deleted will be provided.\u003C\u002Fp\u003E\n\u003Ch3 id=\"purging-deleted-histories\"\u003E\u003Ca href=\"#purging-deleted-histories\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPurging Deleted Histories\u003C\u002Fh3\u003E\n\u003Cp\u003EIn the lifecycle of a \u003Ccode\u003EHistory\u003C\u002Fcode\u003E record, the stage following the \"deleted\" stage\nis the \"purged\" stage, the last stage in the \u003Ccode\u003EHistory\u003C\u002Fcode\u003E record's lifecycle. When a\n\u003Ccode\u003EHistory\u003C\u002Fcode\u003E record is purged, all \u003Ccode\u003EHistoryDatasetAssociation\u003C\u002Fcode\u003E records associated with\nthe History record are purged. When a \u003Ccode\u003EHistoryDatasetAssociation\u003C\u002Fcode\u003E is purged, it\nis marked as deleted. Addionally the Dataset associated with the HDA is marked\nas deleted only if all associations to that \u003Ccode\u003EDataset\u003C\u002Fcode\u003E are also purged (HDA &#x26; LDDA\nare all marked as deleted); when this happens, HDAs and LDDAs are no longer\nundeletable by the user - if '-r' is used the associated files and metadata\nfiles are removed from disk (the primary Dataset File still remains on disk and\ncan be retrieved by an admin) . The command for purging histories and\nassociated HDAs is something like:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Epython cleanup_datasets.py -d 60 -2 -r\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EIn this example, the -2 flag tells the \u003Ccode\u003Ecleanup_dataset.py\u003C\u002Fcode\u003E script to execute the\n\u003Ccode\u003Epurge_histories()\u003C\u002Fcode\u003E method included in the script. This method retrieves all\n\u003Ccode\u003EHistory\u003C\u002Fcode\u003E records whose \u003Ccode\u003EHistory.deleted\u003C\u002Fcode\u003E column value is True, \u003Ccode\u003EHistory.purged\u003C\u002Fcode\u003E\ncolumn value is \u003Ccode\u003EFalse\u003C\u002Fcode\u003E and whose \u003Ccode\u003EHistory.update_time\u003C\u002Fcode\u003E column value is older than\nthe specified number of days ( 60 in this example ). All\n\u003Ccode\u003EHistoryDatasetAssociation\u003C\u002Fcode\u003E records associated with the History record are also\npurged by setting the \u003Ccode\u003EHistoryDatasetAssociation.deleted\u003C\u002Fcode\u003E column value to \u003Ccode\u003ETrue\u003C\u002Fcode\u003E;\nany additional \u003Ccode\u003EDatasetAssociations\u003C\u002Fcode\u003E (HDA\u002FLDDA) are polled and if they all have\n\u003Ccode\u003EHistoryDatasetAssociation.deleted==True\u003C\u002Fcode\u003E, the \u003Ccode\u003EDataset.deleted\u003C\u002Fcode\u003E column is set to\n\u003Ccode\u003ETrue\u003C\u002Fcode\u003E. The -r flag in this example tells the \u003Ccode\u003Ecleanup_dataset.py\u003C\u002Fcode\u003E script to remove\nthe files (metadata etc) associated with the \u003Ccode\u003EHistoryDatasetAssociation\u003C\u002Fcode\u003E record\nfrom disk (only if \u003Ccode\u003EDataset.deleted\u003C\u002Fcode\u003E is to be set to True). Executing the same\ncommand but replacing the -r flag with -i will print out all of the \u003Ccode\u003EHistory\u003C\u002Fcode\u003E and\nassociated \u003Ccode\u003EHistoryDatasetAssociation\u003C\u002Fcode\u003E records that will be purged if the -r flag\nis used.\u003C\u002Fp\u003E\n\u003Ch3 id=\"purging-deleted-datasets\"\u003E\u003Ca href=\"#purging-deleted-datasets\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPurging Deleted Datasets\u003C\u002Fh3\u003E\n\u003Cp\u003EDataset records are moved to the \"deleted\" stage when all \u003Ccode\u003EHistory\u003C\u002Fcode\u003E and \u003Ccode\u003ELibrary\u003C\u002Fcode\u003E\nrecords associated with the dataset are deleted as described above.\u003C\u002Fp\u003E\n\u003Cp\u003EThe next stage in the lifecycle of a deleted Dataset record is the \"purged\"\nstage, the last stage in the \u003Ccode\u003EDataset\u003C\u002Fcode\u003E record's lifecycle. The command for\npurging datasets is something like:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Epython cleanup_datasets.py -d 60 -3 -r\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EIn this example, the -3 flag tells the \u003Ccode\u003Ecleanup_dataset.py\u003C\u002Fcode\u003E script to execute the\n\u003Ccode\u003Epurge_datasets()\u003C\u002Fcode\u003E method included in the script. This method retrieves all\n\u003Ccode\u003EDataset\u003C\u002Fcode\u003E records whose \u003Ccode\u003EDataset.deleted\u003C\u002Fcode\u003E column value is True, \u003Ccode\u003EDataset.purged\u003C\u002Fcode\u003E is\n\u003Ccode\u003EFalse\u003C\u002Fcode\u003E and whose \u003Ccode\u003EDataset.update_time\u003C\u002Fcode\u003E column value is older than the specified\nnumber of days ( 60 in this example ). The Dataset records are purged by\nsetting the \u003Ccode\u003EDataset.purged\u003C\u002Fcode\u003E column to True. As described above, the -r flag in\nthis example tells the \u003Ccode\u003Ecleanup_dataset.py\u003C\u002Fcode\u003E script to remove the data file\nassociated with the Dataset record from disk. Executing the same command but\nreplacing the -r flag with -i will print out all of the Dataset records that\nwill be purged if the -r flag is used.\u003C\u002Fp\u003E\n\u003Ch3 id=\"purging-library-folders\"\u003E\u003Ca href=\"#purging-library-folders\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPurging Library Folders\u003C\u002Fh3\u003E\n\u003Cp\u003EBesides existing in user's history, dataset association objects exist with in\n\u003Ccode\u003ELibrary\u003C\u002Fcode\u003E Folders; they are known as \u003Ccode\u003ELibraryDatasetDatasetAssociations\u003C\u002Fcode\u003E (LDDAs).\nPurging a library folder is similar to purging a History. An example command\nis:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Epython cleanup_datasets.py -d 60 -5 -r\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EIn this example, the -5 flag tells the \u003Ccode\u003Ecleanup_dataset.py\u003C\u002Fcode\u003E script to execute the\n\u003Ccode\u003Epurge_folders()\u003C\u002Fcode\u003E method included in the script. This method retrieves all\n\u003Ccode\u003ELibraryFolder\u003C\u002Fcode\u003E records whose \u003Ccode\u003ELibraryFolder.deleted\u003C\u002Fcode\u003E column value is \u003Ccode\u003ETrue\u003C\u002Fcode\u003E,\n\u003Ccode\u003ELibraryFolder.purged\u003C\u002Fcode\u003E column value is \u003Ccode\u003EFalse\u003C\u002Fcode\u003E and whose \u003Ccode\u003ELibraryFolder.update_time\u003C\u002Fcode\u003E\ncolumn value is older than the specified number of days ( 60 in this example ).\nIt works recursively on all subfolders and their contents. All\n\u003Ccode\u003ELibraryDatasetDatasetAssociations\u003C\u002Fcode\u003E records associated with the \u003Ccode\u003ELibraryFolder\u003C\u002Fcode\u003E\nrecord are also purged by setting the \u003Ccode\u003ELibraryDatasetDatasetAssociation.deleted\u003C\u002Fcode\u003E\ncolumn value to \u003Ccode\u003ETrue\u003C\u002Fcode\u003E; any additional \u003Ccode\u003EDatasetAssociations\u003C\u002Fcode\u003E (HDA\u002FLDDA) are polled\nand if they all have\n\u003Ccode\u003EHistoryDatasetAssociation(LibraryDatasetDatasetAssociation).deleted==True\u003C\u002Fcode\u003E, the\n\u003Ccode\u003EDataset.deleted\u003C\u002Fcode\u003E column is set to \u003Ccode\u003ETrue\u003C\u002Fcode\u003E. The -r flag in this example tells the\n\u003Ccode\u003Ecleanup_dataset.py\u003C\u002Fcode\u003E script to remove the files (metadata etc) associated with\nthe \u003Ccode\u003ELibraryDatasetDatasetAssociation\u003C\u002Fcode\u003E record (but not the actual Dataset file)\nfrom disk (only if \u003Ccode\u003EDataset.deleted\u003C\u002Fcode\u003E is to be set to \u003Ccode\u003ETrue\u003C\u002Fcode\u003E). Executing the same\ncommand but replacing the -r flag with -i will print out all of the\n\u003Ccode\u003ELibraryFolders\u003C\u002Fcode\u003E and associated \u003Ccode\u003ELibraryDatasetDatasetAssociation\u003C\u002Fcode\u003E records that\nwill be purged if the -r flag is used.\u003C\u002Fp\u003E\n\u003Cp\u003EAs is the case with \u003Ccode\u003EHistories\u003C\u002Fcode\u003E, the \u003Ccode\u003Epurge_datasets\u003C\u002Fcode\u003E script will need to be used\nto remove actual Datasets from disk.\u003C\u002Fp\u003E\n\u003Ch3 id=\"purging-libraries\"\u003E\u003Ca href=\"#purging-libraries\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPurging Libraries\u003C\u002Fh3\u003E\n\u003Cp\u003EPurging a library is similar to purging a \u003Ccode\u003ELibraryFolder\u003C\u002Fcode\u003E. All libraries which\nare not purged, but are deleted and exceed the modified date are retrieved. The\nlibrary is marked as purged and \u003Ccode\u003Epurge_folder\u003C\u002Fcode\u003E is called on the library's root\nfolder, deleting all contents. An example command is:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Epython cleanup_datasets.py -d 60 -4 -r\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EIn this example, the -4 flag tells the \u003Ccode\u003Ecleanup_dataset.py\u003C\u002Fcode\u003E script to execute the\n\u003Ccode\u003Epurge_libraries()\u003C\u002Fcode\u003E method included in the script. This method retrieves all\n\u003Ccode\u003ELibrary\u003C\u002Fcode\u003E records whose \u003Ccode\u003ELibrary.deleted\u003C\u002Fcode\u003E column value is True, \u003Ccode\u003ELibrary.purged\u003C\u002Fcode\u003E\ncolumn value is False and whose \u003Ccode\u003ELibraryFolder.update_time\u003C\u002Fcode\u003E column value is older\nthan the specified number of days ( 60 in this example ). The Library's Root\nFolder is then obtained and all \u003Ccode\u003ELibraryDatasetDatasetAssociations\u003C\u002Fcode\u003E records\nassociated with the \u003Ccode\u003ELibraryFolder\u003C\u002Fcode\u003E record are also purged by setting the\n\u003Ccode\u003ELibraryDatasetDatasetAssociation.deleted\u003C\u002Fcode\u003E column value to \u003Ccode\u003ETrue\u003C\u002Fcode\u003E; any additional\n\u003Ccode\u003EDatasetAssociations\u003C\u002Fcode\u003E (HDA\u002FLDDA) are polled and if they all have\n\u003Ccode\u003EHistoryDatasetAssociation(LibraryDatasetDatasetAssociation).deleted==True\u003C\u002Fcode\u003E, the\n\u003Ccode\u003EDataset.deleted\u003C\u002Fcode\u003E column is set to \u003Ccode\u003ETrue\u003C\u002Fcode\u003E. The -r flag in this example tells the\n\u003Ccode\u003Ecleanup_dataset.py\u003C\u002Fcode\u003E script to remove the files (metadata etc) associated with\nthe \u003Ccode\u003ELibraryDatasetDatasetAssociation\u003C\u002Fcode\u003E record (but not the actual Dataset file)\nfrom disk (only if Dataset.deleted is to be set to True). Executing the same\ncommand but replacing the -r flag with -i will print out all of the \u003Ccode\u003ELibraries\u003C\u002Fcode\u003E,\n\u003Ccode\u003ELibraryFolders\u003C\u002Fcode\u003E and associated \u003Ccode\u003ELibraryDatasetDatasetAssociation\u003C\u002Fcode\u003E records that\nwill be purged if the -r flag is used.\u003C\u002Fp\u003E\n\u003Ch3 id=\"deleting-datasets--purging-dataset-instances\"\u003E\u003Ca href=\"#deleting-datasets--purging-dataset-instances\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EDeleting Datasets \u002F Purging Dataset Instances\u003C\u002Fh3\u003E\n\u003Cp\u003EThere are times when it is not desirable to wait for the containing \u003Ccode\u003Ehistory\u003C\u002Fcode\u003E or\n\u003Ccode\u003Elibrary\u002Flibrary\u003C\u002Fcode\u003E folder to be deleted before purging a dataset instance and\nmarking the base dataset as deleted. The -6 flag is used for this purpose. This\nscript will find all Dataset records which are not deleted but are associated\nwith a \u003Ccode\u003EDatasetAssociation\u003C\u002Fcode\u003E that is marked as deleted and updated according to\nthe specified cut-off. If all associations are marked as deleted, the \u003Ccode\u003EDataset\u003C\u002Fcode\u003E\nis marked as deleted and each \u003Ccode\u003EDatasetAssociation\u003C\u002Fcode\u003E is purged. The\n\u003Ccode\u003Epurge_datasets.sh\u003C\u002Fcode\u003E script will need to be run afterwards to remove the base\ndatasets from disk.\u003C\u002Fp\u003E\n\u003Cp\u003EAn example command is: \u003Ccode\u003Epython cleanup_datasets.py -d 60 -6 -r\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.fcdfbc15.js" defer></script><script src="/assets/js/page--src--templates--article-vue.d39bea03.js" defer></script>
  </body>
</html>
