<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Moving from MySQL to PostgreSQL - Galaxy Community Hub</title><meta name="gridsome:hash" content="8532f9dede357a757ee182f7a5f5306dccf4d8d2"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="All about Galaxy and its community."><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/assets/css/0.styles.28333459.css" as="style"><link rel="preload" href="/assets/js/app.530b5429.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--article-vue.64c93840.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.341dc732.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-vue.3c7f5b55.js"><link rel="prefetch" href="/assets/js/page--src--pages--careers-vue.e184f86f.js"><link rel="prefetch" href="/assets/js/page--src--pages--data-explorer-vue.b90f89a0.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--archive-vue.05cefd50.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--cofests--papercuts-vue.0600a516.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--cofests-vue.02e45c87.js"><link rel="prefetch" href="/assets/js/page--src--pages--events--webinars-vue.9e952f0b.js"><link rel="prefetch" href="/assets/js/page--src--pages--events-vue.94ed156e.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.7c012d06.js"><link rel="prefetch" href="/assets/js/page--src--pages--news-vue.cc08cea5.js"><link rel="prefetch" href="/assets/js/page--src--pages--tests-vue.5787dadc.js"><link rel="prefetch" href="/assets/js/page--src--pages--use-vue.a388deea.js"><link rel="prefetch" href="/assets/js/page--src--templates--platform-vue.e9b8d907.js"><link rel="prefetch" href="/assets/js/page--src--templates--vue-article-vue.e6c4b1b6.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--careers-vue~page--src--pages--use-vue~page--src--templates--article-vue~pa~efade918.6ddcbcd7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--index-md.5ec0353f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--md--imgtests--imgdir--index-md.d2f02fb2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--partials--index-md.6eacd568.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--imgtests--imgdir--index-md.243e6e14.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--imgtests--index-md.fe1547f4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--index-md.3045ca17.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--syntaxtests--index-md.2bb12ee9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--0-tests--vue-remark--syntaxtests--reldir--index-md.04a5971c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--capacity-planning--index-md.cdb31b64.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--config--index-md.d8cc6a8e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--config--performance--cluster--legacy--index-md.6126c0ab.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--datatypes--index-md.2c6ad340.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--disk-quotas--index-md.2a5f1d18.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--faq--index-md.626aa5e2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--internals--data-model--index-md.683d706e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--internals--galaxy-ops--index-md.a548f318.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--ten-simple-steps-galaxy-as-a-service--index-md.fb47e620.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--tools--tool-config-syntax--index-md.fe92a056.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--admin--tools--writing-tests--index-md.cbd1fa26.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--allocation--index-md.1fd5823b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--faq--index-md.f8952512.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--index-md.ca6d4be5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--ssh--index-md.d1e636a3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloud--jetstream--troubleshooting--index-md.4457a67d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--capacity-planning--index-md.50609795.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--getting-started--index-md.d120cd39.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--aws--index-md.82538de5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--building--index-md.15cd9886.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--capacity-planning--index-md.e7f5d2ef.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--cluster-types--index-md.7ce772ee.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--customizing--index-md.dd5a0f44.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--faq--index-md.3e8f2cfd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--getting-started--index-md.6e47c878.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--getting-started--pre-201703--index-md.8adcb5fb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--hadoop--index-md.7096a9db.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--ht-condor--index-md.7108cb00.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--index-md.21bb7ccf.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--openstack--index-md.04e4b1b9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--services--index-md.67736e57.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--sharing--index-md.de7a95e6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--troubleshooting--index-md.c2522b7f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--cloudman--userdata--index-md.ea7b48c7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--future--index-md.5fef13a8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--index-md.b413786b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-07-09--index-md.c7ba5f32.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-07-27--index-md.2d274f1f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-09-19--index-md.350ff857.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2012-11-14--index-md.6394e8eb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-01-16--index-md.b80ca50e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-03-20--index-md.d7d45582.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-05-15--index-md.16bd81d2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2013-11-20--index-md.6eb15e45.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-02-19--index-md.99b4227a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-04-16--index-md.a0d12d71.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-06-18--index-md.b28736a4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-08-20--index-md.182ee6b3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2015-10-15--index-md.f802517c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-02-18--index-md.ce963501.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-04-21--index-md.201653e8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-06-16--index-md.1a5b03ab.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--2016-08-18--index-md.5fe1ce8f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--index-md.66a5707a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--meetups--webinar-tech--index-md.e3f992d8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--2012--index-md.f4399ee3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--2014--index-md.e61247f7.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--community--galaxy-admins--surveys--index-md.54af8093.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--data--index-md.6b6498fc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--datafiles--index-md.e8dfc4df.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--architecture--index-md.34ae6963.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--bitbucket--index-md.acbc3fe6.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--css--index-md.4ce0dd2e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--getting-started--index-md.cb2faa73.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--index-md.f1176fb8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--jsa--index-md.0246019b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--mercurial--index-md.5853bf74.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--develop--security-tool-tips--index-md.e7857ad9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--galaxy-project--index-md.5145db7c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--index-md.7fdb4fe8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--papers--index-md.480933dc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--posters--index-md.7efa31c4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--presentations--index-md.ea01f890.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--documents--videos--index-md.940ff7fb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--advanced-session--index-md.a8e5e25d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--basics-session--index-md.d645307e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--index-md.f11a50aa.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--logistics--index-md.38d02020.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--publicity--index-md.b4d6e10c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--admin-training-2016--registration--index-md.c3f3ac52.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--abstracts--index-md.c74d0a19.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--index-md.86cf9585.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--key-dates--index-md.3b2e18af.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--lightning-talks--index-md.788d369b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--logistics--index-md.b011146b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--organizing-committee--index-md.dc0ed2c3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--photos--index-md.99eb179f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--automation-strategies--index-md.82ec586c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--bioinformatics-training--index-md.4ec4625d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--end-users--index-md.5ef081bd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--breakouts--workflows-and-api--index-md.f8881e3c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--program--index-md.a493c130.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--promotion--index-md.d4d4ab5a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--register--index-md.2ac2ef78.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--sponsorships--index-md.3725601e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2012--training-day--index-md.5bc4fbd2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--index-md.7d9f31fd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--posters--index-md.c83d0fc2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--abstracts--talks--index-md.7419a020.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--clinical-use-hpc-file-systems--index-md.96a9cc95.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-admins--index-md.62f148c3.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-blast--index-md.26b31115.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--galaxy-professionals--index-md.4bac0865.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--index-md.0ca95bbd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--proteomics--index-md.cbfa021d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--public-galaxy-servers--index-md.30be7d81.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--bof--tool-developers--index-md.638b043d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--index-md.e1732e15.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--key-dates--index-md.37ce290b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--lightning--index-md.1290abbb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--logistics--index-md.7f8f8662.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--organizers--index-md.3ded5344.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--photos--index-md.1c519e12.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--program--index-md.4d6fd51c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--promotion--index-md.d6111465.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--register--index-md.0c5ab96d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--sponsorships--index-md.40315659.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--advance-tool-data--index-md.6c6b6753.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--api--index-md.d70dfe01.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--index-md.531bce20.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--intro-tool-data--index-md.6bc1511d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2013--training-day--vms--index-md.41d0e011.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--index-md.5bf0e1e9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--posters--index-md.817ac66c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--abstracts--talks--index-md.8de32396.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--branch-release-merge--index-md.b4db16c4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-admins--index-md.a7f6f9d5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-end-users--index-md.aa824a81.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--galaxy-training-network--index-md.dbb83d8f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--heterogeneous--index-md.351c263d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--index-md.eb962685.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--bofs--using-galaxy-ui-overview--index-md.f7cfbebc.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--hackathon--index-md.1749d697.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--index-md.a1273aed.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--key-dates--index-md.9ebbc47e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--lightning--index-md.607dc43c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--logistics--index-md.519c9823.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--organizers--index-md.1992a406.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--photos--index-md.c2d68a34.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--program--index-md.211f5a01.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--promotion--index-md.07284187.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--register--index-md.07256043.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--sponsor-exhibit--index-md.7a984f7d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--admin-walkthrough--index-md.f40ad37f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--api--index-md.77114e5a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--data-managers--index-md.2b2c2b01.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--index-md.a06e59d2.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2014--training-day--vms--index-md.d0d28b90.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--cwl--index-md.631fb60b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--data-management-challenges--index-md.11698204.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--data-splitting-and-parallelism--index-md.330b69a1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--elixir--index-md.3b17ea97.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--extended-workflow--index-md.5185e809.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--fots--index-md.657d2830.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-admins--index-md.156e6d7a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-community-uk--index-md.cb1a5b0b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-scientists--index-md.627e7e4e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--galaxy-training-network--index-md.362bd65b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--bofs--index-md.c47cd133.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--data-hack-roundup--index-md.96badb02.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--header--index-md.e3a3699a.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2015--index-md.00c127cf.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2016--bofs--index-md.1b227da5.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--abstracts--index-md.5f5b69cd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--childcare--index-md.ea57d522.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--cofest--index-md.ac4b42fe.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--conduct--index-md.6439a678.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--faq--index-md.dd02110f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--index-md.9076238b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--organizers--index-md.604cd93c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--promotion--index-md.7feac320.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--registration--index-md.99c31714.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--sponsors--index-md.580a89e4.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--training--index-md.86bca2df.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gcc-2019--venue--index-md.337669f0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--abstracts--index-md.69816827.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--childcare--index-md.194576cd.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--code-of-conduct--index-md.dab8fe95.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--collaboration--index-md.86c71a83.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--faq--index-md.cedc19af.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--icebreaker--index-md.e9312bf1.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--index-md.4a6e8f69.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--keynotes--index-md.f19cf0ee.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--organizers--index-md.97e01527.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--promotion--index-md.e5dfd55b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--register--index-md.8f2785db.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--sponsors--index-md.cb9fd45f.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--training--index-md.1c117aaf.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--gccbosc-2018--venue--index-md.c3df8442.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--germany-2014--index-md.722263d9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--germany-2016--index-md.074ec0fe.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--sg-2014--index-md.e3e62623.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--sg-2016--index-md.40a7a70d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2014--index-md.d01dc5f8.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2014--trainingday--index-md.afc35ebb.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--events--switzerland-2016--index-md.c36c139c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--example--vue-remark--index-md.6732fc69.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--faqs--index-md.1ce8379e.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--galaxy-updates--2013-06--index-md.91d48b99.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--galaxy-updates--2013-07--index-md.a146434d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--icons--index-md.fceade28.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--index-md.8279b358.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--logos--index-md.c48abc0c.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--news-graphics--index-md.09282535.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--photos--index-md.88bb5e3d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--images--screenshots--index-md.d0a416e0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--basic-editing--index-md.f8ec64be.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--basic-editing--workflow-editor-unannotated--index-md.0286fb80.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--extract--index-md.b76b278d.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--tool-panel--index-md.8ca7c503.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--advanced-workflow--variables--index-md.d8042c35.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--faq--index-md.2bc33193.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--galaxy-pages--index-md.4aad8e3b.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--learn--interval-operations--index-md.7c36dec9.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--main--faq--index-md.b8187df0.js"><link rel="prefetch" href="/assets/js/vue-remark--build--content-vue--tools--requirements--index-md.5645d864.js"><link rel="stylesheet" href="/assets/css/0.styles.28333459.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout" data-v-3a128d75><header id="masthead"><nav class="container navbar navbar-expand-lg navbar-dark justify-content-center"><a href="/" class="navbar-brand active"><img id="masthead-logo" src="/images/galaxy_logo_hub_white.svg" alt="Galaxy Community Hub" height="30"></a><div id="navbarToggleWrapper" class="collapse navbar-collapse mx-auto"><ul class="navbar-nav"><li class="nav-item"><a href="/use/" role="button" aria-expanded="false" class="nav-link dropdown">
          Use
        </a></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" aria-expanded="false" class="nav-link dropdown-toggle">
          Learn
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/learn/" class="dropdown-item">How to use Galaxy</a></li><li><a href="https://training.galaxyproject.org/" class="dropdown-item">Teach with Galaxy</a></li></ul></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" class="nav-link dropdown-toggle">
          Community
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/community/" class="dropdown-item">About</a></li><li><a href="/events/" class="dropdown-item">Events</a></li><li><a href="/news/" class="dropdown-item">News</a></li><li><a href="/blog/" class="dropdown-item active">Blog</a></li><li><a href="/publication-library/" class="dropdown-item">Publications</a></li><li><a href="/galaxy-project/statistics/" class="dropdown-item">Stats</a></li><li><a href="/careers/" class="dropdown-item">Careers</a></li></ul></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" class="nav-link dropdown-toggle">
          Deploy &amp; Develop
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/admin/get-galaxy/" class="dropdown-item">Install Galaxy</a></li><li><a href="/admin/" class="dropdown-item">Server administration</a></li><li><a href="/tools/" class="dropdown-item">Tools</a></li><li><a href="/develop/api/" class="dropdown-item">Working with the API</a></li><li><a href="/develop/" class="dropdown-item">Contributing</a></li><li><a href="/docs/" class="dropdown-item">Code documentation</a></li></ul></li><li class="nav-item dropdown"><a href="#" data-toggle="dropdown" role="button" class="nav-link dropdown-toggle">
          Support
          <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="/support/" class="dropdown-item">FAQ</a></li><li><a href="https://help.galaxyproject.org/" class="dropdown-item">Galaxy Help Forum</a></li></ul></li><li class="nav-item"><a href="/jxtx/" role="button" aria-expanded="false" class="nav-link dropdown">
          @jxtx
        </a></li></ul></div></nav></header><section id="maincontainer" class="container"><a href="/blog/" class="link active" data-v-3a128d75>
    ← blog
  </a><header data-v-3a128d75><!----><h1 class="title" data-v-3a128d75>Moving from MySQL to PostgreSQL</h1><div class="metadata" data-v-3a128d75><p class="subtitle" data-v-3a128d75>It is pretty simple, though you might hit some obstacles depending on how old your MySQL server is and how much you have manually interfered with the database.</p><!----><p class="date" data-v-3a128d75>30 July 2015</p></div></header><div class="content markdown" data-v-3a128d75><p>After running our Galaxy servers successfully with MySQL as the backend database server for several years, we decided to switch to the recommended PostgreSQL server.</p>
<h2 id="summary"><a href="#summary" aria-hidden="true"><span class="icon icon-link"></span></a>Summary</h2>
<p>I used the tool <a href="https://pypi.python.org/pypi/py-mysql2pgsql" target="_blank" rel="noopener noreferrer">py-mysql2pgsql</a> to generate table dumps from our MySQL database. I then imported table by table into an empty by Galaxy created PostgreSQL database. After setting the "sequences", the database was ready to go.</p>
<h2 id="learning-postgresql"><a href="#learning-postgresql" aria-hidden="true"><span class="icon icon-link"></span></a>Learning PostgreSQL</h2>
<p>Our institute used mostly MySQL. At the start, I also had hardly any experience with PostgreSQL, and I gradually had to learn everything. On top of using google searches, this book helped me a lot: <a href="http://shop.oreilly.com/product/0636920025061.do" target="_blank" rel="noopener noreferrer">PostgreSQL: Up and Running</a> by Regina Obe and Leo Hsu. I installed a few test galaxy servers from scratch using PostgreSQL as their backend database trying to learn the basics of PostgreSQL and the 'quirks' of the Galaxy database schema. I wished, I had knew about the nice <a href="https://galaxyproject.org/schema/SchemaSpy/index.html" target="_blank" rel="noopener noreferrer">page generated with SchemaSpy</a> presented by <a href="https://wiki.galaxyproject.org/DaveClements" target="_blank" rel="noopener noreferrer">Dave Clements</a> at <a href="http://gcc2015.tsl.ac.uk/training-day/#The_Galaxy_Database_Schema" target="_blank" rel="noopener noreferrer">GCC 2015</a>, when I started my journey.</p>
<p>I quickly realized a simple dump table from MySQL and load them into PostgreSQL will not work. The database schema could not be converted one to one from MySQL to PostgreSQL and the contents of the table could not be dumped and loaded one to one from MySQL to PostgreSQL (a simple example: MySQl stores boolean as '0' or '1', PostgreSQL as 'f' or 't') .</p>
<h2 id="preparations-for-the-move"><a href="#preparations-for-the-move" aria-hidden="true"><span class="icon icon-link"></span></a>Preparations for the Move</h2>
<p>To make sure, the new PostgreSQL database had the correct schema, I set up a new Galaxy server from scratch, using the same release as our production server was running at the time (<a href="http://galaxy.readthedocs.org/en/master/releases/15.03_announce.html" target="_blank" rel="noopener noreferrer">15.03</a>), and pointing to a new, empty PostgreSQL database. By starting the new Galaxy server, the 128 migration steps were executed, and the PostgreSQL database was populated with 156 empty (see also below) tables.</p>
<p>I used the tool <a href="https://pypi.python.org/pypi/py-mysql2pgsql" target="_blank" rel="noopener noreferrer">py-mysql2pgsql</a> to generate table dumps from our MySQL database. By default, <a href="https://pypi.python.org/pypi/py-mysql2pgsql" target="_blank" rel="noopener noreferrer">py-mysql2pgsql</a> imports the data into a  PostgreSQL database, but if you provide a file name (e.g. "mysql2pgsql.txt") in the required "mysql2pgsql.yml" file, the output goes to the "mysql2pgsql.txt" file. This file contains all the commands to create a PostgreSQL database, based on the information from the MySQL database. Since I was only interested in the loading data (or rather "COPY") parts, I used a simple perl script to parse "mysql2pgsql.txt" to get the "COPY" statements for all table which had data in.</p>
<pre><code>#!/usr/bin/perl

use warnings;
use strict;

my $file = "mysql2pgsql.txt";

open(DUMP, $file); 

my $control = 0;
my $newfile; 
while ( &#x3C;DUMP> ) {

    if ($_ =~ /^COPY \"(.*)\" \(/) {
        $newfile = "mysql2pgsql.".$1.".txt";
        print $newfile."\n";
        open(OUT,">$newfile");
        print OUT $_;
    }   
    if ($_ =~ /&#x3C;sup>[0-9]/ || $_ =~ /&#x3C;/sup>Galaxy/) {
        print OUT $_;
        $control++;

    }   
    if ($_ =~ /^\\\./) {
        print OUT $_;   
        close OUT;
        if ($control == 0) {
            system("rm -f $newfile");
        }
        $control =0;
    }
}
close DUMP;
</code></pre>
<p>This script generated 81 copy statements for the database used for our production server.</p>
<h2 id="loading-the-data"><a href="#loading-the-data" aria-hidden="true"><span class="icon icon-link"></span></a>Loading the Data</h2>
<p>As a PostgreSQL novice coming from the simple world of MySQL MyISAM tables, I had to learn how to deal with foreign keys. There were probably better ways to do this, but I decided to figure out the insertion order myself. Nowadays, I would check this <a href="https://galaxyproject.org/schema/SchemaSpy/insertionOrder.txt" target="_blank" rel="noopener noreferrer">page for the insertion order</a> or deactivate the keys table by table (see <a href="http://www.postgresql.org/message-id/4EA2057F.3000002@ringerc.id.au" target="_blank" rel="noopener noreferrer">this question/answer</a>) or "DROP" all keys first and "ADD" the constraints back after loading all the data.</p>
<p>I could "COPY" the data for all tables without any problems. But before the database was ready to go, I had to set the "sequences" (see <a href="http://stackoverflow.com/questions/9108833/postgres-autoincrement-not-updated-on-explicit-id-inserts" target="_blank" rel="noopener noreferrer">here for an explanation</a>). At this point, I didn't know, which tables had such an autoincrement feature. In order to figure out, I created a complete database dump from the PostgreSQL database with <a href="http://www.postgresql.org/docs/9.4/static/app-pgdump.html" target="_blank" rel="noopener noreferrer">pg_dump</a> using the options "-f postgresql.dump" (send output to this file) and "-F p" (plain text). In the file "postgresql.dump", I searched for the "SEQUENCE" command and created for each a "SELECT setval" statement with the following perl script:</p>
<pre><code>#!/usr/bin/perl

use warnings;
use strict;

my $file = "postgresql.dump";

open(DUMP, $file); 

my $control = 0;
my $newfile = "fix_sequence.txt";

open(FIX, ">$newfile"); 

while ( &#x3C;DUMP>) {

    if ($_ =~ /^CREATE SEQUENCE ((.*)_id_seq)/) {
        my $sequence = $1;
        my $table = $2;
        print FIX "SELECT setval('".$sequence."', (SELECT MAX(id) from \"".$table."\"));";
        print FIX "\n\n";
    }
}

close DUMP;
close FIX;
</code></pre>
<p>I only used the "SELECT setval" commands for tables I loaded with data before.</p>
<h2 id="problems-i-was-running-into"><a href="#problems-i-was-running-into" aria-hidden="true"><span class="icon icon-link"></span></a>Problems I was running into</h2>
<h5 id="circular-foreign-keys"><a href="#circular-foreign-keys" aria-hidden="true"><span class="icon icon-link"></span></a>circular foreign keys</h5>
<p>I run into three circular foreign key constraints in the (empty) PostgreSQL database:</p>
<ul>
<li>workflow &#x3C;-> stored_worflow (see: <a href="https://galaxyproject.org/schema/SchemaSpy/tables/workflow.html" target="_blank" rel="noopener noreferrer">workflow</a>)</li>
<li>library_dataset &#x3C;-> library_dataset_dataset_association &#x3C;-> history_dataset_association_dataset (see: <a href="https://galaxyproject.org/schema/SchemaSpy/tables/library_dataset_dataset_association.html" target="_blank" rel="noopener noreferrer">library_dataset_dataset_association.html</a></li>
<li>form_definition &#x3C;-> form_definition_current (see: <a href="https://galaxyproject.org/schema/SchemaSpy/tables/form_definition.html" target="_blank" rel="noopener noreferrer">form_definition</a>)</li>
</ul>
<p>I solved it by dropping the constraint, uploading the data, and recreating the foreign key, eg:</p>
<pre><code>ALTER TABLE workflow DROP CONSTRAINT workflow_stored_workflow_id_fkey;

# 'COPY' workflow table
# 'COPY' stored_workflow table

ALTER TABLE ONLY workflow ADD CONSTRAINT workflow_stored_workflow_id_fkey FOREIGN KEY (stored_workflow_id) REFERENCES stored_workflow(id);
</code></pre>
<pre><code>ALTER TABLE library_dataset DROP CONSTRAINT library_dataset_dataset_association_id_fk;

# 'COPY' library_dataset table

ALTER TABLE library_dataset_dataset_association DROP CONSTRAINT history_dataset_association_dataset_id_fkey;

# 'COPY' library_dataset_dataset_association table
# 'COPY' history_dataset_association table

ALTER TABLE ONLY library_dataset ADD CONSTRAINT library_dataset_dataset_association_id_fk FOREIGN KEY (library_dataset_dataset_association_id) REFERENCES library_dataset_dataset_association(id);

ALTER TABLE ONLY library_dataset_dataset_association ADD CONSTRAINT history_dataset_association_dataset_id_fkey FOREIGN KEY (copied_from_history_dataset_association_id) REFERENCES history_dataset_association(id);
</code></pre>
<pre><code>ALTER TABLE form_definition DROP CONSTRAINT form_definition_form_definition_current_id_fkey;

# 'COPY' form_definition table
# 'COPY' form_definition_current table

ALTER TABLE ONLY form_definition ADD CONSTRAINT form_definition_form_definition_current_id_fkey FOREIGN KEY (form_definition_current_id) REFERENCES form_definition_current(id);
</code></pre>
<h5 id="tables-already-filled-by-galaxy"><a href="#tables-already-filled-by-galaxy" aria-hidden="true"><span class="icon icon-link"></span></a>tables already filled by galaxy</h5>
<p>Obviously, as part of the database generation the table "migrate_version" had already been filled in my case:</p>
<pre><code>=#select * from migrate_version;
 repository_id |     repository_path      | version 
---------------+--------------------------+---------
 Galaxy        | lib/galaxy/model/migrate |     128
(1 row)
</code></pre>
<p>The "kombu_queue" table was also not empty:</p>
<pre><code>=# select * from kombu_queue;
 id |     name     
----+--------------
  1 | control.main
(1 row)
</code></pre>
<p>In both cases, the contents was equal to the contents from the dump out of the existing MySQL database.</p>
<p>The "migrate_tools" table is also pre-filled:</p>
<pre><code>=# select * from migrate_tools;
 repository_id |           repository_path            | version 
---------------+--------------------------------------+---------
 GalaxyTools   | lib/tool_shed/galaxy_install/migrate |       1
(1 row)
</code></pre>
<p>In the our current MySQl databes, the version was '12'. The version had to be set to '12' in the new PostgrSQL database, otherwise it would cause troubles when re-starting the Galaxy server.</p>
<h5 id="legacy-from-manual-interfering"><a href="#legacy-from-manual-interfering" aria-hidden="true"><span class="icon icon-link"></span></a>legacy from manual interfering</h5>
<p>Our Galaxy instance is pretty old, and hence over the course of the last seven years, I have several times manually fixed some tables in the MySQL database. The biggest intervention, happened, when we switched to external authentication. Several users who used the Galaxy server before and after this switch ended up with two different entries in the galaxy_user table by not using the same e-mail address before, as now returned by the LDAP server (you run into similar issues, when a user asks for a different e-mail address, and the IT folks do not create an alias, but change the entry). Basically, this creates a duplication in the "galaxy_user" table.</p>
<p>At the time, most cases were easy to fix: delete the new user (i.e. the user created with the e-mail address coming from the LDAP server) and change the email address of the existing user, before the <em>new</em> user executes any jobs. However, in one case I must have messed up something and now the foreign key constraints in PostgreSQL were complaining. I had to re-enter a <em>dummy user</em> into the "galaxy_user" and "role" and add several rows into the "history" table before I could upload the data into the new PostgreSQL database.</p>
<h5 id="difference-between-development-and-production-server"><a href="#difference-between-development-and-production-server" aria-hidden="true"><span class="icon icon-link"></span></a>difference between development and production server</h5>
<p>I first tested the transition process with our development server. Although, we are trying to keep the development and production server as similar as possible, some features have never been used in the development or in the production server. This has resulted in tables which were empty in the database for the development and populated in the database for the production server - or vice versa.  So I had to adjust the my insertion order.</p>
<h2 id="final-step"><a href="#final-step" aria-hidden="true"><span class="icon icon-link"></span></a>Final Step</h2>
<p>As the final step, I had to change the database setting in the "galaxy.ini" (well, "universe_wsgi.ini" for our old instance) and "reports_wsgi.ini" files, and restart the server.</p>
<p>I am sure there are better and easier ways to do this, but the process worked for me. Feel free to contact <a href="/people/hansrudolf-hotz/">me</a>, if you have any questions or want to do such a migration for your Galaxy server as well.</p>
</div><footer class="static-footer markdown"><p>The Galaxy Project is supported in part by NSF, NHGRI, The Huck Institutes of the Life Sciences, The Institute for CyberScience at Penn State, and Johns Hopkins University.</p>
</footer></section></div>
    <script>window.__INITIAL_STATE__={"data":{"article":{"id":"5433a790767978e7b8fbf26e770b7e2c","title":"Moving from MySQL to PostgreSQL","tease":"It is pretty simple, though you might hit some obstacles depending on how old your MySQL server is and how much you have manually interfered with the database.","image":"","images":{},"category":"blog","contact":"","date":"30 July 2015","content":"\u003Cp\u003EAfter running our Galaxy servers successfully with MySQL as the backend database server for several years, we decided to switch to the recommended PostgreSQL server.\u003C\u002Fp\u003E\n\u003Ch2 id=\"summary\"\u003E\u003Ca href=\"#summary\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ESummary\u003C\u002Fh2\u003E\n\u003Cp\u003EI used the tool \u003Ca href=\"https:\u002F\u002Fpypi.python.org\u002Fpypi\u002Fpy-mysql2pgsql\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Epy-mysql2pgsql\u003C\u002Fa\u003E to generate table dumps from our MySQL database. I then imported table by table into an empty by Galaxy created PostgreSQL database. After setting the \"sequences\", the database was ready to go.\u003C\u002Fp\u003E\n\u003Ch2 id=\"learning-postgresql\"\u003E\u003Ca href=\"#learning-postgresql\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ELearning PostgreSQL\u003C\u002Fh2\u003E\n\u003Cp\u003EOur institute used mostly MySQL. At the start, I also had hardly any experience with PostgreSQL, and I gradually had to learn everything. On top of using google searches, this book helped me a lot: \u003Ca href=\"http:\u002F\u002Fshop.oreilly.com\u002Fproduct\u002F0636920025061.do\" target=\"_blank\" rel=\"noopener noreferrer\"\u003EPostgreSQL: Up and Running\u003C\u002Fa\u003E by Regina Obe and Leo Hsu. I installed a few test galaxy servers from scratch using PostgreSQL as their backend database trying to learn the basics of PostgreSQL and the 'quirks' of the Galaxy database schema. I wished, I had knew about the nice \u003Ca href=\"https:\u002F\u002Fgalaxyproject.org\u002Fschema\u002FSchemaSpy\u002Findex.html\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Epage generated with SchemaSpy\u003C\u002Fa\u003E presented by \u003Ca href=\"https:\u002F\u002Fwiki.galaxyproject.org\u002FDaveClements\" target=\"_blank\" rel=\"noopener noreferrer\"\u003EDave Clements\u003C\u002Fa\u003E at \u003Ca href=\"http:\u002F\u002Fgcc2015.tsl.ac.uk\u002Ftraining-day\u002F#The_Galaxy_Database_Schema\" target=\"_blank\" rel=\"noopener noreferrer\"\u003EGCC 2015\u003C\u002Fa\u003E, when I started my journey.\u003C\u002Fp\u003E\n\u003Cp\u003EI quickly realized a simple dump table from MySQL and load them into PostgreSQL will not work. The database schema could not be converted one to one from MySQL to PostgreSQL and the contents of the table could not be dumped and loaded one to one from MySQL to PostgreSQL (a simple example: MySQl stores boolean as '0' or '1', PostgreSQL as 'f' or 't') .\u003C\u002Fp\u003E\n\u003Ch2 id=\"preparations-for-the-move\"\u003E\u003Ca href=\"#preparations-for-the-move\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPreparations for the Move\u003C\u002Fh2\u003E\n\u003Cp\u003ETo make sure, the new PostgreSQL database had the correct schema, I set up a new Galaxy server from scratch, using the same release as our production server was running at the time (\u003Ca href=\"http:\u002F\u002Fgalaxy.readthedocs.org\u002Fen\u002Fmaster\u002Freleases\u002F15.03_announce.html\" target=\"_blank\" rel=\"noopener noreferrer\"\u003E15.03\u003C\u002Fa\u003E), and pointing to a new, empty PostgreSQL database. By starting the new Galaxy server, the 128 migration steps were executed, and the PostgreSQL database was populated with 156 empty (see also below) tables.\u003C\u002Fp\u003E\n\u003Cp\u003EI used the tool \u003Ca href=\"https:\u002F\u002Fpypi.python.org\u002Fpypi\u002Fpy-mysql2pgsql\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Epy-mysql2pgsql\u003C\u002Fa\u003E to generate table dumps from our MySQL database. By default, \u003Ca href=\"https:\u002F\u002Fpypi.python.org\u002Fpypi\u002Fpy-mysql2pgsql\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Epy-mysql2pgsql\u003C\u002Fa\u003E imports the data into a  PostgreSQL database, but if you provide a file name (e.g. \"mysql2pgsql.txt\") in the required \"mysql2pgsql.yml\" file, the output goes to the \"mysql2pgsql.txt\" file. This file contains all the commands to create a PostgreSQL database, based on the information from the MySQL database. Since I was only interested in the loading data (or rather \"COPY\") parts, I used a simple perl script to parse \"mysql2pgsql.txt\" to get the \"COPY\" statements for all table which had data in.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E#!\u002Fusr\u002Fbin\u002Fperl\n\nuse warnings;\nuse strict;\n\nmy $file = \"mysql2pgsql.txt\";\n\nopen(DUMP, $file); \n\nmy $control = 0;\nmy $newfile; \nwhile ( &#x3C;DUMP\u003E ) {\n\n    if ($_ =~ \u002F^COPY \\\"(.*)\\\" \\(\u002F) {\n        $newfile = \"mysql2pgsql.\".$1.\".txt\";\n        print $newfile.\"\\n\";\n        open(OUT,\"\u003E$newfile\");\n        print OUT $_;\n    }   \n    if ($_ =~ \u002F&#x3C;sup\u003E[0-9]\u002F || $_ =~ \u002F&#x3C;\u002Fsup\u003EGalaxy\u002F) {\n        print OUT $_;\n        $control++;\n\n    }   \n    if ($_ =~ \u002F^\\\\\\.\u002F) {\n        print OUT $_;   \n        close OUT;\n        if ($control == 0) {\n            system(\"rm -f $newfile\");\n        }\n        $control =0;\n    }\n}\nclose DUMP;\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThis script generated 81 copy statements for the database used for our production server.\u003C\u002Fp\u003E\n\u003Ch2 id=\"loading-the-data\"\u003E\u003Ca href=\"#loading-the-data\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ELoading the Data\u003C\u002Fh2\u003E\n\u003Cp\u003EAs a PostgreSQL novice coming from the simple world of MySQL MyISAM tables, I had to learn how to deal with foreign keys. There were probably better ways to do this, but I decided to figure out the insertion order myself. Nowadays, I would check this \u003Ca href=\"https:\u002F\u002Fgalaxyproject.org\u002Fschema\u002FSchemaSpy\u002FinsertionOrder.txt\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Epage for the insertion order\u003C\u002Fa\u003E or deactivate the keys table by table (see \u003Ca href=\"http:\u002F\u002Fwww.postgresql.org\u002Fmessage-id\u002F4EA2057F.3000002@ringerc.id.au\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Ethis question\u002Fanswer\u003C\u002Fa\u003E) or \"DROP\" all keys first and \"ADD\" the constraints back after loading all the data.\u003C\u002Fp\u003E\n\u003Cp\u003EI could \"COPY\" the data for all tables without any problems. But before the database was ready to go, I had to set the \"sequences\" (see \u003Ca href=\"http:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F9108833\u002Fpostgres-autoincrement-not-updated-on-explicit-id-inserts\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Ehere for an explanation\u003C\u002Fa\u003E). At this point, I didn't know, which tables had such an autoincrement feature. In order to figure out, I created a complete database dump from the PostgreSQL database with \u003Ca href=\"http:\u002F\u002Fwww.postgresql.org\u002Fdocs\u002F9.4\u002Fstatic\u002Fapp-pgdump.html\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Epg_dump\u003C\u002Fa\u003E using the options \"-f postgresql.dump\" (send output to this file) and \"-F p\" (plain text). In the file \"postgresql.dump\", I searched for the \"SEQUENCE\" command and created for each a \"SELECT setval\" statement with the following perl script:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E#!\u002Fusr\u002Fbin\u002Fperl\n\nuse warnings;\nuse strict;\n\nmy $file = \"postgresql.dump\";\n\nopen(DUMP, $file); \n\nmy $control = 0;\nmy $newfile = \"fix_sequence.txt\";\n\nopen(FIX, \"\u003E$newfile\"); \n\nwhile ( &#x3C;DUMP\u003E) {\n\n    if ($_ =~ \u002F^CREATE SEQUENCE ((.*)_id_seq)\u002F) {\n        my $sequence = $1;\n        my $table = $2;\n        print FIX \"SELECT setval('\".$sequence.\"', (SELECT MAX(id) from \\\"\".$table.\"\\\"));\";\n        print FIX \"\\n\\n\";\n    }\n}\n\nclose DUMP;\nclose FIX;\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EI only used the \"SELECT setval\" commands for tables I loaded with data before.\u003C\u002Fp\u003E\n\u003Ch2 id=\"problems-i-was-running-into\"\u003E\u003Ca href=\"#problems-i-was-running-into\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EProblems I was running into\u003C\u002Fh2\u003E\n\u003Ch5 id=\"circular-foreign-keys\"\u003E\u003Ca href=\"#circular-foreign-keys\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Ecircular foreign keys\u003C\u002Fh5\u003E\n\u003Cp\u003EI run into three circular foreign key constraints in the (empty) PostgreSQL database:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Eworkflow &#x3C;-\u003E stored_worflow (see: \u003Ca href=\"https:\u002F\u002Fgalaxyproject.org\u002Fschema\u002FSchemaSpy\u002Ftables\u002Fworkflow.html\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Eworkflow\u003C\u002Fa\u003E)\u003C\u002Fli\u003E\n\u003Cli\u003Elibrary_dataset &#x3C;-\u003E library_dataset_dataset_association &#x3C;-\u003E history_dataset_association_dataset (see: \u003Ca href=\"https:\u002F\u002Fgalaxyproject.org\u002Fschema\u002FSchemaSpy\u002Ftables\u002Flibrary_dataset_dataset_association.html\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Elibrary_dataset_dataset_association.html\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003Eform_definition &#x3C;-\u003E form_definition_current (see: \u003Ca href=\"https:\u002F\u002Fgalaxyproject.org\u002Fschema\u002FSchemaSpy\u002Ftables\u002Fform_definition.html\" target=\"_blank\" rel=\"noopener noreferrer\"\u003Eform_definition\u003C\u002Fa\u003E)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EI solved it by dropping the constraint, uploading the data, and recreating the foreign key, eg:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EALTER TABLE workflow DROP CONSTRAINT workflow_stored_workflow_id_fkey;\n\n# 'COPY' workflow table\n# 'COPY' stored_workflow table\n\nALTER TABLE ONLY workflow ADD CONSTRAINT workflow_stored_workflow_id_fkey FOREIGN KEY (stored_workflow_id) REFERENCES stored_workflow(id);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cpre\u003E\u003Ccode\u003EALTER TABLE library_dataset DROP CONSTRAINT library_dataset_dataset_association_id_fk;\n\n# 'COPY' library_dataset table\n\nALTER TABLE library_dataset_dataset_association DROP CONSTRAINT history_dataset_association_dataset_id_fkey;\n\n# 'COPY' library_dataset_dataset_association table\n# 'COPY' history_dataset_association table\n\nALTER TABLE ONLY library_dataset ADD CONSTRAINT library_dataset_dataset_association_id_fk FOREIGN KEY (library_dataset_dataset_association_id) REFERENCES library_dataset_dataset_association(id);\n\nALTER TABLE ONLY library_dataset_dataset_association ADD CONSTRAINT history_dataset_association_dataset_id_fkey FOREIGN KEY (copied_from_history_dataset_association_id) REFERENCES history_dataset_association(id);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cpre\u003E\u003Ccode\u003EALTER TABLE form_definition DROP CONSTRAINT form_definition_form_definition_current_id_fkey;\n\n# 'COPY' form_definition table\n# 'COPY' form_definition_current table\n\nALTER TABLE ONLY form_definition ADD CONSTRAINT form_definition_form_definition_current_id_fkey FOREIGN KEY (form_definition_current_id) REFERENCES form_definition_current(id);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch5 id=\"tables-already-filled-by-galaxy\"\u003E\u003Ca href=\"#tables-already-filled-by-galaxy\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Etables already filled by galaxy\u003C\u002Fh5\u003E\n\u003Cp\u003EObviously, as part of the database generation the table \"migrate_version\" had already been filled in my case:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E=#select * from migrate_version;\n repository_id |     repository_path      | version \n---------------+--------------------------+---------\n Galaxy        | lib\u002Fgalaxy\u002Fmodel\u002Fmigrate |     128\n(1 row)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThe \"kombu_queue\" table was also not empty:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E=# select * from kombu_queue;\n id |     name     \n----+--------------\n  1 | control.main\n(1 row)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EIn both cases, the contents was equal to the contents from the dump out of the existing MySQL database.\u003C\u002Fp\u003E\n\u003Cp\u003EThe \"migrate_tools\" table is also pre-filled:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E=# select * from migrate_tools;\n repository_id |           repository_path            | version \n---------------+--------------------------------------+---------\n GalaxyTools   | lib\u002Ftool_shed\u002Fgalaxy_install\u002Fmigrate |       1\n(1 row)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EIn the our current MySQl databes, the version was '12'. The version had to be set to '12' in the new PostgrSQL database, otherwise it would cause troubles when re-starting the Galaxy server.\u003C\u002Fp\u003E\n\u003Ch5 id=\"legacy-from-manual-interfering\"\u003E\u003Ca href=\"#legacy-from-manual-interfering\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Elegacy from manual interfering\u003C\u002Fh5\u003E\n\u003Cp\u003EOur Galaxy instance is pretty old, and hence over the course of the last seven years, I have several times manually fixed some tables in the MySQL database. The biggest intervention, happened, when we switched to external authentication. Several users who used the Galaxy server before and after this switch ended up with two different entries in the galaxy_user table by not using the same e-mail address before, as now returned by the LDAP server (you run into similar issues, when a user asks for a different e-mail address, and the IT folks do not create an alias, but change the entry). Basically, this creates a duplication in the \"galaxy_user\" table.\u003C\u002Fp\u003E\n\u003Cp\u003EAt the time, most cases were easy to fix: delete the new user (i.e. the user created with the e-mail address coming from the LDAP server) and change the email address of the existing user, before the \u003Cem\u003Enew\u003C\u002Fem\u003E user executes any jobs. However, in one case I must have messed up something and now the foreign key constraints in PostgreSQL were complaining. I had to re-enter a \u003Cem\u003Edummy user\u003C\u002Fem\u003E into the \"galaxy_user\" and \"role\" and add several rows into the \"history\" table before I could upload the data into the new PostgreSQL database.\u003C\u002Fp\u003E\n\u003Ch5 id=\"difference-between-development-and-production-server\"\u003E\u003Ca href=\"#difference-between-development-and-production-server\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Edifference between development and production server\u003C\u002Fh5\u003E\n\u003Cp\u003EI first tested the transition process with our development server. Although, we are trying to keep the development and production server as similar as possible, some features have never been used in the development or in the production server. This has resulted in tables which were empty in the database for the development and populated in the database for the production server - or vice versa.  So I had to adjust the my insertion order.\u003C\u002Fp\u003E\n\u003Ch2 id=\"final-step\"\u003E\u003Ca href=\"#final-step\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EFinal Step\u003C\u002Fh2\u003E\n\u003Cp\u003EAs the final step, I had to change the database setting in the \"galaxy.ini\" (well, \"universe_wsgi.ini\" for our old instance) and \"reports_wsgi.ini\" files, and restart the server.\u003C\u002Fp\u003E\n\u003Cp\u003EI am sure there are better and easier ways to do this, but the process worked for me. Feel free to contact \u003Ca href=\"\u002Fpeople\u002Fhansrudolf-hotz\u002F\"\u003Eme\u003C\u002Fa\u003E, if you have any questions or want to do such a migration for your Galaxy server as well.\u003C\u002Fp\u003E\n"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.530b5429.js" defer></script><script src="/assets/js/page--src--templates--article-vue.64c93840.js" defer></script>
  </body>
</html>
