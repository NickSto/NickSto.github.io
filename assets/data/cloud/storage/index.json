{"hash":"14e186fd360947c1255e65c919a062692f477385","data":{"article":{"id":"ebb93ab428ba4374160a6218cde51a9f","title":"Cloud Storage API","tease":"","image":"","images":{},"category":null,"contact":"","date":null,"content":"<p>Galaxy allows a user to <code>get</code> /<code>send</code> data from/to a cloud-based storage, a functionality that is exposed via\ntwo APIs:</p>\n<ul>\n<li><code>/api/cloud/storage/get</code> [<a href=\"https://docs.galaxyproject.org/en/latest/lib/galaxy.webapps.galaxy.api.html?highlight=cloud#galaxy.webapps.galaxy.api.cloud.CloudController.get\" target=\"_blank\" rel=\"noopener noreferrer\">ref</a>];</li>\n<li><code>/api/cloud/storage/send</code>[<a href=\"https://docs.galaxyproject.org/en/latest/lib/galaxy.webapps.galaxy.api.html?highlight=cloud#galaxy.webapps.galaxy.api.cloud.CloudController.send\" target=\"_blank\" rel=\"noopener noreferrer\">ref</a>].</li>\n</ul>\n<p>(A graphical user interface for these two APIs is under development.)</p>\n<p>Note that for (data and credentials) security reasons, the <code>get</code> and <code>send</code> APIs do <strong>NOT</strong> ask for user credentials;\ninstead, they use auto-generated/refreshed credentials (<a href=\"/authnz/cloud/\">read details</a>).</p>\n<p>Generally, to use the <code>get</code> and <code>send</code> APIs one should take the following steps:</p>\n<ul>\n<li>\n<p><strong>Initialization</strong></p>\n<ol>\n<li>Login to Galaxy using your Google account (read\n<a href=\"/authnz/config/oidc/\">how to login to Galaxy using social identities</a>);</li>\n<li>Securely authorize Galaxy to read/write to your cloud-based storage (<a href=\"/authnz/cloud/\">read how</a>).</li>\n</ol>\n</li>\n<li>\n<p><strong>Securely access cloud-based storage</strong></p>\n<ol>\n<li><a href=\"#get-data-from-cloud\"><code>Get</code> data from cloud</a>;</li>\n<li><a href=\"#send-data-to-cloud\"><code>Send</code> data to cloud</a>.</li>\n</ol>\n</li>\n</ul>\n<p>In the following we explain how to use the <code>get</code> and <code>send</code> APIs. Users may use their preferred method for\ncommunication with Galaxy APIs; however, for demonstration reason only we use <a href=\"https://www.getpostman.com\" target=\"_blank\" rel=\"noopener noreferrer\">Postman</a>.</p>\n<h2 id=\"get-data-from-cloud\"><a href=\"#get-data-from-cloud\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a><code>Get</code> Data from Cloud</h2>\n<p>The <code>get</code> API allows a user to copy data from a cloud-based storage (e.g., Amazon S3, and Microsoft Azure BLOB)\nto a specified Galaxy <code>history</code>.</p>\n<p>In general, to use this API, <code>POST</code> a payload with following fields to <code>/api/cloud/storage/get</code>.</p>\n<table>\n<thead>\n<tr>\n<th>key</th>\n<th>required</th>\n<th>description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>history_id</code></td>\n<td>✔</td>\n<td>The ID of a <code>history</code> to which data should be copied from cloud.</td>\n</tr>\n<tr>\n<td><code>authz_id</code></td>\n<td>✔</td>\n<td>The ID of a cloud authorization record to be used to <em>read</em> data from cloud. (see <a href=\"/authnz/cloud/\">this page</a>)</td>\n</tr>\n<tr>\n<td><code>bucket</code></td>\n<td>✔</td>\n<td>The name of a bucket from which data should be read.</td>\n</tr>\n<tr>\n<td><code>objects</code></td>\n<td>✔</td>\n<td>A list of objects from the <code>bucket</code> that should be copied to Galaxy.</td>\n</tr>\n</tbody>\n</table>\n<p>A sample payload:</p>\n<pre><code class=\"language-json\">{\n    \"history_id\": \"...\",\n    \"authz_id\": \"...\",\n    \"bucket\": \"...\",\n    \"objects\": [\n        \"obj1\",\n        \"obj2\",\n        ...\n    ]\n}\n</code></pre>\n<p><a href=\"/cloud/storage/get_step_by_step/\">Read this page</a> for step-by-step description on how to use this API.</p>\n<h2 id=\"send-data-to-cloud\"><a href=\"#send-data-to-cloud\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a><code>Send</code> Data to Cloud</h2>\n<p>The <code>send</code> API allows a user to copy data from a Galaxy <code>history</code> to a cloud-based storage (e.g., Amazon S3, and\nMicrosoft Azure BLOB).</p>\n<p>In general, to use this API, <code>POST</code> a payload with the following fields <code>/api/cloud/storage/send</code>.</p>\n<table>\n<thead>\n<tr>\n<th>key</th>\n<th>required</th>\n<th>description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>history_id</code></td>\n<td>✔</td>\n<td>The ID of a <code>history</code> from which data should be copied to cloud.</td>\n</tr>\n<tr>\n<td><code>authz_id</code></td>\n<td>✔</td>\n<td>The ID of a cloud authorization record to be used to <em>write</em> data to cloud. (see <a href=\"/authnz/cloud/\">this page</a>)</td>\n</tr>\n<tr>\n<td><code>bucket</code></td>\n<td>✔</td>\n<td>The name of a bucket to which data should be written.</td>\n</tr>\n<tr>\n<td><code>dataset_ids</code></td>\n<td></td>\n<td>A list of encoded dataset IDs belonging to the specified history that should be sent to the given bucket. If not provided, Galaxy sends all the datasets belonging the specified history.</td>\n</tr>\n<tr>\n<td><code>overwrite_existing</code></td>\n<td></td>\n<td>A boolean value. If set to \"True\", and an object with same name of the dataset to be sent already exist in the bucket, Galaxy replaces the existing object with the dataset to be sent. If set to \"False\", Galaxy appends datetime to the dataset name to prevent overwriting an existing object.</td>\n</tr>\n</tbody>\n</table>\n<p>A sample payload:</p>\n<pre><code class=\"language-json\">{\n    \"history_id\": \"...\",\n    \"authz_id\": \"...\",\n    \"bucket\": \"...\"\n}\n</code></pre>\n<p>Or:</p>\n<pre><code class=\"language-json\">{\n    \"history_id\": \"03501d7626bd192f\",\n    \"authz_id\": \"f2db41e1fa331b3e\",\n    \"bucket\": \"vahid-objectstore-tests\",\n    \"dataset_ids\": [\n        \"0a248a1f62a0cc04\",\n        \"03501d7626bd192f\"\n    ],\n    \"overwrite_existing\": true\n}\n</code></pre>\n<p><a href=\"/cloud/storage/send_step_by_step/\">Read this page</a> for step-by-step description on how to use this API.</p>\n"}},"context":{}}