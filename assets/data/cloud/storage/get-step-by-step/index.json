{"hash":"c32ecfdb33b075b0057598b5b9118f3554a398cf","data":{"article":{"id":"05367d88a3d758f49823dfd377a310f8","title":"Get Data from Cloud","tease":"","image":"","images":{},"category":null,"contact":"","date":null,"content":"<p>The <code>get</code> API allows a user to copy data from a cloud-based storage (e.g., Amazon S3, and Microsoft Azure BLOB)\nto a specified Galaxy <code>history</code>. </p>\n<p>You may use the following steps to use this API:</p>\n<ol>\n<li>Login to Galaxy using your Google account (<a href=\"/src/authnz/config/oidc/index.md\">read how</a>);</li>\n<li>Define a <em>cloud authzorization</em> configuration (<a href=\"/src/authnz/cloud/index.md\">read how</a>);</li>\n<li>Get a Galaxy API key by going to <code>User -> Manage API key</code> On Galaxy's webpage and clicking on the\n<code>Create a new key</code> button;</li>\n<li>\n<p>Make the API call as it follows:</p>\n<p>4.1. Open <a href=\"https://www.getpostman.com\" target=\"_blank\" rel=\"noopener noreferrer\">Postman</a>;</p>\n<p>4.2. Choose <code>POST</code> and enter the following in the fields highlighted in the following figure:</p>\n<pre><code>http://127.0.0.1:8080/api/cloud/storage/get?key=1234567890\n</code></pre>\n<p>Replace <code>http://127.0.0.1:8080</code> with the IP address of the Galaxy instance you're using, and\nreplace <code>1234567890</code> with the your API key.</p>\n<p><img src=\"/src/cloud/storage/get_01.png\" alt=\"image\"></p>\n<p>4.3. Get the ID of Galaxy <code>history</code> to which you want to copy data, by going to the following\naddress on your browser:</p>\n<pre><code>http://127.0.0.1:8080/api/histories\n</code></pre>\n<p>This will display a JSON object similar to the following, note the value of <code>id</code> field:</p>\n<pre><code class=\"language-json\">[\n   {\n      \"name\":\"Unnamed history\",\n      \"tags\":[\n      ],\n      \"deleted\": false,\n      \"purged\": false,\n      \"annotation\": null,\n      \"url\": \"/api/histories/df7a1f0c02a5b08e\",\n      \"published\": false,\n      \"model_class\": \"History\",\n      \"id\": \"df7a1f0c02a5b08e\"\n   }\n]\n</code></pre>\n<p>4.4. Get the ID of authorization defined in step #2, which you want to use to read the\ncloud-based storage, by going to following address: </p>\n<pre><code>http://127.0.0.1:8080/api/cloud/authz\n</code></pre>\n<p>This will display a JSON object similar to the following, note the value of <code>id</code> field:</p>\n<pre><code class=\"language-json\">[\n   {\n      \"authn_id\": \"f2db41e1fa331b3e\",\n      \"user_id\": \"f2db41e1fa331b3e\",\n      \"last_update\": \"2018-12-07 17:53:55.714802\",\n      \"last_activity\": \"2018-12-07 17:53:55.714818\",\n      \"provider\": \"aws\",\n      \"model_class\": \"CloudAuthz\",\n      \"config\": \"{u'role_arn': u'arn:aws:iam:: ...'}\",\n      \"id\": \"f2db41e1fa331b3e\"\n   }\n]\n</code></pre>\n<p>4.5. On Postman, goto <code>Body</code> tab as shown in the following figure and enter the\nfollowing API payload:</p>\n<p><img src=\"/src/cloud/storage/get_02.png\" alt=\"image\"></p>\n<pre><code class=\"language-json\">{\n    \"history_id\": \"df7a1f0c02a5b08e\",\n    \"authz_id\": \"f2db41e1fa331b3e\",\n    \"bucket\": \"vahid-objectstore\",\n    \"objects\": [\n        \"rep1.bed\",\n        \"rep2.bed\"\n    ]\n}\n</code></pre>\n<p>Replace <code>vahid-objectstore</code> with a bucket name from which you want to <code>get</code> data,\nand replace <code>[\"rep1.bed\", \"rep2.bed\"]</code> with the list of objects you want to\ncopy to Galaxy from the <code>bucket</code>.</p>\n<p>4.6. Click on the <code>Send</code> button; Postman will submit a request to Galaxy to <code>get</code> data\nand will shows a result as the following. </p>\n<pre><code class=\"language-json\">[\n    {\n        \"update_time\": \"2018-12-07T22:41:39.844046\",\n        \"uuid\": \"7d1a6d7d-6651-4cfe-8792-beb13a79949d\",\n        \"deleted\": false,\n        \"purged\": false,\n        \"purgable\": true,\n        \"total_size\": 0,\n        \"state\": \"queued\",\n        \"create_time\": \"2018-12-07T22:41:39.790590\",\n        \"file_size\": 0,\n        \"id\": \"5969b1f7201f12ae\"\n    },\n    {\n        \"update_time\": \"2018-12-07T22:41:40.058628\",\n        \"uuid\": \"195e1cee-326c-4f88-bbf5-63a51bdc51bf\",\n        \"deleted\": false,\n        \"purged\": false,\n        \"purgable\": true,\n        \"total_size\": 0,\n        \"state\": \"queued\",\n        \"create_time\": \"2018-12-07T22:41:40.005482\",\n        \"file_size\": 0,\n        \"id\": \"df7a1f0c02a5b08e\"\n    }\n]\n</code></pre>\n<p>This JSON object shows two Galaxy datasets created for <code>rep1.bed</code> and <code>rep2.bed</code>. </p>\n</li>\n</ol>\n"}},"context":{}}