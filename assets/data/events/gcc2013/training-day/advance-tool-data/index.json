{"hash":"a97cc003ab7b7b0128b2927bf289a961e571a0b8","data":{"article":{"id":"b341f914fb3f2accf98371ddc7641748","title":"GCC2013 Training Day","tease":"","category":"","date":null,"days":null,"contact":"","contact_url":"","authors":"","location":"","location_url":"","source_blog":"","source_blog_url":"","skip_title_render":null,"redirect":"","autotoc":null,"links":[],"image":"","images":{},"inserts":[{"name":"/events/gcc2013/header","content":"<div class=\"text-center\">\n[<img class=\"img-fluid mx-auto\" src=\"/images/logos/GCC2013Logo400.png\" alt=\"2013 Galaxy Community Conference (GCC2013), Oslo, Norway, 30 June - 2 July, 2013\" />](/src/events/gcc2013/index.md)\n<br />\n**[Watch the talks](http://vimeo.com/channels/581875)!  [See you at GCC2018](https://gccbosc2018.sched.com/)!**\n<br /><br />\n</div>\n"},{"name":"/events/gcc2013/linkbox","content":"<div class=\"alert alert-info float-right text-center trim-p\">\n<p><a href=\"/events/gcc2013/\"><strong>GCC2013</strong></a><br>\n<a href=\"/events/gcc2013/program/\">Program</a><br>\n<a href=\"/events/gcc2013/training-day/\">Training</a><br>\n<a href=\"/events/gcc2013/bof/\">BoFs</a><br>\n<a href=\"/events/gcc2013/abstracts/\">Abstracts</a><br>\n<a href=\"/events/gcc2013/logistics/\">Logistics</a><br>\n<a href=\"/events/gcc2013/sponsorships/\">Sponsors</a><br>\n<a href=\"/events/gcc2013/key-dates/\">Key Dates</a><br>\n<a href=\"/events/gcc2013/register/\">Register</a><br>\n<a href=\"/events/gcc2013/promotion/\">Promotion</a><br>\n<a href=\"/events/gcc2013/organizers/\">Organizers</a></p>\n</div>\n"},{"name":"/events/gcc2013/footer","content":"<p><br /><br /></p>\n<hr>\n<p>Questions? Contact the <a href=\"/events/gcc2013/organizers/\">Organizers</a>.</p>\n"}],"external_url":"","content":"\ntable-of-contents\n=================\n\nend-table-of-contents\n=====================\n\n<slot name=\"/events/gcc2013/header\" />\n\n<slot name=\"/events/gcc2013/linkbox\" />\n\n<div class='right'><a href=\"/events/gcc2013/training-day/\"><img src=\"/images/logos/GCC2013TrainingDayLogo300.png\" alt=\"Training Day\" width=\"200\" /></a></div>\n\nAdvanced Tool and Data Source Configuration\n===========================================\n\nPresenters: Ross Lazarus and Dan Blankenberg\n--------------------------------------------\n\nScheduled duration: 15:00-17:00\n-------------------------------\n\nHelpful links\n-------------\n\n* http://wiki.galaxyproject.org/Admin/Tools/ToolConfigSyntax\n* http://www.cheetahtemplate.org/\n\n15:00-15:05 Introduction to advanced tool and data source configuration\n-----------------------------------------------------------------------\n\nAs an administrator of your own local Galaxy, you can extend Galaxy by writing new tools. There are a few things you need to do to make them work. In the simplest possible case, you need to prepare some XML and make your Galaxy read it in at startup when it reads and parses tool_conf.xml. Each tool must include a unique tool id, a visible name and a command line template. In addition, they can also include multiple tool form parameters with labels, validation and help, outputs, tests, dependency/version requirements. Galaxy uses these to set up the tool list and each selected tool's user interface form.\n\nIn summary, the essence of the entire 2 hour session is that to create your own tool in Galaxy, you need to:\n\n* ensure the executable is available to the execution host (your own VM/login in the workshop)\n\n* write some valid XML in a text file to describe your new tool and put it somewhere under tools/\n\n* edit tool_conf.xml to tell Galaxy where that XML file can be found - leave out the path .../tools/\n\n* restart Galaxy to make the new tool available\n\n### Intro\n\n* Introduce presenters and circulating tutors\n* Scope of the session - start with simplest possible tool.\n* Add complexity in the form of one useful tool feature at a time.\n* Offer a series of examples covering a wide range of common tool requirements.\n* We'll work as far as we can get.\n* NOT explaining how Galaxy actually works.\n* Moving at a fair clip through the essential steps for a new tool to become available to users on your own local Galaxy.\n* Command line skills really will be needed.\n\n15:05-15:25 Hello world in Galaxian\n-----------------------------------\n\nThe first exercise consists of creating (or copying, your choice) a text file containing valid XML describing a simple and admittedly, not very useful tool which calls a python script to do some work. However, it will demonstrate the bare bones of the power of the Galaxy tool interface. A few lines of XML and a small python script get you a familiar, simple user interface and a single new history item - a text file containing a string. Note that this is a trivial variation on the hello world tool used in the introductory session - instead of a fugly command line, we're also introducing a python script that does the actual work.\n\nSteps:\n\n1. Make a new directory \\[galaxy root]/tools/hello_advanced and put hello_advanced.xml there containing\n\n<div class='indent'>\n```xml\n<tool id=\"hello_advanced\" name=\"Hello Advanced\" version=\"0.01\">\n<description>World</description>\n<command interpreter=\"python\">\nhello_advanced.py -o \"${output1}\" -s \"hello advanced world\"\n</command>\n<outputs>\n    <data format=\"tabular\" name=\"output1\" label=\"hello_advanced_world\"/>\n</outputs>\n<help>\n**What it does**\nSays hello advanced world by running a python script and passing appropriate parameters\n</help>\n</tool>\n```\n\nMake a new python script to match the name on the command line above (hello_advanced.py) containing\n\n```python\n#!/bin/env python\n# python script to echo a command line parameter to an output file also passed on the command line\n# your name here\n# your favourite OSI approved licence here\nimport sys\nimport optparse\n\ndef advanced():\n\t\"\"\"\n\tTrivial example\n\t\"\"\"\n        usage = \"%s -o outfilename -s stringtowrite1 -s stringtowrite2 ...\" % sys.argv[0]\n\tparser = optparse.OptionParser(usage = usage)\n\tparser.add_option(\"-s\", \"--stringtowrite\",\n\t                 action=\"append\", type=\"string\",dest=\"mystring\",help=\"Strings to write\")\n\tparser.add_option(\"-o\",\"--outputfile\",\n\t                 action=\"store\", type=\"string\",dest=\"outputfile\",help=\"output text file\")\n\t(opts, args) = parser.parse_args()\n\tassert len(opts.mystring) > 0, \"No strings to write found on command line\"\n\tassert opts.outputfile,\"No output file name found on command line\"\n\toutf = open(opts.outputfile,'w')\n\toutf.write('\\n'.join(opts.mystring))\n\toutf.write('\\n')\n\toutf.close\n\nif __name__ == \"__main__\":\n\tadvanced()\n```\n\nTest this script on the command line - eg something like\n\n```\npython tools/hello_advanced/hello_advanced.py -s \"hello\" -s \"advanced\" -s \"world\" -o /tmp/test.txt\ncat /tmp/test.txt\n```\n\n**Fix any syntax errors and make sure this runs and that the expected output is generated correctly** because if it doesn't run from the command line, it certainly won't run when you try calling it from Galaxy!\n\nThis text and the python script it calls are all you need for a new, real new tool, including some help to display to the user. In this example, the executable we use is a python script which echos it's input (the string) to a new history output file. A single command line parameter **\"${output1}\"** on the command line is replaced with the Galaxy job execution engine's choice of path and the command line is parsed in the script\n\nThe syntax ${...} is recommended and it is also recommended that all user supplied parameters be quoted in case the parameter contains slashes or spaces which might cause the tool to fail mysteriously.\n\n</div>\n\n2. \\#2 If not already done, adjust universe_wsgi.ini by adding an admin_user email you will register with when you first log in - use commas ONLY - no spaces - to separate admin email addresses. Adjust tool_conf.xml adding a new tool path that must exactly match the directory/filename you chose for your tool.\n\n```xml\n<tool file=\"hello_advanced/hello_advanced.xml\"/> \n```\n\n3. \\#3 Restart\n\n**Stop Galaxy if it's running**\n\n```\nsh run.sh –stop-daemon\n```\n\n**Restart Galaxy**\n\n```\nsh run.sh –daemon\n```\n\n4. \\#4 Check paster.log for errors (search for “hello” to find where your tool loaded – or barfed). If it fails to load, look for the syntax error, repair it, rinse, repeat... until it loads.\n\n5. \\#5 When it loads correctly, test your new tool. In your VM webrowser, visit http://localhost:8080 . Register your admin email address if you haven't already done so and log in. Test your new tool. It will write “hello world” to a new file in your history. If/when it works, find the actual commands Galaxy executed to run your tool in paster.log. If it fails, look in paster.log for hints about what went wrong. Repair and reload via the admin interface (no need to restart the Galaxy server) until it works.\n\n6. \\#6 Raise arms in victory \\o/\n\n#### Bonus points if you finish early\n\n1. Look at what's been written to paster.log during correct execution.\n\n2. Make it do something more interesting.\n\n15:25-15:45 Hello world test\n----------------------------\n\nWorking automated functional tests are a great way to assure yourself that your tool works correctly for at least the test cases you provide and they are required for IUC approval of tool shed tools. Everytime Galaxy is updated, running the functional tests will assure you that changes to the core Galaxy code have not broken something in your tools. Without automated tests, you would need to test by hand every time you update.\n\nTests could fill a workshop on their own, but we can add a simple one for the hello advanced example with a few extra lines of code. We also need to provide the expected output from the test in the test-data subdirectory so the test framework can compare what is produced when the test is run against what is expected.\n\nSteps:\n\n1. \\#1 Make a new text file in your Galaxy test-data/ directory under the name hello_world_advanced_testout.txt - we will provide that name to the test tag and the test harness will find it there. It should contain exactly the same string as a successful run of the hello world advanced script which should be the single string\n\n```\n\nhello world advanced\n```\n\n2. \\#2 Save a copy of hello_world_advanced.xml as hello_world_advanced1.xml\n\n3. \\#3 Adjust hello_world_advanced.xml so it includes the test section shown below\n\n```xml\n<tool id=\"hello_advanced\" name=\"Hello Advanced\" version=\"0.02\">\n<description>World</description>\n<command interpreter=\"python\">\nhello_advanced.py -o \"${output1}\" -s \"hello advanced world\"\n</command>\n<outputs>\n<data format=\"tabular\" name=\"output1\" label=\"hello_advanced\"/>\n</outputs>\n<tests>\n<test>\n<output name='output1' file='hello_world_advanced_testout.txt' />\n</test>\n</tests>\n<help>\n\n**What it does**\nSays hello advanced world by running a python script and passing appropriate parameters with a functional test\n</help>\n</tool>\n```\n\n3. \\#4 Add the same line you added to tool_conf.xml to tool_conf.xml.sample - this is used by the functional test harness to find any tools to be tested. **The test will not work** unless it is also in that tool_conf.xml.sample file.\n\n4. \\#5 Reload the hello_world_advanced tool and run it again to make sure there are no syntax errors in the test section - the test won't pass unless the tool itself runs in Galaxy.\n\n5. \\#6 Run a functional test on the command line and use the -id parameter to pass the tool id hello_advanced\n\n```\n\nsh run_functional_tests.sh -id hello_advanced\n```\n\nIf the test does not work you will see some tracebacks which will indicate what you need to fix. There will be a default output file run_functional_tests.html containing the test results with failure details if it did not work\n\n15:40-15:55. Hello repeating input\n----------------------------------\n\nAdd a repeating group input parameter as shown. These are handy when you need an unknown number of parameters from the user since they allow the user to simply add more until they are done. Save. Reload the tool via the admin interface and test it out. Repeat until it's working right. Experiment and play with the new repeating parameter. Note how the repeats are passed to the python script, where the optparse \"append\" option adds them to a list of strings which are then written as newline delimited rows.\n\n```xml\n<tool id=\"hello_advanced\" name=\"Hello Advanced\" version=\"0.03\">\n<description>World</description>\n<command interpreter=\"python\">\nhello_advanced.py -o \"${output1}\"\n#for x in $writeme\n-s \"$x.astring\"\n#end for\n</command>\n<inputs>\n<repeat name=\"writeme\" title=\"Strings to be written\">\n<param name=\"astring\" type=\"text\" label=\"An interesting string to write\" help=\"keep adding these if you want\"/>\n</repeat>\n</inputs>\n<outputs>\n<data format=\"tabular\" name=\"output1\" label=\"hello_advanced_repeats\"/>\n</outputs>\n<help>\n**What it does**\nSays hello advanced world by running a python script and passing appropriate parameters\nAny number of strings can be input by the user through the use of a repeat tag\n</help>\n</tool>\n```\n\n### Bonus points\n\n1. 1 Experiment with tabs as separators ('\\t') or commas or whatever instead of '\\n'.\n\n15:55 – 16:10 Hello_conditional\n-------------------------------\n\nConditional tags allow control flow in a tool form such as the \"advanced options\" control in the BWA/BWA2 tools forms. Add a very simple one as follows to allow the user to either input only one string without the repeat tag, or if they want to use the repeat tag and add as many as they feel like. Save hello_advanced.xml as hello_advanced2.xml as a backup and replace hello_advanced.xml with something like\n\n```xml\n<tool id=\"hello_advanced\" name=\"Hello Advanced\" version=\"0.04\">\n<description>World</description>\n<command interpreter=\"python\">\nhello_advanced.py -o \"${output1}\"\n#if $allowMulti.onlyOne == \"yes\"\n #for x in $allowMulti.writeme\n  -s \"$x.strings\"\n #end for\n#else\n  -s \"$allowMulti.astring\"\n#end if\n</command>\n<inputs>\n   <conditional name=\"allowMulti\">\n      <param name=\"onlyOne\" type=\"select\" label=\"Allow multiple strings?\">\n        <option value=\"yes\" selected=\"True\">Use the repeat tag</option>\n        <option value=\"no\">No repeat tag</option>\n      </param>\n      <when value=\"yes\" >\n        <repeat name=\"writeme\" title=\"Strings\">\n           <param name=\"strings\" type=\"text\" label=\"An interesting string to write\" help=\"keep adding these if you want\"/>\n        </repeat>\n      </when>\n      <when value=\"no\">\n           <param name=\"astring\" type=\"text\" label=\"An interesting string to write\" help=\"You only get one of these!\"/>\n      </when>\n    </conditional>\n</inputs>\n<outputs>\n<data format=\"tabular\" name=\"output1\" label=\"hello_advanced_repeats\"/>\n</outputs>\n<help>\n**What it does**\nSays hello advanced world by running a python script and passing appropriate parameters\nOptionally, any number of strings can be input by the user through the use of a repeat tag. Or not.\n</help>\n</tool>\n```\n\nNote the use of #if and other cheetah tags to control the command line depending on how the user has set the conditional tag and whether there are repeats to add to the command line. This additional logic is a necessary complication and studying working examples like the BWA wrapper is helpful if you get stuck.\n\nReload the hello_advanced tool from the admin interface and use the redo button to recreate the form - test it with the repeat tag turned off and a single string, then with the repeat.\n\nCheck the output of paster.log to see how Galaxy is setting up the command line for the call to the python script for you.\n\nNotice how the repeat group starts out empty. See if you can change it so there is always at least one string parameter showing on the form when the repeat group is turned on.\nhttp://wiki.galaxyproject.org/Admin/Tools/ToolConfigSyntax#A.3Crepeat.3E_tag_set has the change you need.\n\n16:10 – 16:30 Hello Tool Data Tables\n------------------------------------\n\nMany Galaxy tools are able to make use of built-in reference data, e.g. genome indexes for the bwa aligner, that a user can choose from e.g. a select list. Ordinarily, this select list would need to be hard-coded into the tool's xml config, but by relying on Tool Data Tables, we can have the options of the select list populated with content from an external file.\n\nCurrently Tool Data Tables use tab-delimited files (the framework is generic and other formatted files can be defined); each field in the table is separated by a tab character.\n\nA bare minimum for tool data tables is to include at least a value (required) and a display name (defaults to value when not specified) that will be used to populate the tool form and determine the value to pass on the command-line. The exact number and content of the columns to use with a tool data table will vary for the specific purpose, but a good practice would be to include an unique ID (value), name, dbkey (when needed), and command-line value. For example, the bwa_index.loc file has the form:\n\n```\n<unique_build_id>\t<dbkey>\t<display_name>\t<file_path>\n```\n\nwith a tool data table defined in tool_data_table_conf.xml:\n\n```xml\n<tables>\n    <!-- Locations of indexes in the BWA mapper format -->\n    <table name=\"bwa_indexes\" comment_char=\"#\">\n        <columns>value, dbkey, name, path</columns>\n        <file path=\"tool-data/bwa_index.loc\" />\n    </table>\n</tables>\n```\n\nHere the value is the unique id and is the value stored in the database (for e.g. rerun). The path column contains the path to the indexes, which will be the value passed to the command-line; this allows the underlying paths to the indexes to change over time, as needed, but to remain usable in workflows or via rerun.\n\nInside of the bwa tool xml file, we then define the select list parameter as:\n\n```xml\n<param name=\"indices\" type=\"select\" label=\"Select a reference genome\">\n          <options from_data_table=\"bwa_indexes\">\n            <validator type=\"no_options\" message=\"No indexes are available\" />\n          </options>\n        </param>\n```\n\nand can pass the \"path\" value of the selected data table entry as:\n\n```\n\"${indices.fields.path}\"\n```\n\nCreate a new location file tool-data/hello_world.loc, and add several entries, e.g. of the form:\n\n```\n#<greeting_id>\t<greeting_text>\t<path_to_image_file_of_greeting>\t<world_where_greating_is_valid>\ngreeting_hello\tHello\t/path/to/file.png\tEarth\n```\n\n**Be sure to check that white space between fields are `<TABS>` and not spaces (double check, some editors automatically replace tab with space).**\n\nEdit your tool_data_tables_conf.xml file and define the structure of the data table:\n\n```xml\n<table name=\"hello_world\" comment_char=\"#\">\n        <columns>value, name, image_path, valid_world</columns>\n        <file path=\"tool-data/hello_world.loc\" />\n    </table>\n```\n\nDefine the new parameter as\n\n```xml\n<param name=\"builtin_greeting\" type=\"select\" label=\"Select a greeting\">\n          <options from_data_table=\"hello_world\">\n            <validator type=\"no_options\" message=\"No indexes are available\" />\n          </options>\n        </param>\n```\n\nYou can then access the various fields in the command-line by using e.g\n\n```\n-s \"${builtin_greeting.fields.name}\"\n```\n\nor\n\n```\n-s \"${builtin_greeting.fields.valid_world}\"\n```\n\nFeel free to play around with different numbers of entries passing different values via the command-line.\n\n16:30 – 16:45 Hello Macros\n--------------------------\n\nMacros allow the reuse of commonly used chunks of code (e.g. parameter definitions and commandline cheetah code). This is particularly useful for tool suites that may have multiple individual tools, but which share a collection of commonly defined parameters.\n\nExtensively documented: http://wiki.galaxyproject.org/Admin/Tools[/ToolConfigSyntax](/events/gcc2013/training-day/advance-tool-data/ToolConfigSyntax/)#Reusing_Repeated_Configuration_Elements\n\nAn example is the GATK. See tools/gatk/unified_genotyper.xml which makes use of the Macro file tools/gatk/gatk_macros.xml.\n\nunified_genotyper.xml:\n\n```xml\n<tool id=\"gatk_unified_genotyper\" name=\"Unified Genotyper\" version=\"0.0.6\">\n  <description>SNP and indel caller</description>\n  <requirements>\n      <requirement type=\"package\" version=\"1.4\">gatk</requirement>\n      <requirement type=\"package\">samtools</requirement>\n  </requirements>\n  <macros>\n    <import>gatk_macros.xml</import>\n  </macros>\n  <command interpreter=\"python\">gatk_wrapper.py\n   --max_jvm_heap_fraction \"1\"\n   --stdout \"${output_log}\"\n   #for $i, $input_bam in enumerate( $reference_source.input_bams ):\n       -d \"-I\" \"${input_bam.input_bam}\" \"${input_bam.input_bam.ext}\" \"gatk_input_${i}\"\n       #if str( $input_bam.input_bam.metadata.bam_index ) != \"None\":\n           -d \"\" \"${input_bam.input_bam.metadata.bam_index}\" \"bam_index\" \"gatk_input_${i}\" ##hardcode galaxy ext type as bam_index\n       #end if\n   #end for\n   -p 'java \n    -jar \"${GALAXY_DATA_INDEX_DIR}/shared/jars/gatk/GenomeAnalysisTK.jar\"\n    -T \"UnifiedGenotyper\"\n    --num_threads 4 ##hard coded, for now\n    --out \"${output_vcf}\"\n    --metrics_file \"${output_metrics}\"\n    -et \"NO_ET\" ##ET no phone home\n    ##-log \"${output_log}\" ##don't use this to log to file, instead directly capture stdout\n    #if $reference_source.reference_source_selector != \"history\":\n        -R \"${reference_source.ref_file.fields.path}\"\n    #end if\n    --genotype_likelihoods_model \"${genotype_likelihoods_model}\"\n    --standard_min_confidence_threshold_for_calling \"${standard_min_confidence_threshold_for_calling}\"\n    --standard_min_confidence_threshold_for_emitting \"${standard_min_confidence_threshold_for_emitting}\"\n   '\n    #set $rod_binding_names = dict()\n    #for $rod_binding in $rod_bind:\n        #if str( $rod_binding.rod_bind_type.rod_bind_type_selector ) == 'custom':\n            #set $rod_bind_name = $rod_binding.rod_bind_type.custom_rod_name\n        #else\n            #set $rod_bind_name = $rod_binding.rod_bind_type.rod_bind_type_selector\n        #end if\n        #set $rod_binding_names[$rod_bind_name] = $rod_binding_names.get( $rod_bind_name, -1 ) + 1\n        -d \"--dbsnp:${rod_bind_name},%(file_type)s\" \"${rod_binding.rod_bind_type.input_rod}\" \"${rod_binding.rod_bind_type.input_rod.ext}\" \"input_${rod_bind_name}_${rod_binding_names[$rod_bind_name]}\"\n    #end for\n   \n    #include source=$standard_gatk_options#\n    ##start analysis specific options\n    #if $analysis_param_type.analysis_param_type_selector == \"advanced\":\n        -p '\n        --p_nonref_model \"${analysis_param_type.p_nonref_model}\"\n        --heterozygosity \"${analysis_param_type.heterozygosity}\"\n        --pcr_error_rate \"${analysis_param_type.pcr_error_rate}\"\n        --genotyping_mode \"${analysis_param_type.genotyping_mode_type.genotyping_mode}\"\n        #if str( $analysis_param_type.genotyping_mode_type.genotyping_mode ) == 'GENOTYPE_GIVEN_ALLELES':\n            --alleles \"${analysis_param_type.genotyping_mode_type.input_alleles_rod}\"\n        #end if\n        --output_mode \"${analysis_param_type.output_mode}\"\n        ${analysis_param_type.compute_SLOD}\n        --min_base_quality_score \"${analysis_param_type.min_base_quality_score}\"\n        --max_deletion_fraction \"${analysis_param_type.max_deletion_fraction}\"\n        --max_alternate_alleles \"${analysis_param_type.max_alternate_alleles}\"\n        --min_indel_count_for_genotyping \"${analysis_param_type.min_indel_count_for_genotyping}\"\n        --indel_heterozygosity \"${analysis_param_type.indel_heterozygosity}\"\n        --indelGapContinuationPenalty \"${analysis_param_type.indelGapContinuationPenalty}\"\n        --indelGapOpenPenalty \"${analysis_param_type.indelGapOpenPenalty}\"\n        --indelHaplotypeSize \"${analysis_param_type.indelHaplotypeSize}\"\n        ${analysis_param_type.doContextDependentGapPenalties}\n        #if str( $analysis_param_type.annotation ) != \"None\":\n            #for $annotation in str( $analysis_param_type.annotation.fields.gatk_value ).split( ','):\n                --annotation \"${annotation}\"\n            #end for\n        #end if\n        #for $additional_annotation in $analysis_param_type.additional_annotations:\n            --annotation \"${additional_annotation.additional_annotation_name}\"\n        #end for\n        #if str( $analysis_param_type.group ) != \"None\":\n            #for $group in str( $analysis_param_type.group ).split( ','):\n                --group \"${group}\"\n            #end for\n        #end if\n        #if str( $analysis_param_type.exclude_annotations ) != \"None\":\n            #for $annotation in str( $analysis_param_type.exclude_annotations.fields.gatk_value ).split( ','):\n                --excludeAnnotation \"${annotation}\"\n            #end for\n        #end if\n        ${analysis_param_type.multiallelic}\n        '\n    #end if\n  </command>\n  <inputs>\n    <conditional name=\"reference_source\">\n      <expand macro=\"reference_source_selector_param\" />\n      <when value=\"cached\">\n        <repeat name=\"input_bams\" title=\"BAM file\" min=\"1\" help=\"-I,--input_file &amp;lt;input_file&amp;gt;\">\n            <param name=\"input_bam\" type=\"data\" format=\"bam\" label=\"BAM file\">\n              <validator type=\"unspecified_build\" />\n              <validator type=\"dataset_metadata_in_data_table\" table_name=\"gatk_picard_indexes\" metadata_name=\"dbkey\" metadata_column=\"dbkey\" message=\"Sequences are not currently available for the specified build.\" /> <!-- fixme!!! this needs to be a select -->\n            </param>\n        </repeat>\n        <param name=\"ref_file\" type=\"select\" label=\"Using reference genome\" help=\"-R,--reference_sequence &amp;lt;reference_sequence&amp;gt;\">\n          <options from_data_table=\"gatk_picard_indexes\">\n            <!-- <filter type=\"data_meta\" key=\"dbkey\" ref=\"input_bam\" column=\"dbkey\"/> does not yet work in a repeat...--> \n          </options>\n          <validator type=\"no_options\" message=\"A built-in reference genome is not available for the build associated with the selected input file\"/>\n        </param>\n      </when>\n      <when value=\"history\"> <!-- FIX ME!!!! -->\n        <repeat name=\"input_bams\" title=\"BAM file\" min=\"1\" help=\"-I,--input_file &amp;lt;input_file&amp;gt;\">\n            <param name=\"input_bam\" type=\"data\" format=\"bam\" label=\"BAM file\" >\n            </param>\n        </repeat>\n        <param name=\"ref_file\" type=\"data\" format=\"fasta\" label=\"Using reference file\" help=\"-R,--reference_sequence &amp;lt;reference_sequence&amp;gt;\" />\n      </when>\n    </conditional>\n    \n    <repeat name=\"rod_bind\" title=\"Binding for reference-ordered data\" help=\"-D,--dbsnp &amp;lt;dbsnp&amp;gt;\">\n        <conditional name=\"rod_bind_type\">\n          <param name=\"rod_bind_type_selector\" type=\"select\" label=\"Binding Type\">\n            <option value=\"dbsnp\" selected=\"True\">dbSNP</option>\n            <option value=\"snps\">SNPs</option>\n            <option value=\"indels\">INDELs</option>\n            <option value=\"custom\">Custom</option>\n          </param>\n          <when value=\"dbsnp\">\n              <param name=\"input_rod\" type=\"data\" format=\"vcf\" label=\"ROD file\" />\n          </when>\n          <when value=\"snps\">\n              <param name=\"input_rod\" type=\"data\" format=\"vcf\" label=\"ROD file\" />\n          </when>\n          <when value=\"indels\">\n              <param name=\"input_rod\" type=\"data\" format=\"vcf\" label=\"ROD file\" />\n          </when>\n          <when value=\"custom\">\n              <param name=\"custom_rod_name\" type=\"text\" value=\"Unknown\" label=\"ROD Name\"/>\n              <param name=\"input_rod\" type=\"data\" format=\"vcf\" label=\"ROD file\" />\n          </when>\n        </conditional>\n    </repeat>\n    \n    <param name=\"genotype_likelihoods_model\" type=\"select\" label=\"Genotype likelihoods calculation model to employ\" help=\"-glm,--genotype_likelihoods_model &amp;lt;genotype_likelihoods_model&amp;gt;\">\n      <option value=\"BOTH\" selected=\"True\">BOTH</option>\n      <option value=\"SNP\">SNP</option>\n      <option value=\"INDEL\">INDEL</option>\n    </param>\n    \n    <param name=\"standard_min_confidence_threshold_for_calling\" type=\"float\" value=\"30.0\" label=\"The minimum phred-scaled confidence threshold at which variants not at 'trigger' track sites should be called\" help=\"-stand_call_conf,--standard_min_confidence_threshold_for_calling &amp;lt;standard_min_confidence_threshold_for_calling&amp;gt;\" />\n    <param name=\"standard_min_confidence_threshold_for_emitting\" type=\"float\" value=\"30.0\" label=\"The minimum phred-scaled confidence threshold at which variants not at 'trigger' track sites should be emitted (and filtered if less than the calling threshold)\" help=\"-stand_emit_conf,--standard_min_confidence_threshold_for_emitting &amp;lt;standard_min_confidence_threshold_for_emitting&amp;gt;\" />\n\n    \n    <expand macro=\"gatk_param_type_conditional\" />\n    \n    <expand macro=\"analysis_type_conditional\">\n        <param name=\"p_nonref_model\" type=\"select\" label=\"Non-reference probability calculation model to employ\" help=\"-pnrm,--p_nonref_model &amp;lt;p_nonref_model&amp;gt;\">\n          <option value=\"EXACT\" selected=\"True\">EXACT</option>\n          <option value=\"GRID_SEARCH\">GRID_SEARCH</option>\n        </param>\n        <param name=\"heterozygosity\" type=\"float\" value=\"1e-3\" label=\"Heterozygosity value used to compute prior likelihoods for any locus\" help=\"-hets,--heterozygosity &amp;lt;heterozygosity&amp;gt;\" />\n        <param name=\"pcr_error_rate\" type=\"float\" value=\"1e-4\" label=\"The PCR error rate to be used for computing fragment-based likelihoods\" help=\"-pcr_error,--pcr_error_rate &amp;lt;pcr_error_rate&amp;gt;\" />\n        <conditional name=\"genotyping_mode_type\">\n          <param name=\"genotyping_mode\" type=\"select\" label=\"How to determine the alternate allele to use for genotyping\" help=\"-gt_mode,--genotyping_mode &amp;lt;genotyping_mode&amp;gt;\">\n            <option value=\"DISCOVERY\" selected=\"True\">DISCOVERY</option>\n            <option value=\"GENOTYPE_GIVEN_ALLELES\">GENOTYPE_GIVEN_ALLELES</option>\n          </param>\n          <when value=\"DISCOVERY\">\n            <!-- Do nothing here -->\n          </when>\n          <when value=\"GENOTYPE_GIVEN_ALLELES\">\n            <param name=\"input_alleles_rod\" type=\"data\" format=\"vcf\" label=\"Alleles ROD file\" help=\"-alleles,--alleles &amp;lt;alleles&amp;gt;\" />\n          </when>\n        </conditional>\n        <param name=\"output_mode\" type=\"select\" label=\"Should we output confident genotypes (i.e. including ref calls) or just the variants?\" help=\"-out_mode,--output_mode &amp;lt;output_mode&amp;gt;\">\n          <option value=\"EMIT_VARIANTS_ONLY\" selected=\"True\">EMIT_VARIANTS_ONLY</option>\n          <option value=\"EMIT_ALL_CONFIDENT_SITES\">EMIT_ALL_CONFIDENT_SITES</option>\n          <option value=\"EMIT_ALL_SITES\">EMIT_ALL_SITES</option>\n        </param>\n        <param name=\"compute_SLOD\" type=\"boolean\" truevalue=\"--computeSLOD\" falsevalue=\"\" label=\"Compute the SLOD\" help=\"--computeSLOD\" />\n        <param name=\"min_base_quality_score\" type=\"integer\" value=\"17\" label=\"Minimum base quality required to consider a base for calling\" help=\"-mbq,--min_base_quality_score &amp;lt;min_base_quality_score&amp;gt;\" />\n        <param name=\"max_deletion_fraction\" type=\"float\" value=\"0.05\" label=\"Maximum fraction of reads with deletions spanning this locus for it to be callable\" help=\"to disable, set to &lt; 0 or &gt; 1 (-deletions,--max_deletion_fraction &amp;lt;max_deletion_fraction&amp;gt;)\" />\n        <param name=\"max_alternate_alleles\" type=\"integer\" value=\"5\" label=\"Maximum number of alternate alleles to genotype\" help=\"-maxAlleles,--max_alternate_alleles &amp;lt;max_alternate_alleles&amp;gt;\" />\n        <param name=\"min_indel_count_for_genotyping\" type=\"integer\" value=\"5\" label=\"Minimum number of consensus indels required to trigger genotyping run\" help=\"-minIndelCnt,--min_indel_count_for_genotyping &amp;lt;min_indel_count_for_genotyping&amp;gt;\" />\n        <param name=\"indel_heterozygosity\" type=\"float\" value=\"0.000125\" label=\"Heterozygosity for indel calling\" help=\"1.0/8000==0.000125 (-indelHeterozygosity,--indel_heterozygosity &amp;lt;indel_heterozygosity&amp;gt;)\"/>\n        <param name=\"indelGapContinuationPenalty\" type=\"float\" value=\"10.0\" label=\"Indel gap continuation penalty\" help=\"--indelGapContinuationPenalty\" />\n        <param name=\"indelGapOpenPenalty\" type=\"float\" value=\"45.0\" label=\"Indel gap open penalty\" help=\"--indelGapOpenPenalty\" />\n        <param name=\"indelHaplotypeSize\" type=\"integer\" value=\"80\" label=\"Indel haplotype size\" help=\"--indelHaplotypeSize\" />\n        <param name=\"doContextDependentGapPenalties\" type=\"boolean\" truevalue=\"--doContextDependentGapPenalties\" falsevalue=\"\" label=\"Vary gap penalties by context\" help=\"--doContextDependentGapPenalties\" />\n        <param name=\"annotation\" type=\"select\" multiple=\"True\" display=\"checkboxes\" label=\"Annotation Types\" help=\"-A,--annotation &amp;lt;annotation&amp;gt;\">\n          <!-- load the available annotations from an external configuration file, since additional ones can be added to local installs -->\n          <options from_data_table=\"gatk_annotations\">\n            <filter type=\"multiple_splitter\" column=\"tools_valid_for\" separator=\",\"/>\n            <filter type=\"static_value\" value=\"UnifiedGenotyper\" column=\"tools_valid_for\"/>\n          </options>\n        </param>\n        <repeat name=\"additional_annotations\" title=\"Additional annotation\" help=\"-A,--annotation &amp;lt;annotation&amp;gt;\">\n          <param name=\"additional_annotation_name\" type=\"text\" value=\"\" label=\"Annotation name\" />\n        </repeat>\n<!--\n        <conditional name=\"snpEff_rod_bind_type\">\n          <param name=\"snpEff_rod_bind_type_selector\" type=\"select\" label=\"Provide a snpEff reference-ordered data file\">\n            <option value=\"set_snpEff\">Set snpEff</option>\n            <option value=\"exclude_snpEff\" selected=\"True\">Don't set snpEff</option>\n          </param>\n          <when value=\"exclude_snpEff\">\n          </when>\n          <when value=\"set_snpEff\">\n            <param name=\"snpEff_input_rod\" type=\"data\" format=\"vcf\" label=\"ROD file\" />\n            <param name=\"snpEff_rod_name\" type=\"hidden\" value=\"snpEff\" label=\"ROD Name\"/>\n          </when>\n        </conditional>\n-->\n        <param name=\"group\" type=\"select\" multiple=\"True\" display=\"checkboxes\" label=\"Annotation Interfaces/Groups\" help=\"-G,--group &amp;lt;group&amp;gt;\">\n            <option value=\"RodRequiringAnnotation\">RodRequiringAnnotation</option>\n            <option value=\"Standard\">Standard</option>\n            <option value=\"Experimental\">Experimental</option>\n            <option value=\"WorkInProgress\">WorkInProgress</option>\n            <option value=\"RankSumTest\">RankSumTest</option>\n            <!-- <option value=\"none\">none</option> -->\n        </param>\n    <!--     <param name=\"family_string\" type=\"text\" value=\"\" label=\"Family String\"/> -->\n        <param name=\"exclude_annotations\" type=\"select\" multiple=\"True\" display=\"checkboxes\" label=\"Annotations to exclude\" help=\"-XA,--excludeAnnotation &amp;lt;excludeAnnotation&amp;gt;\" >\n          <!-- load the available annotations from an external configuration file, since additional ones can be added to local installs -->\n          <options from_data_table=\"gatk_annotations\">\n            <filter type=\"multiple_splitter\" column=\"tools_valid_for\" separator=\",\"/>\n            <filter type=\"static_value\" value=\"UnifiedGenotyper\" column=\"tools_valid_for\"/>\n          </options>\n        </param>\n        <param name=\"multiallelic\" type=\"boolean\" truevalue=\"--multiallelic\" falsevalue=\"\" label=\"Allow the discovery of multiple alleles (SNPs only)\" help=\"--multiallelic\" />\n    </expand>\n  </inputs>\n  <outputs>\n    <data format=\"vcf\" name=\"output_vcf\" label=\"${tool.name} on ${on_string} (VCF)\" />\n    <data format=\"txt\" name=\"output_metrics\" label=\"${tool.name} on ${on_string} (metrics)\" />\n    <data format=\"txt\" name=\"output_log\" label=\"${tool.name} on ${on_string} (log)\" />\n  </outputs>\n  <trackster_conf/>\n  <tests>\n      <test>\n          <param name=\"reference_source_selector\" value=\"history\" />\n          <param name=\"ref_file\" value=\"phiX.fasta\" ftype=\"fasta\" />\n          <param name=\"input_bam\" value=\"gatk/gatk_table_recalibration/gatk_table_recalibration_out_1.bam\" ftype=\"bam\" />\n          <param name=\"rod_bind_type_selector\" value=\"dbsnp\" />\n          <param name=\"input_rod\" value=\"gatk/fake_phiX_variant_locations.vcf\" ftype=\"vcf\" />\n          <param name=\"standard_min_confidence_threshold_for_calling\" value=\"0\" />\n          <param name=\"standard_min_confidence_threshold_for_emitting\" value=\"4\" />\n          <param name=\"gatk_param_type_selector\" value=\"basic\" />\n          <param name=\"analysis_param_type_selector\" value=\"advanced\" />\n          <param name=\"genotype_likelihoods_model\" value=\"BOTH\" />\n          <param name=\"p_nonref_model\" value=\"EXACT\" />\n          <param name=\"heterozygosity\" value=\"0.001\" />\n          <param name=\"pcr_error_rate\" value=\"0.0001\" />\n          <param name=\"genotyping_mode\" value=\"DISCOVERY\" />\n          <param name=\"output_mode\" value=\"EMIT_ALL_CONFIDENT_SITES\" />\n          <param name=\"compute_SLOD\" />\n          <param name=\"min_base_quality_score\" value=\"17\" />\n          <param name=\"max_deletion_fraction\" value=\"-1\" />\n          <param name=\"min_indel_count_for_genotyping\" value=\"2\" />\n          <param name=\"indel_heterozygosity\" value=\"0.000125\" />\n          <param name=\"indelGapContinuationPenalty\" value=\"10\" />\n          <param name=\"indelGapOpenPenalty\" value=\"3\" />\n          <param name=\"indelHaplotypeSize\" value=\"80\" />\n          <param name=\"doContextDependentGapPenalties\" />\n          <!-- <param name=\"annotation\" value=\"\" />\n          <param name=\"group\" value=\"\" /> -->\n          <output name=\"output_vcf\" file=\"gatk/gatk_unified_genotyper/gatk_unified_genotyper_out_1.vcf\" lines_diff=\"4\" /> \n          <output name=\"output_metrics\" file=\"gatk/gatk_unified_genotyper/gatk_unified_genotyper_out_1.metrics\" /> \n          <output name=\"output_log\" file=\"gatk/gatk_unified_genotyper/gatk_unified_genotyper_out_1.log.contains\" compare=\"contains\" />\n      </test>\n  </tests>\n  <help>\n**What it does**\n\nA variant caller which unifies the approaches of several disparate callers.  Works for single-sample and multi-sample data.  The user can choose from several different incorporated calculation models.\n\nFor more information on the GATK Unified Genotyper, see this `tool specific page &lt;http://www.broadinstitute.org/gsa/wiki/index.php/Unified_genotyper&gt;`_.\n\nTo learn about best practices for variant detection using GATK, see this `overview &lt;http://www.broadinstitute.org/gsa/wiki/index.php/Best_Practice_Variant_Detection_with_the_GATK_v3&gt;`_.\n\nIf you encounter errors, please view the `GATK FAQ &lt;http://www.broadinstitute.org/gsa/wiki/index.php/Frequently_Asked_Questions&gt;`_.\n\n------\n\n**Inputs**\n\nGenomeAnalysisTK: UnifiedGenotyper accepts an aligned BAM input file.\n\n\n**Outputs**\n\nThe output is in VCF format.\n\n\nGo `here &lt;http://www.broadinstitute.org/gsa/wiki/index.php/Input_files_for_the_GATK&gt;`_ for details on GATK file formats.\n\n-------\n\n**Settings**::\n\n genotype_likelihoods_model                        Genotype likelihoods calculation model to employ -- BOTH is the default option, while INDEL is also available for calling indels and SNP is available for calling SNPs only (SNP|INDEL|BOTH)\n p_nonref_model                                    Non-reference probability calculation model to employ -- EXACT is the default option, while GRID_SEARCH is also available. (EXACT|GRID_SEARCH)\n heterozygosity                                    Heterozygosity value used to compute prior likelihoods for any locus\n pcr_error_rate                                    The PCR error rate to be used for computing fragment-based likelihoods\n genotyping_mode                                   Should we output confident genotypes (i.e. including ref calls) or just the variants? (DISCOVERY|GENOTYPE_GIVEN_ALLELES)\n output_mode                                       Should we output confident genotypes (i.e. including ref calls) or just the variants? (EMIT_VARIANTS_ONLY|EMIT_ALL_CONFIDENT_SITES|EMIT_ALL_SITES)\n standard_min_confidence_threshold_for_calling     The minimum phred-scaled confidence threshold at which variants not at 'trigger' track sites should be called\n standard_min_confidence_threshold_for_emitting    The minimum phred-scaled confidence threshold at which variants not at 'trigger' track sites should be emitted (and filtered if less than the calling threshold)\n noSLOD                                            If provided, we will not calculate the SLOD\n min_base_quality_score                            Minimum base quality required to consider a base for calling\n max_deletion_fraction                             Maximum fraction of reads with deletions spanning this locus for it to be callable [to disable, set to &lt; 0 or &gt; 1; default:0.05]\n min_indel_count_for_genotyping                    Minimum number of consensus indels required to trigger genotyping run\n indel_heterozygosity                              Heterozygosity for indel calling\n indelGapContinuationPenalty                       Indel gap continuation penalty\n indelGapOpenPenalty                               Indel gap open penalty\n indelHaplotypeSize                                Indel haplotype size\n doContextDependentGapPenalties                    Vary gap penalties by context\n indel_recal_file                                  Filename for the input covariates table recalibration .csv file - EXPERIMENTAL, DO NO USE\n indelDebug                                        Output indel debug info\n out                                               File to which variants should be written\n annotation                                        One or more specific annotations to apply to variant calls\n group                                             One or more classes/groups of annotations to apply to variant calls\n\n@CITATION_SECTION@\n  </help>\n</tool>\n```\n\ngatk_macros.xml:\n\n```xml\n<macros>\n  <template name=\"standard_gatk_options\">      \n    ##start standard gatk options\n    #if $gatk_param_type.gatk_param_type_selector == \"advanced\":\n        #for $pedigree in $gatk_param_type.pedigree:\n            -p '--pedigree \"${pedigree.pedigree_file}\"'\n        #end for\n        #for $pedigree_string in $gatk_param_type.pedigree_string_repeat:\n            -p '--pedigreeString \"${pedigree_string.pedigree_string}\"'\n        #end for\n        -p '--pedigreeValidationType \"${gatk_param_type.pedigree_validation_type}\"'\n        #for $read_filter in $gatk_param_type.read_filter:\n            -p '--read_filter \"${read_filter.read_filter_type.read_filter_type_selector}\"\n            ###raise Exception( str( dir( $read_filter ) ) )\n            #for $name, $param in $read_filter.read_filter_type.iteritems():\n                #if $name not in [ \"__current_case__\", \"read_filter_type_selector\" ]:\n                    #if hasattr( $param.input, 'truevalue' ):\n                        ${param}\n                    #else:\n                        --${name} \"${param}\"\n                    #end if\n                #end if\n            #end for\n            '\n        #end for\n        #for $interval_count, $input_intervals in enumerate( $gatk_param_type.input_interval_repeat ):\n            -d \"--intervals\" \"${input_intervals.input_intervals}\" \"${input_intervals.input_intervals.ext}\" \"input_intervals_${interval_count}\"\n        #end for\n        \n        #for $interval_count, $input_intervals in enumerate( $gatk_param_type.input_exclude_interval_repeat ):\n            -d \"--excludeIntervals\" \"${input_intervals.input_exclude_intervals}\" \"${input_intervals.input_exclude_intervals.ext}\" \"input_exlude_intervals_${interval_count}\"\n        #end for\n\n        -p '--interval_set_rule \"${gatk_param_type.interval_set_rule}\"'\n        \n        -p '--downsampling_type \"${gatk_param_type.downsampling_type.downsampling_type_selector}\"'\n        #if str( $gatk_param_type.downsampling_type.downsampling_type_selector ) != \"NONE\":\n            -p '--${gatk_param_type.downsampling_type.downsample_to_type.downsample_to_type_selector} \"${gatk_param_type.downsampling_type.downsample_to_type.downsample_to_value}\"'\n        #end if\n        -p '\n        --baq \"${gatk_param_type.baq}\"\n        --baqGapOpenPenalty \"${gatk_param_type.baq_gap_open_penalty}\"\n        ${gatk_param_type.use_original_qualities}\n        --defaultBaseQualities \"${gatk_param_type.default_base_qualities}\"\n        --validation_strictness \"${gatk_param_type.validation_strictness}\"\n        --interval_merging \"${gatk_param_type.interval_merging}\"\n        ${gatk_param_type.disable_experimental_low_memory_sharding}\n        ${gatk_param_type.non_deterministic_random_seed}\n        '\n        #for $rg_black_list_count, $rg_black_list in enumerate( $gatk_param_type.read_group_black_list_repeat ):\n            #if $rg_black_list.read_group_black_list_type.read_group_black_list_type_selector == \"file\":\n                -d \"--read_group_black_list\" \"${rg_black_list.read_group_black_list_type.read_group_black_list}\" \"txt\" \"input_read_group_black_list_${rg_black_list_count}\"\n            #else\n                -p '--read_group_black_list \"${rg_black_list.read_group_black_list_type.read_group_black_list}\"'\n            #end if\n        #end for\n    #end if\n    \n    #if str( $reference_source.reference_source_selector ) == \"history\":\n        -d \"-R\" \"${reference_source.ref_file}\" \"${reference_source.ref_file.ext}\" \"gatk_input\"\n    #end if\n    ##end standard gatk options\n  </template>\n  <xml name=\"gatk_param_type_conditional\">\n    <conditional name=\"gatk_param_type\">\n      <param name=\"gatk_param_type_selector\" type=\"select\" label=\"Basic or Advanced GATK options\">\n        <option value=\"basic\" selected=\"True\">Basic</option>\n        <option value=\"advanced\">Advanced</option>\n      </param>\n      <when value=\"basic\">\n        <!-- Do nothing here -->\n      </when>\n      <when value=\"advanced\">\n        <repeat name=\"pedigree\" title=\"Pedigree file\" help=\"-ped,--pedigree &amp;lt;pedigree&amp;gt;\">\n            <param name=\"pedigree_file\" type=\"data\" format=\"txt\" label=\"Pedigree files for samples\"/>\n        </repeat>\n        <repeat name=\"pedigree_string_repeat\" title=\"Pedigree string\" help=\"-pedString,--pedigreeString &amp;lt;pedigreeString&amp;gt;\">\n            <param name=\"pedigree_string\" type=\"text\" value=\"\" label=\"Pedigree string for samples\"/>\n        </repeat>\n        <param name=\"pedigree_validation_type\" type=\"select\" label=\"How strict should we be in validating the pedigree information\" help=\"-pedValidationType,--pedigreeValidationType &amp;lt;pedigreeValidationType&amp;gt;\">\n          <option value=\"STRICT\" selected=\"True\">STRICT</option>\n          <option value=\"SILENT\">SILENT</option>\n        </param>\n        <repeat name=\"read_filter\" title=\"Read Filter\" help=\"-rf,--read_filter &amp;lt;read_filter&amp;gt;\">\n            <conditional name=\"read_filter_type\">\n              <param name=\"read_filter_type_selector\" type=\"select\" label=\"Read Filter Type\">\n                <option value=\"BadCigar\">BadCigar</option>\n                <option value=\"BadMate\">BadMate</option>\n                <option value=\"DuplicateRead\">DuplicateRead</option>\n                <option value=\"FailsVendorQualityCheck\">FailsVendorQualityCheck</option>\n                <option value=\"MalformedRead\">MalformedRead</option>\n                <option value=\"MappingQuality\">MappingQuality</option>\n                <option value=\"MappingQualityUnavailable\">MappingQualityUnavailable</option>\n                <option value=\"MappingQualityZero\">MappingQualityZero</option>\n                <option value=\"MateSameStrand\">MateSameStrand</option>\n                <option value=\"MaxInsertSize\">MaxInsertSize</option>\n                <option value=\"MaxReadLength\" selected=\"True\">MaxReadLength</option>\n                <option value=\"MissingReadGroup\">MissingReadGroup</option>\n                <option value=\"NoOriginalQualityScores\">NoOriginalQualityScores</option>\n                <option value=\"NotPrimaryAlignment\">NotPrimaryAlignment</option>\n                <option value=\"Platform454\">Platform454</option>\n                <option value=\"Platform\">Platform</option>\n                <option value=\"PlatformUnit\">PlatformUnit</option>\n                <option value=\"ReadGroupBlackList\">ReadGroupBlackList</option>\n                <option value=\"ReadName\">ReadName</option>\n                <option value=\"ReadStrand\">ReadStrand</option>\n                <option value=\"ReassignMappingQuality\">ReassignMappingQuality</option>\n                <option value=\"Sample\">Sample</option>\n                <option value=\"SingleReadGroup\">SingleReadGroup</option>\n                <option value=\"UnmappedRead\">UnmappedRead</option>\n              </param>\n              <when value=\"BadCigar\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"BadMate\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"DuplicateRead\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"FailsVendorQualityCheck\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"MalformedRead\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"MappingQuality\">\n                  <param name=\"min_mapping_quality_score\" type=\"integer\" value=\"10\" label=\"Minimum read mapping quality required to consider a read for calling\"/>\n              </when>\n              <when value=\"MappingQualityUnavailable\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"MappingQualityZero\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"MateSameStrand\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"MaxInsertSize\">\n                  <param name=\"maxInsertSize\" type=\"integer\" value=\"1000000\" label=\"Discard reads with insert size greater than the specified value\"/>\n              </when>\n              <when value=\"MaxReadLength\">\n                  <param name=\"maxReadLength\" type=\"integer\" value=\"76\" label=\"Max Read Length\"/>\n              </when>\n              <when value=\"MissingReadGroup\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"NoOriginalQualityScores\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"NotPrimaryAlignment\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"Platform454\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"Platform\">\n                  <param name=\"PLFilterName\" type=\"text\" value=\"\" label=\"Discard reads with RG:PL attribute containing this string\"/>\n              </when>\n              <when value=\"PlatformUnit\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"ReadGroupBlackList\">\n                  <!-- no extra options -->\n              </when>\n              <when value=\"ReadName\">\n                  <param name=\"readName\" type=\"text\" value=\"\" label=\"Filter out all reads except those with this read name\"/>\n              </when>\n              <when value=\"ReadStrand\">\n                  <param name=\"filterPositive\" type=\"boolean\" truevalue=\"--filterPositive\" falsevalue=\"\" label=\"Discard reads on the forward strand\"/>\n              </when>\n              <when value=\"ReassignMappingQuality\">\n                  <param name=\"default_mapping_quality\" type=\"integer\" value=\"60\" label=\"Default read mapping quality to assign to all reads\"/>\n              </when>\n              <when value=\"Sample\">\n                  <param name=\"sample_to_keep\" type=\"text\" value=\"\" label=\"The name of the sample(s) to keep, filtering out all others\"/>\n              </when>\n              <when value=\"SingleReadGroup\">\n                  <param name=\"read_group_to_keep\" type=\"integer\" value=\"76\" label=\"The name of the read group to keep, filtering out all others\"/>\n              </when>\n              <when value=\"UnmappedRead\">\n                  <!-- no extra options -->\n              </when>\n            </conditional>\n        </repeat>\n        <repeat name=\"input_interval_repeat\" title=\"Operate on Genomic intervals\" help=\"-L,--intervals &amp;lt;intervals&amp;gt;\">\n          <param name=\"input_intervals\" type=\"data\" format=\"bed,gatk_interval,picard_interval_list,vcf\" label=\"Genomic intervals\" />\n        </repeat>\n        <repeat name=\"input_exclude_interval_repeat\" title=\"Exclude Genomic intervals\" help=\"-XL,--excludeIntervals &amp;lt;excludeIntervals&amp;gt;\">\n          <param name=\"input_exclude_intervals\" type=\"data\" format=\"bed,gatk_interval,picard_interval_list,vcf\" label=\"Genomic intervals\" />\n        </repeat>\n        \n        <param name=\"interval_set_rule\" type=\"select\" label=\"Interval set rule\" help=\"-isr,--interval_set_rule &amp;lt;interval_set_rule&amp;gt;\">\n          <option value=\"UNION\" selected=\"True\">UNION</option>\n          <option value=\"INTERSECTION\">INTERSECTION</option>\n        </param>\n        \n        <conditional name=\"downsampling_type\">\n          <param name=\"downsampling_type_selector\" type=\"select\" label=\"Type of reads downsampling to employ at a given locus\" help=\"-dt,--downsampling_type &amp;lt;downsampling_type&amp;gt;\">\n            <option value=\"NONE\" selected=\"True\">NONE</option>\n            <option value=\"ALL_READS\">ALL_READS</option>\n            <option value=\"BY_SAMPLE\">BY_SAMPLE</option>\n          </param>\n          <when value=\"NONE\">\n              <!-- no more options here -->\n          </when>\n          <when value=\"ALL_READS\">\n              <conditional name=\"downsample_to_type\">\n                  <param name=\"downsample_to_type_selector\" type=\"select\" label=\"Downsample method\">\n                      <option value=\"downsample_to_fraction\" selected=\"True\">Downsample by Fraction</option>\n                      <option value=\"downsample_to_coverage\">Downsample by Coverage</option>\n                  </param>\n                  <when value=\"downsample_to_fraction\">\n                      <param name=\"downsample_to_value\" type=\"float\" label=\"Fraction [0.0-1.0] of reads to downsample to\" value=\"1\" min=\"0\" max=\"1\" help=\"-dfrac,--downsample_to_fraction &amp;lt;downsample_to_fraction&amp;gt;\"/>\n                  </when>\n                  <when value=\"downsample_to_coverage\">\n                      <param name=\"downsample_to_value\" type=\"integer\" label=\"Coverage to downsample to at any given locus\" value=\"0\" help=\"-dcov,--downsample_to_coverage &amp;lt;downsample_to_coverage&amp;gt;\"/>\n                  </when>\n              </conditional>\n          </when>\n          <when value=\"BY_SAMPLE\">\n              <conditional name=\"downsample_to_type\">\n                  <param name=\"downsample_to_type_selector\" type=\"select\" label=\"Downsample method\">\n                      <option value=\"downsample_to_fraction\" selected=\"True\">Downsample by Fraction</option>\n                      <option value=\"downsample_to_coverage\">Downsample by Coverage</option>\n                  </param>\n                  <when value=\"downsample_to_fraction\">\n                      <param name=\"downsample_to_value\" type=\"float\" label=\"Fraction [0.0-1.0] of reads to downsample to\" value=\"1\" min=\"0\" max=\"1\" help=\"-dfrac,--downsample_to_fraction &amp;lt;downsample_to_fraction&amp;gt;\"/>\n                  </when>\n                  <when value=\"downsample_to_coverage\">\n                      <param name=\"downsample_to_value\" type=\"integer\" label=\"Coverage to downsample to at any given locus\" value=\"0\" help=\"-dcov,--downsample_to_coverage &amp;lt;downsample_to_coverage&amp;gt;\"/>\n                  </when>\n              </conditional>\n          </when>\n        </conditional>\n        <param name=\"baq\" type=\"select\" label=\"Type of BAQ calculation to apply in the engine\" help=\"-baq,--baq &amp;lt;baq&amp;gt;\">\n          <option value=\"OFF\" selected=\"True\">OFF</option>\n          <option value=\"CALCULATE_AS_NECESSARY\">CALCULATE_AS_NECESSARY</option>\n          <option value=\"RECALCULATE\">RECALCULATE</option>\n        </param>\n        <param name=\"baq_gap_open_penalty\" type=\"float\" label=\"BAQ gap open penalty (Phred Scaled)\" value=\"40\" help=\"Default value is 40. 30 is perhaps better for whole genome call sets. -baqGOP,--baqGapOpenPenalty &amp;lt;baqGapOpenPenalty&amp;gt;\" />\n        <param name=\"use_original_qualities\" type=\"boolean\" truevalue=\"--useOriginalQualities\" falsevalue=\"\" label=\"Use the original base quality scores from the OQ tag\" help=\"-OQ,--useOriginalQualities\" />\n        <param name=\"default_base_qualities\" type=\"integer\" label=\"Value to be used for all base quality scores, when some are missing\" value=\"-1\" help=\"-DBQ,--defaultBaseQualities &amp;lt;defaultBaseQualities&amp;gt;\"/>\n        <param name=\"validation_strictness\" type=\"select\" label=\"How strict should we be with validation\" help=\"-S,--validation_strictness &amp;lt;validation_strictness&amp;gt;\">\n          <option value=\"STRICT\" selected=\"True\">STRICT</option>\n          <option value=\"LENIENT\">LENIENT</option>\n          <option value=\"SILENT\">SILENT</option>\n          <!-- <option value=\"DEFAULT_STRINGENCY\">DEFAULT_STRINGENCY</option> listed in docs, but not valid value...-->\n        </param>\n        <param name=\"interval_merging\" type=\"select\" label=\"Interval merging rule\" help=\"-im,--interval_merging &amp;lt;interval_merging&amp;gt;\">\n          <option value=\"ALL\" selected=\"True\">ALL</option>\n          <option value=\"OVERLAPPING_ONLY\">OVERLAPPING_ONLY</option>\n        </param>\n        \n        <repeat name=\"read_group_black_list_repeat\" title=\"Read group black list\" help=\"-rgbl,--read_group_black_list &amp;lt;read_group_black_list&amp;gt;\">\n          <conditional name=\"read_group_black_list_type\">\n            <param name=\"read_group_black_list_type_selector\" type=\"select\" label=\"Type of reads read group black list\">\n              <option value=\"file\" selected=\"True\">Filters in file</option>\n              <option value=\"text\">Specify filters as a string</option>\n            </param>\n            <when value=\"file\">\n              <param name=\"read_group_black_list\" type=\"data\" format=\"txt\" label=\"Read group black list file\" />\n            </when>\n            <when value=\"text\">\n              <param name=\"read_group_black_list\" type=\"text\" value=\"tag:string\" label=\"Read group black list tag:string\" />\n            </when>\n          </conditional>\n        </repeat>\n        \n        <param name=\"disable_experimental_low_memory_sharding\" type=\"boolean\" truevalue=\"--disable_experimental_low_memory_sharding\" falsevalue=\"\" label=\"Disable experimental low-memory sharding functionality.\" checked=\"False\" help=\"--disable_experimental_low_memory_sharding\"/>\n        <param name=\"non_deterministic_random_seed\" type=\"boolean\" truevalue=\"--nonDeterministicRandomSeed\" falsevalue=\"\" label=\"Makes the GATK behave non deterministically, that is, the random numbers generated will be different in every run\" checked=\"False\"  help=\"-ndrs,--nonDeterministicRandomSeed\"/>\n        \n      </when>\n    </conditional>    \n  </xml>\n  <xml name=\"analysis_type_conditional\">\n    <conditional name=\"analysis_param_type\">\n      <param name=\"analysis_param_type_selector\" type=\"select\" label=\"Basic or Advanced Analysis options\">\n        <option value=\"basic\" selected=\"True\">Basic</option>\n        <option value=\"advanced\">Advanced</option>\n      </param>\n      <when value=\"basic\">\n        <!-- Do nothing here -->\n      </when>\n      <when value=\"advanced\">\n        <yield />\n      </when>\n    </conditional>\n  </xml>\n  <xml name=\"reference_source_selector_param\">\n    <param name=\"reference_source_selector\" type=\"select\" label=\"Choose the source for the reference list\">\n      <option value=\"cached\">Locally cached</option>\n      <option value=\"history\">History</option>\n    </param>\n  </xml>\n  <token name=\"@CITATION_SECTION@\">------\n\n**Citation**\n\nFor the underlying tool, please cite `DePristo MA, Banks E, Poplin R, Garimella KV, Maguire JR, Hartl C, Philippakis AA, del Angel G, Rivas MA, Hanna M, McKenna A, Fennell TJ, Kernytsky AM, Sivachenko AY, Cibulskis K, Gabriel SB, Altshuler D, Daly MJ. A framework for variation discovery and genotyping using next-generation DNA sequencing data. Nat Genet. 2011 May;43(5):491-8. &lt;http://www.ncbi.nlm.nih.gov/pubmed/21478889&gt;`_\n\nIf you use this tool in Galaxy, please cite Blankenberg D, et al. *In preparation.*\n\n  </token>\n</macros>\n```\n\nExercises:\nCan you use Macros to simplify the inclusion of common tool content between the various phases of the Hello World examples?\n\n16:45 - 17:00\n-------------\n\nOpen questions and Free play.\n\nSome suggestions for exploration (http://wiki.galaxyproject.org/Admin/Tools/ToolConfigSyntax):\n\n* Config files\n* Validators\n* Defining Datatypes and Metadata\n  * Composite Datatypes\n* Parameter sanitizers\n* Advanced Data source tool configuration\n* Dynamic Select parameters\n* Customizing output attributes\n  * Labels\n  * output `<actions>` (e.g. see tools/filters/cutWrapper.xml)\n\n17:00 session ends\n------------------\n\n<slot name=\"/events/gcc2013/footer\" />\n"}},"context":{}}