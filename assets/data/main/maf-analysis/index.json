{"hash":"c32ecfdb33b075b0057598b5b9118f3554a398cf","data":{"article":{"id":"b92eb3676786dbaae083810e773d09ee","title":"Galaxy tools for the analysis of multiple alignments","tease":"","image":"","images":{},"category":null,"contact":"","date":null,"content":"<h1 id=\"galaxy-tools-for-the-analysis-of-multiple-alignments\"><a href=\"#galaxy-tools-for-the-analysis-of-multiple-alignments\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Galaxy tools for the analysis of multiple alignments</h1>\n<p>For the latest information on the MAF tool suite please see: <a href=\"http://usegalaxy.org/u/dan/p/maf\" target=\"_blank\" rel=\"noopener noreferrer\">http://usegalaxy.org/u/dan/p/maf</a></p>\n<p>If you use these tools in your research, please cite:\nBlankenberg D, Taylor J, Nekrutenko A, The Galaxy Team. \"<a href=\"http://www.ncbi.nlm.nih.gov/pubmed/21775304\" target=\"_blank\" rel=\"noopener noreferrer\">Making whole genome multiple alignments usable for biologists</a>.\" <em>Bioinformatics</em>. 2011 Jul 19.</p>\n<h2 id=\"about-the-alignments\"><a href=\"#about-the-alignments\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>About the Alignments</h2>\n<h2 id=\"whole-genome-alignments-even-those-produced-by-quasi-global-algorithms-are-inevitably-fragmented-owing-to-the-complex-evolutionary-history-of-genomic-dna-and-karyotypes-which-involves-duplications-deletions-insertions-and-other-rearrangements-these-alignments-also-tend-to-be-extremely-large--to-allow-biologists-to-easily-and-efficiently-manipulate-multiple-species-whole-genome-alignments-they-are-stored-locally-at-the-galaxy-site-in-a-compressed-form-and-indexed--the-majority-of-alignments-are-produced-using-penn-states-multiz-for-more-information-on-multiz-click-here-aligner-run-on-the-computational-facilities-of-the-uc-santa-cruz-genome-biology-group-led-by-jim-kent--tools-for-handling-multiple-alignments-described-here-are-written-by-dan-blankenberg-and-based-on-the-bx-python-package-developed-by-james-taylor\"><a href=\"#whole-genome-alignments-even-those-produced-by-quasi-global-algorithms-are-inevitably-fragmented-owing-to-the-complex-evolutionary-history-of-genomic-dna-and-karyotypes-which-involves-duplications-deletions-insertions-and-other-rearrangements-these-alignments-also-tend-to-be-extremely-large--to-allow-biologists-to-easily-and-efficiently-manipulate-multiple-species-whole-genome-alignments-they-are-stored-locally-at-the-galaxy-site-in-a-compressed-form-and-indexed--the-majority-of-alignments-are-produced-using-penn-states-multiz-for-more-information-on-multiz-click-here-aligner-run-on-the-computational-facilities-of-the-uc-santa-cruz-genome-biology-group-led-by-jim-kent--tools-for-handling-multiple-alignments-described-here-are-written-by-dan-blankenberg-and-based-on-the-bx-python-package-developed-by-james-taylor\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Whole genome alignments, even those produced by \"<em>quasi-global</em>\" algorithms, are inevitably fragmented owing to the complex evolutionary history of genomic DNA and karyotypes, which involves duplications, deletions, insertions and other rearrangements. These alignments also tend to be extremely large.  To allow biologists to easily and efficiently manipulate multiple species whole genome alignments, they are stored locally at the Galaxy site, in a compressed form, and indexed.  The majority of alignments are produced using Penn State's <a href=\"http://www.bx.psu.edu/miller_lab/\" target=\"_blank\" rel=\"noopener noreferrer\">multiZ</a> (for more information on multiZ <a href=\"http://bio.cse.psu.edu/dist/tba.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">click here</a>) aligner run on the computational facilities of <a href=\"http://genome.ucsc.edu/\" target=\"_blank\" rel=\"noopener noreferrer\">The UC Santa Cruz Genome Biology Group</a> led by Jim Kent.  Tools for handling multiple alignments described here are written by Dan Blankenberg and based on the <a href=\"http://bx-python.trac.bx.psu.edu/\" target=\"_blank\" rel=\"noopener noreferrer\">bx-python</a> package developed by James Taylor.</h2>\n<h2 id=\"tools-and-categories\"><a href=\"#tools-and-categories\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Tools and Categories</h2>\n<p>[Format Converters](/src/main/MAF Analysis/index.md#format-converters)</p>\n<p>[Alignment Extractors](/src/main/MAF Analysis/index.md#alignment-extractors)</p>\n<p>[Alignment Stitchers](/src/main/MAF Analysis/index.md#alignment-stitchers)</p>\n<h2 id=\"filters-and-utilitiessrcmainmaf-analysisindexmdfilters-and-utilities\"><a href=\"#filters-and-utilitiessrcmainmaf-analysisindexmdfilters-and-utilities\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>[Filters and Utilities](/src/main/MAF Analysis/index.md#filters-and-utilities)</h2>\n<h2 id=\"for-a-list-of-data-available-through-galaxy-see-available-datasrcmaindata-librariesavailable-dataindexmd\"><a href=\"#for-a-list-of-data-available-through-galaxy-see-available-datasrcmaindata-librariesavailable-dataindexmd\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>For a list of data available through Galaxy, see [Available Data](/src/main/data-libraries/Available Data/index.md).</h2>\n<h2 id=\"format-converters\"><a href=\"#format-converters\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Format Converters</h2>\n<p>These tools convert MAF formatted files to FASTA and offer the ability to restrict alignments to a subset of species. This is useful for performing further analysis with practically all currently available genomic tools.</p>\n<p>Available Output Types:</p>\n<ul>\n<li><strong>Multiple Blocks</strong> - create one FASTA alignment block per provided MAF Block; blocks missing a desired species can be kept or discarded</li>\n<li><strong>One Sequence per Species</strong> - create one sequence per species, where all MAF blocks are concatenated in the order and strand in which they appear in the selected source MAF; desired species missing from a particular block will have their sequence padded with gaps</li>\n</ul>\n<h2 id=\"\"><img src=\"/src/main/maf-analysis/maf_to_fasta.png\"></h2>\n<h2 id=\"alignment-extractors\"><a href=\"#alignment-extractors\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Alignment Extractors</h2>\n<p>Extractors take genomic intervals as the input and return pairwise or multiple alignments corresponding to these intervals as illustrated below. Users can use locally stored ([cached](/src/main/data-libraries/Available Data/index.md)) alignments, or alignments from their history as the MAF source.  Here, three MAF blocks overlapping a single interval are extracted.  MAF blocks are output relative to the strand of the provided interval, where the default is '+'.  Blocks 1 and 3 are trimmed because they extend beyond the boundaries of the interval:</p>\n<p><img src=\"/src/main/maf-analysis/interval2maf.png\"></p>\n<p><em>Currently there are two types of extractors that may be merged into a single tool in the future:</em></p>\n<ul>\n<li><strong>Extract Pairwise MAF blocks given a set of genomic intervals</strong> - takes a series of genomic intervals and extracts <strong>pairwise</strong> alignments from a large selection of locally cached MAF files.</li>\n<li><strong>Extract MAF blocks given a set of genomic intervals</strong> - takes a series of genomic intervals and extracts <strong>multiple</strong> alignments from a large selection of locally cached MAF files or from alignments in the user's history.</li>\n</ul>\n<hr>\n<h2 id=\"alignment-stitchers\"><a href=\"#alignment-stitchers\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Alignment Stitchers</h2>\n<p>Multiple genome alignments consist of a very large number of relatively short blocks. This is why extractors (described in the previous category) typically return multiple MAF blocks per interval. In many cases, however, it is desirable to join (stitch) these multiple alignments together into a single continuous one.  This is the purpose of this category of tools. The figure below shows a genomic interval overlapping four blocks.  Stitching these together returns a single alignment (in FASTA format) where the void between blocks (2,3) and blocks (3,4) is filled with gaps:</p>\n<p><img src=\"/src/main/maf-analysis/maf_stitch.png\"></p>\n<p><em>Currently there are two tools that perform this operation each able to use cached or user-supplied alignments:</em></p>\n<ul>\n<li><strong>Stitch MAF blocks given a set of genomic intervals</strong> - creates one FASTA alignment block for each supplied interval</li>\n<li><strong>Stitch Gene blocks given a set of coding exon intervals</strong> - creates one FASTA alignment block for each supplied gene (requires a gene (12 column) BED file), where each exon interval is processed as above, and then concatenated together</li>\n</ul>\n<h2 id=\"the-fasta-output-is-relative-to-the-genome-of-the-input-interval-positions-that-do-not-exist-in-this-genome-are-not-included-overlapping-blocks-are-split-at-the-edges-of-their-intersections-and-the-block-fragment-with-the-highest-original-score-is-used-users-can-also-select-which-species-to-include-in-their-output\"><a href=\"#the-fasta-output-is-relative-to-the-genome-of-the-input-interval-positions-that-do-not-exist-in-this-genome-are-not-included-overlapping-blocks-are-split-at-the-edges-of-their-intersections-and-the-block-fragment-with-the-highest-original-score-is-used-users-can-also-select-which-species-to-include-in-their-output\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>The FASTA output is relative to the genome of the input interval; positions that do not exist in this genome are not included. Overlapping blocks are split at the edges of their intersections, and the block fragment with the highest original score is used. Users can also select which species to include in their output.</h2>\n<h2 id=\"filters-and-utilities\"><a href=\"#filters-and-utilities\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Filters and Utilities</h2>\n<ul>\n<li>\n<p><strong>MAF coverage statistics</strong> - computes the coverage of a genomic interval by a specified alignment; if a column does not exist in the reference genome, it is not included in the output.</p>\n<p>Consider the interval: \"chrX 1000 1100 myInterval\"\nLet's suppose we want to do stats on three way alignments for H, M, and R. The result look like this:</p>\n<p>  chrX 1000 1100 myInterval H XXX YYY </p>\n<p>  chrX 1000 1100 myInterval M XXX YYY </p>\n<p>  chrX 1000 1100 myInterval R XXX YYY </p>\n<p>   where XXX and YYY are:</p>\n<pre><code>  XXX = number of nucleotides\n\n  YYY = number of gaps\n</code></pre>\n<p>Alternatively, you can request only summary information for a set of intervals:</p>\n</li>\n</ul>\n<table>\n  <tr>\n    <td> #species </td>\n    <td> nucleotides </td>\n    <td> coverage</td>\n  </tr>\n  <tr>\n    <td> hg18      </td>\n    <td> 30639    </td>\n    <td> 0.2372</td>\n  </tr>\n  <tr>\n    <td> rheMac2   </td>\n    <td> 7524     </td>\n    <td> 0.0582</td>\n  </tr>\n  <tr>\n    <td> panTro2   </td>\n    <td> 30390    </td>\n    <td> 0.2353</td>\n  </tr>\n</table>\n<pre><code> where **coverage** is the number of nucleotides divided by the total length of the provided intervals.\n</code></pre>\n<ul>\n<li><strong>Filter MAF blocks by Species</strong> - restricts alignments to a subset of species</li>\n</ul>\n<p><img src=\"/src/main/maf-analysis/filter_by_species.png\"></p>\n<p>  Users can choose to keep or discard (1) blocks which are missing a desired species and (2) blocks which contain only one species.</p>\n<ul>\n<li><strong>Filter MAF blocks by Size</strong> - restricts alignments to a specified size range</li>\n</ul>\n<p><img src=\"/src/main/maf-analysis/maf_filter_by_size.png\"></p>\n<ul>\n<li><strong>Join MAF blocks by Species</strong> - Merges MAF blocks which are adjoining in each specified species from a MAF file. Columns which contain only gaps are removed. Species which are not desired are removed from the output.</li>\n</ul>\n<p><img src=\"/src/main/maf-analysis/join_by_species.png\"></p>\n<ul>\n<li><strong>Extract MAF by block number</strong> - extracts specific MAF blocks by their number in the dataset; block indexes start at 0</li>\n</ul>\n<p><img src=\"/src/main/maf-analysis/maf_by_block_number.png\"></p>\n<ul>\n<li><strong>Reverse complement a MAF file</strong> - computes the reverse complement for all blocks in an alignment</li>\n</ul>\n<p>This MAF Block:\n<code>a score=8157.000000 s hg17.chr7 127471526 58 + 158628139 AATTTGTGGTTTATTCATTTTTCATTATTTTGTTTAAGGAGGTCTATAGTGGAAGAGG s panTro1.chr6 129885407 58 + 161576975 AATTTGTGGTTTATTCGTTTTTCATTATTTTGTTTAAGGAGGTCTATAGTGGAAGAGG s mm5.chr6 28904928 54 + 149721531 AA----CGTTTCATTGATTGCTCATCATTTAAAAAAAGAAATTCCTCAGTGGAAGAGG</code></p>\n<p>becomes:\n<code>a score=8157.000000 s hg17.chr7 31156555 58 - 158628139 CCTCTTCCACTATAGACCTCCTTAAACAAAATAATGAAAAATGAATAAACCACAAATT s panTro1.chr6 31691510 58 - 161576975 CCTCTTCCACTATAGACCTCCTTAAACAAAATAATGAAAAACGAATAAACCACAAATT s mm5.chr6 120816549 54 - 149721531 CCTCTTCCACTGAGGAATTTCTTTTTTTAAATGATGAGCAATCAATGAAACG----TT</code></p>\n"}},"context":{}}