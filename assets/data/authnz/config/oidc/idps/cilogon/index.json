{"hash":"c32ecfdb33b075b0057598b5b9118f3554a398cf","data":{"article":{"id":"5600f7106d95acc11a64ee6ef0c33603","title":"Configure Your Galaxy Instance as a CILogon OIDC Client","tease":"","image":"","images":{},"category":null,"contact":"","date":null,"content":"<p><em>This page explains how to configure this feature, for user-specific docs, please refer to <a href=\"/src/authnz/use/oidc/idps/cilogon/index.md\">this</a> page.</em></p>\n<p>Leveraging OpenID Connect (OIDC) protocol, users can login to Galaxy with their\nexsiting insitutional login credentials by using <a href=\"https://www.cilogon.org/oidc\" target=\"_blank\" rel=\"noopener noreferrer\">CILogon</a>,\nwithout having to (explicitly) create a Galaxy user account. To\nenable this feature on your Galaxy instance, you would need to first register\nyou a client on the CILogon portal and await approval of your client, then\nuse your registration information to configure Galaxy. These steps are described\nin details in the following sections.</p>\n<h1 id=\"client-registration\"><a href=\"#client-registration\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Client Registration</h1>\n<p>Take the following steps in order to register a client with CILogon on its OAuth2.0 authorization server:</p>\n<p>Visit the <a href=\"https://cilogon.org/oauth2/register\" target=\"_blank\" rel=\"noopener noreferrer\">CILogon OIDC/OAuth 2.0 Client Registration page</a>\nand fill out the form with the appropriate information according to\nyour Galaxy instance:</p>\n<ol>\n<li>The <em>Home URL</em> should be the main address that users will use to get to your instance of Galaxy.</li>\n<li>\n<p>For the <em>Callback URLs</em> field, you need to enter\nyour instanceâ€™s OIDC redirect URI, which is in the following template:</p>\n<pre><code>&#x3C;Host URI>/authnz/cilogon/callback\n</code></pre>\n<p>For instance:</p>\n<pre><code>http://localhost:8080/authnz/cilogon/callback\n</code></pre>\n<p>See <a href=\"/src/authnz/config/oidc/index.md#redirect-uri\">this section</a> for details.</p>\n</li>\n<li>After filling out the form, hit <em>Register Client</em> and wait for approval from the CILogon team.\nUpon approval, the notification email will include your OAuth <code>Client ID</code> and <code>Client Secret</code>;\nnote this info! You will need it for the Galaxy configuration.</li>\n</ol>\n<h1 id=\"galaxy-configuration\"><a href=\"#galaxy-configuration\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Galaxy Configuration</h1>\n<p>You would need to setup you Galaxy instance to leverage OIDC protocol.\nThis setup is common for all OIDC IdPs, and is\n<a href=\"/src/authnz/config/oidc/index.md#configure-oidc-backends\">documented at this page</a>.\nThen you would need to add CILogon-specific setters to the <code>config/oidc_backends_config.xml</code> file as in the following. Note that the <strong>redirect_uri</strong> must have been included in the list of callback URLs during your CILogon client registration:</p>\n<pre><code class=\"language-xml\">&#x3C;?xml version=\"1.0\"?>\n&#x3C;OIDC>\n    &#x3C;provider name=\"CILogon\">\n        &#x3C;url>https://cilogon.org/authorize&#x3C;/url>\n        &#x3C;client_id> ... &#x3C;/client_id>\n        &#x3C;client_secret> ... &#x3C;/client_secret>\n        &#x3C;redirect_uri>http://localhost:8080/authnz/cilogon/callback&#x3C;/redirect_uri>\n        &#x3C;realm>master&#x3C;/realm>\n    &#x3C;/provider>\n&#x3C;/OIDC>\n</code></pre>\n<p>See <a href=\"/src/authnz/config/oidc/index.md#supported-oidc-idps\">this section</a>\nfor more details.</p>\n<p>Having set this configuration, restart Galaxy to have the option to login to\nGalaxy using CILogon by selecting your institution from the list and entering the login credentials.</p>\n<p><img src=\"/src/authnz/config/oidc/idps/cilogon/cilogon-login-list.png\" alt=\"image\"></p>\n"}},"context":{}}