{"hash":"c32ecfdb33b075b0057598b5b9118f3554a398cf","data":{"article":{"id":"491fb1504491960753e0df22d613b498","title":"Login to Galaxy Using Your Organization's Okta identity","tease":"","image":"","images":{},"category":null,"contact":"","date":null,"content":"<p><em>This page explains how to use this feature, for admin-specific docs, please refer to <a href=\"/src/authnz/config/oidc/idps/okta/index.md\">this</a> page.</em></p>\n<p>You can login to a Galaxy instance (if this feature is enabled on that instance) using your organization's Okta identity.\nYou may use this feature if: </p>\n<ul>\n<li>you do not have a Galaxy user account, and instead of creating one, you may want to login to Galaxy\nusing your organization's Okta login;</li>\n<li>you do have a Galaxy user account, and want to associate that account with your organization's Okta identity,\nhence you would be able to login to Galaxy either using you Galaxy username and password, or\nyour organization's Okta credentials.</li>\n</ul>\n<p>Galaxy offers two method for login: via <a href=\"#login-via-user-interface\">UI</a>, or <a href=\"#login-programmatically\">programmatically</a>. </p>\n<h2 id=\"login-via-user-interface\"><a href=\"#login-via-user-interface\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Login via User Interface</h2>\n<p>In order to login to Galaxy using your organization's Okta identity, take the following steps:</p>\n<ol>\n<li>\n<p>Click on the <strong>Login or Register</strong> button:</p>\n<p><img src=\"/src/authnz/use/oidc/idps/okta/01.png\" alt=\"image\"></p>\n</li>\n<li>\n<p>Click on the <strong>Okta</strong> button:</p>\n<p><img src=\"/src/authnz/use/oidc/idps/okta/02.png\" alt=\"image\"></p>\n<div class=\"alert alert-info\" role=\"alert\">\n    **NOTE:**\n    \n    If this button is not displayed, then either OIDC is not enabled on the instance of \n    Galaxy you are using, or its Okta backend is not configured, regardless you \n    would need to contact the admin of that Galaxy instance.\n</div>\n</li>\n<li>Clicking on the <strong>Okta</strong> button will take you to your organization's Okta login page,\nwhere you would need to login with your organization's Okta associated credentials, such as your active directory account:</li>\n<li>Having completed login through your organization's Okta service, you  will be redirected back to\nGalaxy, and you will be logged in to Galaxy with your organization's Okta identity.</li>\n</ol>\n<h2 id=\"login-programmatically\"><a href=\"#login-programmatically\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Login Programmatically</h2>\n<p>You can login to Galaxy using your organization's Okta credentials by directly interacting with Galaxy's\n<a href=\"https://github.com/galaxyproject/galaxy/blob/eba0eb6f0865679c09e9896c410957bc6cb2927a/lib/galaxy/webapps/galaxy/controllers/authnz.py#L17\" target=\"_blank\" rel=\"noopener noreferrer\"><code>authnz</code> controller</a>.\nTo do so, you may take the following steps:</p>\n<ol>\n<li>\n<p>Type the following address in your browser, after replacing <code>[Base URI]</code> with the URI of your Galaxy instance:</p>\n<pre><code>[Base URI]/authnz/okta/login\n</code></pre>\n<p>In other words, send an HTTP <a href=\"https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3\" target=\"_blank\" rel=\"noopener noreferrer\"><code>GET</code></a> request to the\naforementioned URI.</p>\n</li>\n<li>\n<p>In response, Galaxy returns a JSON object containing <code>redirect_uri</code>, which is a URL to your organization's Okta\nauthorization endpoint with all the information required to identifying your Galaxy instance. For instance:</p>\n<pre><code>```json\n{\n   \"redirect_uri\": \"https://organization.okta.com/o/oauth2/auth?nonce= ... &#x26;state= ... &#x26;redirect_uri=http://localhost:8080/authnz/okta/callback&#x26;prompt=consent&#x26;response_type=code&#x26;client_id= ... organization.okta.com&#x26;scope=openid+email&#x26;access_type=offline\",\n}\n```\n\nCopy this URI and pasted it in your browsers's address bar; or in other words, send a `GET` request to this URL.\n</code></pre>\n</li>\n<li>You would then see your organization's Okta login page, and having successfully signed in, and Okta will callback Galaxy with\nyour authentication information, which Galaxy uses to log you in.  </li>\n</ol>\n<h2 id=\"what-happens-behind-the-scenes-when-i-login-to-galaxy-using-my-organizations-okta-identity\"><a href=\"#what-happens-behind-the-scenes-when-i-login-to-galaxy-using-my-organizations-okta-identity\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>What happens behind-the-scenes when I login to Galaxy using my organization's Okta identity?</h2>\n<p>In nutshell, Galaxy receives basic information about you from the Okta service (e.g., email\naddress) and some OIDC security tokens such as <a href=\"http://openid.net/specs/openid-connect-core-1_0.html#IDToken\" target=\"_blank\" rel=\"noopener noreferrer\">ID token</a>\nand <a href=\"https://www.oauth.com/oauth2-servers/access-tokens/\" target=\"_blank\" rel=\"noopener noreferrer\">Access token</a>. Galaxy stores these\ninformation, and then it automatically creates a Galaxy user with its username and email set to\nthe information provided by Okta (if you do not have a Galaxy user account).</p>\n<div class=\"alert alert-info\" role=\"alert\">\n    **Note:**\n    Neither your _email address_ and _basic profile info_, nor the OIDC tokens that Okta \n    sends to Galaxy, grants Galaxy with access to any other services tied to your organization's Okta \n    identity.\n</div> \n<h2 id=\"how-to-disconnect-my-organizations-okta-account-from-galaxy\"><a href=\"#how-to-disconnect-my-organizations-okta-account-from-galaxy\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>How to disconnect my organization's Okta account from Galaxy?</h2>\n<p>When you're logged into Galaxy using your Okta identity, visit the following page:</p>\n<pre><code>[Base URI]/authnz/okta/disconnect\n</code></pre>\n<p>where <code>[Base URI]</code> is the URL from which the Galaxy instance you're using is accessible. For instance:</p>\n<pre><code>http://localhost:8080/authnz/okta/disconnect\n</code></pre>\n<p>The disconnect process will remove all your organization's Okta provided tokens from Galaxy's database, but\nwill keep your Galaxy user account active (this user is registered automatically with your email address).</p>\n<h2 id=\"how-to-revoke-the-oidc-tokens-shared-with-galaxy-also-from-your-organizations-okta-service\"><a href=\"#how-to-revoke-the-oidc-tokens-shared-with-galaxy-also-from-your-organizations-okta-service\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>How to revoke the OIDC tokens shared with Galaxy also from your organization's Okta service?</h2>\n<p>These tokens are used to validate your identity for the first time, and re-validate when the\ntokens are expired. You can revoke these tokens (a complementary step to\nthe disconnect process), which will (a) invalidate the tokens stored in Galaxy's database,\nand (b) will prevent Galaxy from being able to refresh expired tokens. </p>\n<p>This is not yet supported in a self-service manner for your organization's Okta service,\nplease contact your organization's Okta specialist if you wish to have your tokens revoked.</p>\n<div class=\"alert alert-info\" role=\"alert\">\n    **Note:**\n    \n    Your Galaxy account is independent from your third-party identity (e.g., Okta). \n    Therefore, regardless of disconnecting your third-party identity or revoking Galaxy's \n    OIDC-based access to your account, your Galaxy account stays active. The only tie this \n    account has to your third-party identity after the disconnect and access revoke, is\n    your email address. To delete this, you need to delete your Galaxy user.\n</div>\n \n"}},"context":{}}