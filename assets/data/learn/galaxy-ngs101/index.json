{"hash":"14e186fd360947c1255e65c919a062692f477385","data":{"article":{"id":"7eae5d1a88652812327ae1dca662e854","title":"Galaxy NGS 101","tease":"","image":"","images":{},"category":null,"contact":"","date":null,"content":"<p>This page is designed to serve as a comprehensive resource describing manipulation and analysis of NGS data. While it is designed to highlight the utility of Galaxy it will also provide information that is broadly applicable and can be used for teaching of big data biology. It is accompanied by a collection of <a href=\"https://vimeo.com/channels/884356\" target=\"_blank\" rel=\"noopener noreferrer\">screencasts</a>.</p>\n<div class=\"img-sizer\" style=\"height: 200px\">\n<p><img src=\"/images/ngs101/EncodeNatureGraphic.png\" alt=\"DifferentNGSTechniques\"></p>\n</div>\n<h2 id=\"overview-of-ngs-technologies\"><a href=\"#overview-of-ngs-technologies\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Overview of NGS technologies</h2>\n<p>This section contains quick explanations and important references for major sequencing technologies used today. It is regularly refreshed and kept up-to-date.</p>\n<img src=\"/images/ngs101/454.jpeg\" alt=\"454\" height=\"20\" />\n<a href='https://vimeo.com/121286060'><img src=\"/images/ngs101/video.png\" alt=\"454 Screencast\" height=\"20\" /></a> \n<a href='https://depot.galaxyproject.org/hub/attachments/documents/presentations/NGS101-454.pdf'><img src=\"/images/ngs101/pdf.png\" alt=\"Slides\" height=\"20\" /></a>\n<p><strong>Publications:</strong></p>\n<ul>\n<li><a href=\"http://www.nature.com/nature/journal/v437/n7057/pdf/nature03959.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Description of 454 process - Margulies et al. (2005)</a></li>\n<li><a href=\"http://genome.cshlp.org/content/11/1/3\" target=\"_blank\" rel=\"noopener noreferrer\">Overview of pyrosequencing methodology - Ronaghi (2001)</a></li>\n<li><a href=\"http://link.springer.com/protocol/10.1385/1-59745-377-3:1\" target=\"_blank\" rel=\"noopener noreferrer\">History of pyrosequencing - Pål Nyrén (2007)</a></li>\n<li><a href=\"http://bioinformatics.oxfordjournals.org/content/26/18/i420.full.pdf+html\" target=\"_blank\" rel=\"noopener noreferrer\">Properties of 454 data - Balzer et al. (2010)</a></li>\n<li><a href=\"http://genomebiology.com/content/pdf/gb-2007-8-7-r143.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Errors in 454 data - Huse et al. (2007)</a></li>\n</ul>\n<img src=\"/images/ngs101/illumina.png\" alt=\"Illumina\" height=\"20\" />\n<a href='https://vimeo.com/121178846'><img src=\"/images/ngs101/video.png\" alt=\"Illumina Screencast\" height=\"20\" /></a> \n<a href='https://depot.galaxyproject.org/hub/attachments/documents/presentations/NGS101-Illumina.pdf'><img src=\"/images/ngs101/pdf.png\" alt=\"Slides\" height=\"20\" /></a>\n<p><strong>Publications:</strong></p>\n<ul>\n<li><a href=\"http://www.nature.com/nature/journal/v456/n7218/pdf/nature07517.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Human genome sequencing on Illumina - Bentley et al. (2008)</a></li>\n<li><a href=\"http://www.biomedcentral.com/content/pdf/1471-2164-12-382.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Illumina pitfalls - Kircher et al. (2011)</a></li>\n<li><a href=\"http://genomebiology.com/content/pdf/gb-2011-12-11-r112.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Data quality 1 - Minoche et al. (2011)</a></li>\n<li><a href=\"http://nar.oxfordjournals.org/content/39/13/e90.full-text-lowres.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Data quality 2 - Nakamura et al. (2010)</a></li>\n</ul>\n<img src=\"/images/ngs101/ion.jpeg\" alt=\"Ion\" height=\"20\" />\n<a href='https://vimeo.com/121289100'><img src=\"/images/ngs101/video.png\" alt=\"IonTorrent Screencast\" height=\"20\" /></a> \n<a href='https://depot.galaxyproject.org/hub/attachments/documents/presentations/NGS101-Ion.pdf'><img src=\"/images/ngs101/pdf.png\" alt=\"Slides\" height=\"20\" /></a>\n<p><strong>Publications:</strong></p>\n<ul>\n<li><a href=\"http://www.nature.com/nature/journal/v475/n7356/full/nature10242.html\" target=\"_blank\" rel=\"noopener noreferrer\">Semiconmductor non-optical sequencing - Rothberg et al. (2011)</a></li>\n<li><a href=\"http://www.biomedcentral.com/content/pdf/1471-2164-13-341.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Ion Torrent, Illumina, PacBio comparison - Quail et al. (2011)</a></li>\n<li><a href=\"http://bioinformatics.oxfordjournals.org/content/29/13/i344.full.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Improving Ion Torrent Error Rates - Golar and Medvedev (2013)</a></li>\n</ul>\n<img src=\"/images/ngs101/pacBio.jpeg\" alt=\"PacBio\" height=\"20\" />\n<a href='https://vimeo.com/121267426'><img src=\"/images/ngs101/video.png\" alt=\"PacBio Screencast\" height=\"20\" /></a> \n<a href='https://depot.galaxyproject.org/hub/attachments/documents/presentations/NGS101-PacBio.pdf'><img src=\"/images/ngs101/pdf.png\" alt=\"Slides\" height=\"20\" /></a>\n<p><strong>Publications:</strong></p>\n<ul>\n<li><a href=\"http://www.sciencemag.org/content/299/5607/682.full.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Single Molecule Analaysis at High Concentration - Levene et al. (2003)</a></li>\n<li><a href=\"http://www.pnas.org/content/105/4/1176.full\" target=\"_blank\" rel=\"noopener noreferrer\">ZMW nanostructures - Korlach et al. (2008)</a></li>\n<li><a href=\"http://www.sciencemag.org/content/323/5910/133.full\" target=\"_blank\" rel=\"noopener noreferrer\">Real Time Sequencing with PacBio - Eid et al. (2009)</a></li>\n<li><a href=\"http://www.nature.com/nmeth/journal/v7/n6/pdf/nmeth.1459.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Modification detection with PacBio - Flusberg et al. (2010)</a></li>\n<li><a href=\"http://www.nature.com/nbt/journal/v30/n7/pdf/nbt.2280.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Error correction of PacBio reads - Koren et al. (2012)</a></li>\n<li><a href=\"http://www.pnas.org/cgi/doi/10.1073/pnas.1400447111\" target=\"_blank\" rel=\"noopener noreferrer\">Transcriptome with PacBio - Taligner et al. (2014)</a></li>\n<li><a href=\"https://doi.org/10.1038/nature13907\" target=\"_blank\" rel=\"noopener noreferrer\">Resolving complex regions with PacBio - Chaisson et al. (2015)</a></li>\n</ul>\n<hr>\n<h2 id=\"getting-data-in\"><a href=\"#getting-data-in\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Getting data in</h2>\n<p>You can data in Galaxy using one of five ways:</p>\n<ol>\n<li><strong>From your local computer</strong> | <a href=\"https://vimeo.com/120901536\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-1</a> | This works best for small files.</li>\n<li><strong>From FTP</strong> | <a href=\"https://vimeo.com/120972739\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-2</a> | The FTP mechanism allows transferring large collections of files. This is the preferred mechanism for uploading large datasets to Galaxy.</li>\n<li><strong>From the web</strong> | <a href=\"https://vimeo.com/120973708\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-3</a> | Upload from the web works when URL (addresses) of data files are known</li>\n<li><strong>From EBI short read archive</strong> | <a href=\"https://vimeo.com/121187220\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-4</a> | This is the best way to upload published datasets deposited to EBI SRA. The problem is that not all datasets are available from EBI. #5 below explain how to deal with NCBI SRA datasets</li>\n<li><strong>Fooling NCBI SRA to produce fastq on the fly</strong> | <a href=\"https://vimeo.com/121190377\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-5</a> | A tricky but reliable way to get few datasets from NCBI SRA</li>\n</ol>\n<hr>\n<h2 id=\"fastq-manipulation-and-quality-control\"><a href=\"#fastq-manipulation-and-quality-control\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Fastq manipulation and quality control</h2>\n<p><a href=\"https://vimeo.com/123453134\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-6</a> | <a href=\"https://test.galaxyproject.org/u/anton/h/fastqc\" target=\"_blank\" rel=\"noopener noreferrer\">Galaxy History</a></p>\n<p>One of the first steps in the analysis of NGS data is seeing how good the data actually is. <a href=\"http://www.bioinformatics.babraham.ac.uk/projects/fastqc/\" target=\"_blank\" rel=\"noopener noreferrer\">FastQC</a> is a fantastic tool allowing you to gauge the quality of fastq datasets (and deciding whether to blame or not to blame whoever has done sequencing for you).</p>\n<div class='right'><div class='center'><span style=\"font-size: smaller;\">**B**. Hmmm...OK</span></div><img src=\"/images/ngs101/fastqc-bad.png\" alt=\"Bad fastq\" height=\"200\" /><div class='center'><span style=\"font-size: smaller;\">Position within read</span></div></div>\n<div class='right'><div class='center'><span style=\"font-size: smaller;\">**A**. Excellent</span></div><img src=\"/images/ngs101/fastqc-good.png\" alt=\"Good fastq\" height=\"200\" /><div class='center'><span style=\"font-size: smaller;\">Position within read</span></div></div>\n<p>Here you can see FastQC base quality reports (the tools gives you many other types of data) for two datasets: <strong>A</strong> and <strong>B</strong>. The <strong>A</strong> dataset has long reads (250 bp) and very good quality profile with no qualities dropping below phred value of 30. The <strong>B</strong> dataset is significantly worse with ends of the reads dipping below phred score of 20. The <strong>B</strong> reads may need to be trimmed for further processing.</p>\n<h3 id=\"fastq-has-many-faces\"><a href=\"#fastq-has-many-faces\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Fastq has many faces</h3>\n<p><a href=\"http://en.wikipedia.org/wiki/FASTQ_format\" target=\"_blank\" rel=\"noopener noreferrer\">Fastq</a> is not a very well defined format. In the beginning various manufacturers of sequencing instruments were free to interpret fastq as they saw fit, resulting in a multitude of fastq flavors. This variation stemmed primarily from different ways of encoding quality values as described <a href=\"http://en.wikipedia.org/wiki/FASTQ_format\" target=\"_blank\" rel=\"noopener noreferrer\">here</a>. Today, <a href=\"http://www.ncbi.nlm.nih.gov/pubmed/20015970\" target=\"_blank\" rel=\"noopener noreferrer\">fastq sanger</a> version of the format is considered to be the standard form of fastq. Galaxy is using fastq sanger as the only legitimate input for downstream processing tools and provides <a href=\"http://www.ncbi.nlm.nih.gov/pubmed/20562416\" target=\"_blank\" rel=\"noopener noreferrer\">a number of utilities for converting fastq files</a> into this form (see <strong>NGS: QC and manipulation</strong> section of Galaxy tools).</p>\n<hr>\n<h2 id=\"mapping-your-data\"><a href=\"#mapping-your-data\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Mapping your data</h2>\n<p>Mapping of NGS reads against reference sequences is one of the key steps of the analysis. Basic understanding of how mapping works is just as important as knowing the effects of temperature and magnesium concentration on PCR reaction performance. Below is a list of key publications highlighting basic principles of current mapping tools:</p>\n<ul>\n<li><a href=\"http://www.nature.com/nbt/journal/v27/n5/full/nbt0509-455.html\" target=\"_blank\" rel=\"noopener noreferrer\">How to map billions of short reads onto genomes? - Trapnell &#x26; Salzberg (2009)</a></li>\n<li><a href=\"http://genomebiology.com/content/10/3/R25\" target=\"_blank\" rel=\"noopener noreferrer\">Bowtie 1 - Langmead et al. (2009)</a></li>\n<li><a href=\"http://www.nature.com/nmeth/journal/v9/n4/full/nmeth.1923.html\" target=\"_blank\" rel=\"noopener noreferrer\">Bowtie 2 - Langmead and Salzberg (2012)</a></li>\n<li><a href=\"http://bioinformatics.oxfordjournals.org/content/25/14/1754.long\" target=\"_blank\" rel=\"noopener noreferrer\">BWA - Li and Durbin (2009)</a></li>\n<li><a href=\"http://bioinformatics.oxfordjournals.org/content/26/5/589\" target=\"_blank\" rel=\"noopener noreferrer\">BWA - Li and Durbin (2010)</a></li>\n<li><a href=\"http://arxiv.org/abs/1303.3997\" target=\"_blank\" rel=\"noopener noreferrer\">BWA-MEM - Li (2013)</a></li>\n<li><a href=\"http://bioinformaticsalgorithms.com\" target=\"_blank\" rel=\"noopener noreferrer\">Bioinformatics Algorithms - Compeau and Pevzner (2014)</a></li>\n</ul>\n<h3 id=\"mapping-against-a-pre-computed-genome-index\"><a href=\"#mapping-against-a-pre-computed-genome-index\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Mapping against a pre-computed genome index</h3>\n<p><a href=\"https://vimeo.com/123102338\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-7</a> | <a href=\"https://test.galaxyproject.org/u/anton/h/mapping-wbwa\" target=\"_blank\" rel=\"noopener noreferrer\">Galaxy history</a></p>\n<div class='right'><div class='center'><span style=\"font-size: smaller;\">Mapping against pre-computed (cached) index</span></div><img src=\"/images/ngs101/cached-genome.png\" alt=\"Cached genome\" height=\"150\" /></div>\n<p>Mappers usually compare reads against a reference sequence that has been transformed into a highly accessible data structure called genome index. Such indices should be generated before mapping begins. Galaxy instances typically store indices for a number of publicly available genome builds. For example, the image on the right shows indices for hg38 version of the human genome. You can see that there are actually three choices: (1) <strong>hg38</strong>, (2) <strong>hg38 canonical</strong> and (3) <strong>hg38 canonical female</strong>. The <strong>hg38</strong> contains all chromosomes as well as all unplaced contigs. The <strong>hg38 canonical</strong> does not contain unplaced sequences and only consists of chromosomes 1 through 22, X, Y, and mitochondria. The\n<strong>hg38 canonical female</strong> contains everything from the canonical set with the exception of chromosome Y.</p>\n<h3 id=\"what-if-pre-computed-index-does-not-exist\"><a href=\"#what-if-pre-computed-index-does-not-exist\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>What if pre-computed index does not exist?</h3>\n<p><a href=\"https://vimeo.com/123108417\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-8</a> | <a href=\"https://test.galaxyproject.org/u/anton/h/my-genome\" target=\"_blank\" rel=\"noopener noreferrer\">Galaxy history</a></p>\n<div class='right'><div class='center'><span style=\"font-size: smaller;\">Mapping against uploaded genome</span></div><img src=\"/images/ngs101/mygenome.png\" alt=\"My genome\" height=\"100\" /></div>\n<p>If Galaxy does not have a genome you need to map against, you can upload your genome sequence as a FASTA file and use it in the mapper directly as shown on the right (\"Load reference genome\" is set to <strong>History</strong>). In this case Galaxy will first create an index from this dataset and then run mapping analysis against it.</p>\n<hr>\n<h2 id=\"understanding-and-manipulating-sambam-datasets\"><a href=\"#understanding-and-manipulating-sambam-datasets\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Understanding and manipulating SAM/BAM datasets</h2>\n<p>The <a href=\"https://depot.galaxyproject.org/hub/attachments/documents/papers/SAMv1.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">SAM/BAM</a> format is an accepted standard for storing aligned reads (it can also store unaligned reads and some mappers such as BWA are accepting unaligned BAM as input). The binary form of the format (BAM) is compact and can be rapidly searched (if indexed). In Galaxy BAM datasets are always indexed (accompanies by a .bai file) and sorted in coordinate order.</p>\n<h3 id=\"read-groups\"><a href=\"#read-groups\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Read groups</h3>\n<p>One of the key features of SAM/BAM format is the ability to label individual reads with readgroup tags. This allows pooling results of multiple experiments into a single BAM dataset. This significantly simplifies downstream logistics: instead of dealing with multiple datasets one can handle just one. Many downstream analysis tools such as variant callers are designed to recognize readgroup data and output results on per-readgroup basis.</p>\n<p>One of the best descriptions of BAM readgroups is on <a href=\"http://gatkforums.broadinstitute.org/discussion/1317/collected-faqs-about-bam-files\" target=\"_blank\" rel=\"noopener noreferrer\">GATK support site</a>. We have gratefully stolen two tables describing the most important readgroup tags -- ID, SM, LB, and PL -- from GATK forum and provide them here.</p>\n<div class='center'><img src=\"/images/ngs101/rg-description.png\" alt=\"SAM/BAM Readgroups\" height=\"504\" /></div>\nAs further described in the GATK forum: \"*A concrete example may be instructive. Suppose I have a trio of samples: MOM, DAD, and KID. Each has two DNA libraries prepared, one with 400 bp inserts and another with 200 bp inserts. Each of these libraries is run on two lanes of an Illumina machine, requiring 3 x 2 x 2 = 12 lanes of data. When the data come off the sequencer, I would create 12 bam files, with the following @RG fields in the header*\":<br />\n<div class='center'><img src=\"/images/ngs101/rg-example.png\" alt=\"Readgroup example\" height=\"327\" /></div>\n<p>The <a href=\"https://vimeo.com/123102338#t=1:40\" target=\"_blank\" rel=\"noopener noreferrer\">following screencast</a> shows how to add readgroups to a BAM dataset in Galaxy using Picard's <a href=\"http://broadinstitute.github.io/picard/command-line-overview.html#AddOrReplaceReadGroups\" target=\"_blank\" rel=\"noopener noreferrer\">AddOrReplaceReadGroups</a> tool.</p>\n<h3 id=\"bam-manipulation\"><a href=\"#bam-manipulation\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>BAM manipulation</h3>\n<div class='right'><div class='center'><span style=\"font-size: smaller;\">Filtering BAM with BAMtools in Galaxy</span></div><img src=\"/images/ngs101/BAM-filter.png\" alt=\"SAM/BAM Readgroups\" height=\"250\" /></div>\n[Video NGS101-9 = Tweaking BAM](https://vimeo.com/123113197) | [Galaxy history](https://test.galaxyproject.org/u/anton/h/bam-tweaking)\n<p>We support four toolsets for processing of SAM/BAM datasets:</p>\n<ul>\n<li><a href=\"https://deeptools.github.io/\" target=\"_blank\" rel=\"noopener noreferrer\">DeepTools</a> - a suite of user-friendly tools for the visualization, quality control and normalization of data from deep-sequencing DNA sequencing experiments.</li>\n<li><a href=\"http://www.htslib.org/\" target=\"_blank\" rel=\"noopener noreferrer\">SAMtools</a> - various utilities for manipulating alignments in the SAM/BAM format, including sorting, merging, indexing and generating alignments in a per-position format.</li>\n<li><a href=\"https://depot.galaxyproject.org/hub/attachments/documents/papers/bamtools.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">BAMtools</a> - a toolkit for reading, writing, and manipulating BAM (genome alignment) files.</li>\n<li><a href=\"http://broadinstitute.github.io/picard/\" target=\"_blank\" rel=\"noopener noreferrer\">Picard</a> - a set of Java tools for manipulating high-throughput sequencing data (HTS) data and formats.</li>\n</ul>\n<p>The <a href=\"https://vimeo.com/123113197\" target=\"_blank\" rel=\"noopener noreferrer\">Screencast NGS101-9</a> highlight de-duplication, filtering, and cleaning of a BAM dataset using BAMtools and Picard tools.</p>\n<hr>\n<h2 id=\"finding-variants\"><a href=\"#finding-variants\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Finding variants</h2>\n<div class='right'><div class='center'><span style=\"font-size: smaller;\">Variant calling (Nielsen et al. 2011)</span></div><img src=\"/images/ngs101/variant-calling.png\" alt=\"Variant Calling\" height=\"250\" /></div>\n<p>Because of the efforts such as <a href=\"http://www.1000genomes.org/\" target=\"_blank\" rel=\"noopener noreferrer\">the 1000 Genomes Project</a>, variant calling is one of the most developed areas of NGS analysis. Still, if you are interested in reliable finding of genetic variants it pays to understand how these approaches work. Below we provide a sampler of key publications on the subject.</p>\n<ul>\n<li><a href=\"http://www.nature.com/nrg/journal/v12/n6/pdf/nrg2986.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Nielsen et al. 2011</a> - Genotype and SNP calling from NGS data</li>\n<li><a href=\"http://www.nature.com/nrg/journal/v10/n4/pdf/nrg2554.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Frazer et al. 2009</a> - Human genetic variation and its contribution to complex traits</li>\n<li><a href=\"http://www.nature.com/nrg/journal/v12/n11/pdf/nrg3031.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Bamshad et al. 2011</a> - Exome sequencing as a tool for Mendelian disease gene discover</li>\n<li><a href=\"http://www.nature.com/nrg/journal/v12/n9/pdf/nrg3046.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Cooper and Shendure 2011</a> - Finding disease-causal variants in a wealth of genomic data</li>\n<li><a href=\"http://arxiv.org/pdf/1207.3907v2.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Garrison and Marth 2012</a> - Haplotype-based variant detection from short-read sequencing</li>\n<li><a href=\"http://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003153\" target=\"_blank\" rel=\"noopener noreferrer\">Paila et al. 2013</a> - GEMINI: Integrative Exploration of Genetic Variation and Genome Annotations</li>\n</ul>\n<h3 id=\"non-diploid-variant-calling\"><a href=\"#non-diploid-variant-calling\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Non-diploid variant calling</h3>\n<p><a href=\"https://vimeo.com/123442619\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-10 = Non-diploid variant calling with NVC</a> |  <a href=\"https://test.galaxyproject.org/u/anton/h/nond-nvc\" target=\"_blank\" rel=\"noopener noreferrer\">Galaxy history</a>\n<br />\n<a href=\"https://vimeo.com/123449704\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-11 = Non-diploid variant calling with FreeBayes</a> | <a href=\"https://test.galaxyproject.org/u/anton/h/nond-fb\" target=\"_blank\" rel=\"noopener noreferrer\">Galaxy history</a></p>\n<div class='right'><div class='center'><span style=\"font-size: smaller;\">Mitochondrial variants</span></div><img src=\"/images/ngs101/mt-alleles.png\" alt=\"Heteroplasmies\" height=\"200\" /></div>\n<p>The 1000 Genomes was focused on surveying the genetic diversity of humans - a diploid organism. Yet the majority of life on Earth is non-diploid and represented by prokaryotes, viruses and their derivatives such as our own mitochondria. In non-diploid organisms allele frequencies can range anywhere between 0 and 100% and there could be multiple (not just two) alleles per locus. The main challenge associated with non-diploid variant calling is the ability to distinguish between sequencing noise (abundant in all NGS platforms) and true low frequency variants. Some of the early attempts to do this well have been accomplished on human mitochondrial DNA although the same approaches will work equally good on viral and bacterial genomes:</p>\n<ul>\n<li><a href=\"http://www.pnas.org/content/111/43/15474.abstract\" target=\"_blank\" rel=\"noopener noreferrer\">Rebolledo-Jaramillo et al. 2014</a> - Maternal age effect and severe germ-line bottleneck in the inheritance of human mitochondrial DNA</li>\n<li><a href=\"http://www.pnas.org/content/112/8/2491.abstract\" target=\"_blank\" rel=\"noopener noreferrer\">Li et al. 2015</a> - Extensive tissue-related and allele-related mtDNA heteroplasmy suggests positive selection for somatic mutations</li>\n</ul>\n<hr>\n<h3 id=\"visualizing-multiple-datasets-in-integrated-genome-viewer-igv\"><a href=\"#visualizing-multiple-datasets-in-integrated-genome-viewer-igv\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Visualizing multiple datasets in Integrated Genome Viewer (IGV)</h3>\n<p><a href=\"https://vimeo.com/123414437\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-12 = Displaying multiple tracks in IGV</a>\n<br /></p>\n<div class='right'><div class='center'><span style=\"font-size: smaller;\">IGV displaying multiple tracks from Galaxy</span></div><div class='center'><img src=\"/images/ngs101/igv.png\" alt=\"IGV\" height=\"150\" /></div></div>\n<p>Galaxy has a number of display applications allowing visualization of various datasets. IGV (<a href=\"https://www.broadinstitute.org/igv/\" target=\"_blank\" rel=\"noopener noreferrer\">integrative genome viewer</a>) is one of the most versatile applications for looking at positional genomic data. In Galaxy you can view Interval, BED, BAM, and VCF datasets in IGV. The <a href=\"https://vimeo.com/123414437\" target=\"_blank\" rel=\"noopener noreferrer\">screencast</a> shows how to do this.</p>\n<hr>\n<h2 id=\"reference-based-rna-seq\"><a href=\"#reference-based-rna-seq\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Reference-based RNA-seq</h2>\n<p><a href=\"https://vimeo.com/channels/884356/128265983\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-14 = Mapping reads with TopHat</a><br />\n<a href=\"https://vimeo.com/channels/884356/128268401\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-15 = Reconstructing transcripts with CuffLinks</a><br />\n<a href=\"https://vimeo.com/channels/884356/128265982\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-16 = Processing CuffDiff output with Cummerbund</a><br />\n<a href=\"https://speakerdeck.com/nekrut/structure-workshop\" target=\"_blank\" rel=\"noopener noreferrer\">Galaxy RNA-seq workshop slides</a><br />\n<a href=\"https://test.galaxyproject.org/u/anton/h/rna-seq-tophatcufflinks\" target=\"_blank\" rel=\"noopener noreferrer\">Galaxy history containing the entire analysis</a></p>\n<div class='right'><div class='center'><span style=\"font-size: smaller;\">TopHat/Cufflinks workflow by Trapnell et al.</span></div><div class='center'><img src=\"/images/ngs101/rnaSeqWorkFlow.png\" alt=\"CuffLinks workflow\" height=\"450\" /></div></div>\n<p>There is a number of established strategies for performing RNA-seq analyses when the reference genome of an organism in question is available (for a recent comprehensive comparison see <a href=\"http://www.nature.com/nmeth/journal/v10/n12/full/nmeth.2722.html\" target=\"_blank\" rel=\"noopener noreferrer\">an assement of spliced aligners</a> and <a href=\"http://www.nature.com/nmeth/journal/v10/n12/full/nmeth.2714.html\" target=\"_blank\" rel=\"noopener noreferrer\">an evaluation of transcript reconstruction methods</a>).</p>\n<p>The public Galaxy instance at <a href=\"http://usegalaxy.org\" target=\"_blank\" rel=\"noopener noreferrer\">http://usegalaxy.org</a> has been successfully employing <a href=\"http://salzberg-lab.org/software/\" target=\"_blank\" rel=\"noopener noreferrer\">Tuxedo</a> suite of tools for references-based RNA-seq originating from Computational Biology and Genomics Lab at Johns Hopkins. However, there are also great resources such as <a href=\"http://oqtans.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Oqtans</a> developed at the Memorial Sloan-Kettering Cancer Center and <a href=\"/use/\">others</a>. Below are some of the key publications on the reference-based RNA-seq:</p>\n<ul>\n<li><a href=\"http://bioinformatics.oxfordjournals.org/content/25/9/1105.short\" target=\"_blank\" rel=\"noopener noreferrer\">TopHat: discovering splice junctions with RNA-Seq - Trapnell et al. (2009)</a></li>\n<li><a href=\"http://nature.com/nbt/journal/v28/n5/full/nbt.1621.html\" target=\"_blank\" rel=\"noopener noreferrer\">Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation - Trapnell et al. (2010)</a></li>\n<li><a href=\"http://www.nature.com/nprot/journal/v7/n3/full/nprot.2012.016.html\" target=\"_blank\" rel=\"noopener noreferrer\">Reference guided transcriptome analaysis with TopHat and CuffLinks - Trapnell et al. (2012)</a></li>\n<li><a href=\"http://genomebiology.com/2013/14/4/R36/abstract\" target=\"_blank\" rel=\"noopener noreferrer\">TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions - Kim et al. 2013</a></li>\n<li><a href=\"http://genomebiology.com/2011/12/3/R22\" target=\"_blank\" rel=\"noopener noreferrer\">Improving RNA-Seq expression estimates by correcting for fragment bias - Roberts et al. (2013)</a></li>\n<li><a href=\"http://www.nature.com/nmeth/journal/v10/n12/full/nmeth.2722.html\" target=\"_blank\" rel=\"noopener noreferrer\">Systematic evaluation of spliced alignment programs for RNA-seq data - Engström et al. (2013)</a></li>\n<li><a href=\"http://www.nature.com/nmeth/journal/v10/n12/full/nmeth.2714.html\" target=\"_blank\" rel=\"noopener noreferrer\">Assessment of transcript reconstruction methods for RNA-seq - Steijger et al. (2013)</a></li>\n<li><a href=\"http://bioinformatics.oxfordjournals.org/content/early/2014/01/10/bioinformatics.btt731.abstract\" target=\"_blank\" rel=\"noopener noreferrer\">Oqtans: The RNA-seq Workbench in the Cloud for Complete and Reproducible Quantitative Transcriptome Analysis - Sreedharan et al. (2014)</a></li>\n<li><a href=\"http://www.nature.com/nmeth/journal/vaop/ncurrent/full/nmeth.3317.html\" target=\"_blank\" rel=\"noopener noreferrer\">HISAT: a fast spliced aligner with low memory requirements - Kim et al. (2015)</a></li>\n<li><a href=\"http://www.nature.com/nbt/journal/v33/n3/full/nbt.3122.html\" target=\"_blank\" rel=\"noopener noreferrer\">StringTie enables improved reconstruction of a transcriptome from RNA-seq reads - Petrea et al. (2015)</a></li>\n</ul>\n<h3 id=\"getting-data-and-mapping-to-the-reference\"><a href=\"#getting-data-and-mapping-to-the-reference\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Getting data and mapping to the reference</h3>\n<p><a href=\"https://vimeo.com/channels/884356/128265983\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-14 = Mapping reads with TopHat</a><br /></p>\n<p>In this tutorial we are repeating the steps of a typical RNA-seq analysis described by Trapnell et al. (<a href=\"http://www.nature.com/nprot/journal/v7/n3/full/nprot.2012.016.html\" target=\"_blank\" rel=\"noopener noreferrer\">2012</a>) with one little exception: we have created a set of smaller input files to make this tutorial faster. These data can be accessed <a href=\"https://usegalaxy.org/u/aun1/h/rna-seq-tutorial-data\" target=\"_blank\" rel=\"noopener noreferrer\">here</a> as a Galaxy history. Simply click <strong>import history</strong> and use it as a starting point of your analysis.</p>\n<p>This analysis begins by uploading an annotation file from the <a href=\"https://genome.ucsc.edu/cgi-bin/hgTables\" target=\"_blank\" rel=\"noopener noreferrer\">UCSC Table Browser</a> and using it as a set of reference gene annotations. The data corresponds to two experimental conditions - Condition 1 and Condition 2 - each containing three replicates. In turn each replicate was sequenced as a mate-pair library and so has two associated datasets: forward and reverse. Thus (2 conditions) x (3 replicates) x (forward and reverse reads) = 2 x 3 x 2 = 12 datasets. We begin by using new Galaxy functionality - dataset collections - to bundle datasets into two collections: one corresponding to condition 1 and the other to condition 2. We then map the reads in each collection against <strong>dm3</strong> version of <em>Drosophila melanogaster</em> genome using TopHat2. This generates (among other outputs) BAM outputs containing mapped reads.</p>\n<h3 id=\"reconstructing-transcripts\"><a href=\"#reconstructing-transcripts\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Reconstructing transcripts</h3>\n<p><a href=\"https://vimeo.com/channels/884356/128268401\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-15 = Reconstructing transcripts with CuffLinks</a><br /></p>\n<div class='right'><div class='center'><span style=\"font-size: smaller;\">Expression levels for five transcripts of<br />a gene in conditions 1 (blue) and 2 (brown)</span></div><div class='center'><img src=\"/images/ngs101/cuffdiffPlot.png\" alt=\"CuffDiff plot\" height=\"200\" /></div></div>\n<p>Reads mapped by TopHat are then used as input to CuffLinks - a tool that performs transcript reconstruction and quantification. This is done individually for every replicate (although because our data is bundled in collections this is a painless exercise). Once transcript reconstruction is finished we combine transcript model from all replicates and conditions into a single transcriptome using CuffMerge. Finally, we perform differential expression analysis with CuffDiff using the combined transcriptome and read mapping data.</p>\n<h3 id=\"finding-differentially-expressed-transcripts\"><a href=\"#finding-differentially-expressed-transcripts\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Finding differentially expressed transcripts</h3>\n<p><a href=\"https://vimeo.com/channels/884356/128265982\" target=\"_blank\" rel=\"noopener noreferrer\">Video NGS101-16 = Processing CuffDiff output with Cummerbund</a><br /></p>\n<p>Galaxy version of CuffDiff used in the previous step produces a database. Using <em>Extract CuffDiff data</em> and <em>Filter</em> tools we retrieve a list of differentially expressed genes and visualize expression level for transcripts of one such gene using CummerBund.</p>\n<h3 id=\"hisat-and-stringtie\"><a href=\"#hisat-and-stringtie\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>HISAT and StringTie</h3>\n<p>The mapping and transcript reconstruction steps of the reference-based RNA-seq analysis will soon be complemented with the addition of <a href=\"http://ccb.jhu.edu/software/hisat/index.shtml\" target=\"_blank\" rel=\"noopener noreferrer\">HISAT</a> and <a href=\"http://ccb.jhu.edu/software/stringtie/\" target=\"_blank\" rel=\"noopener noreferrer\">StringTie</a> tools. Stay tuned for updates.</p>\n<hr>\n<h2 id=\"what-is-coming-next\"><a href=\"#what-is-coming-next\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>What is coming next?</h2>\n<ul>\n<li>RNA secondary structure prediction</li>\n<li>Reference-free RNA-seq with Trinity</li>\n<li>DNA/Protein Interactions</li>\n<li>16S &#x26; shotgun metagenomics</li>\n<li>Visualization of NGS data</li>\n</ul>\n<hr>\n"}},"context":{}}