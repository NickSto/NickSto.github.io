{"hash":"eaf962330836a104724e8b210d95933603316eda","data":{"article":{"id":"35cceb96346c6e31b1cfe8320835be26","title":"NCBI SRA Fastq","tease":"","category":null,"date":null,"days":null,"contact":"","contact_url":"","authors":"","location":"","location_url":"","source_blog":"","source_blog_url":"","skip_title_render":null,"redirect":"","links":[],"image":"","images":{},"external_url":"","content":"<div class=\"toc-wrapper col-md-3\">\n<ul>\n<li>\n<p><a href=\"#data-retrieval-with-ncbi-sra-tools-fastq-dump\">Data retrieval with “NCBI SRA Tools” (fastq-dump)</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#downloading-metadata\">Downloading metadata</a></li>\n<li><a href=\"#organizing-metadata\">Organizing metadata</a></li>\n<li><a href=\"#importing-data\">Importing data</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#ncbi-sra-sourced-fastq-data\">NCBI SRA sourced fastq data</a></p>\n<ul>\n<li>\n<p><a href=\"#inconsistent-sequence--and-quality--identifiers\">Inconsistent sequence (@) and quality (+) identifiers</a></p>\n<ul>\n<li><a href=\"#example\">Example</a></li>\n<li><a href=\"#solution\">Solution</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#interlaced-forward-and-reverse-reads\">Interlaced forward and reverse reads</a></p>\n<ul>\n<li><a href=\"#example-1\">Example</a></li>\n<li><a href=\"#solution-1-reads-named-1-and-2\">Solution 1 (reads named /1 and /2)</a></li>\n<li>\n<p><a href=\"#solution-2-reads-named-1-and-2\">Solution 2 (reads named /1 and /2)</a></p>\n<ul>\n<li><a href=\"#use-these-manipulate-fastq-settings-to-produce-a-dataset-that-contains-the-1-reads\">Use these Manipulate FASTQ settings to produce a dataset that contains the <code>/1</code> reads</a></li>\n<li><a href=\"#use-these-manipulate-fastq-settings-to-produce-a-dataset-that-contains-the-2-reads\">Use these Manipulate FASTQ settings to produce a dataset that contains the <code>/2</code> reads</a></li>\n</ul>\n</li>\n<li><a href=\"#solution-3-reads-named-1-and-3\">Solution 3 (reads named /1 and /3)</a></li>\n<li><a href=\"#solution-4-reads-named-without-n\">Solution 4 (reads named without /N)</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div>\n<div class=\"body-wrapper col-md-9\">\n<p><a href=\"/support/\">Back to Support Hub</a></p>\n<h1 id=\"data-retrieval-with-ncbi-sra-tools-fastq-dump\"><a href=\"#data-retrieval-with-ncbi-sra-tools-fastq-dump\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Data retrieval with “NCBI SRA Tools” (fastq-dump)</h1>\n<p>This section will guide you through downloading experimental metadata, organizing the metadata to short lists corresponding to conditions and replicates, and finally importing the data from NCBI SRA in <a href=\"/tutorials/collections/\"><strong>collections</strong></a> reflecting the experimental design.</p>\n<h3 id=\"downloading-metadata\"><a href=\"#downloading-metadata\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Downloading metadata</h3>\n<p><em>It is critical to understand the condition/replicate structure of an experiment before working with the data so that it can be imported as collections ready for analysis.</em> Direct your browser to <a href=\"https://www.ncbi.nlm.nih.gov/Traces/study/\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.ncbi.nlm.nih.gov/Traces/study/</a> and in the search box enter GEO data set identifier (for example: GSE72018). Once the study appears, click the box to download the “RunInfo Table”.</p>\n<h3 id=\"organizing-metadata\"><a href=\"#organizing-metadata\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Organizing metadata</h3>\n<p>The “RunInfo Table” provides the experimental condition and replicate structure of all of the samples. Prior to importing the data, we need to parse this file into individual files that contain the sample IDs of the replicates in each condition. This can be achieved by using a combination of the ‘group’, ‘compare two datasets’, ‘filter’, and ‘cut’ tools <strong>to end up with single column lists of sample IDs (SRRxxxxx) corresponding to each condition.</strong></p>\n<h3 id=\"importing-data\"><a href=\"#importing-data\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Importing data</h3>\n<p>We can now provide the files with SRR IDs to NCBI SRA Tools (fastq-dump) to import the data from SRA to Galaxy. By organizing the replicates of each condition in separate lists, <strong>the data will be imported as “collections” that can be directly loaded to a workflow or analysis pipeline.</strong></p>\n<h1 id=\"ncbi-sra-sourced-fastq-data\"><a href=\"#ncbi-sra-sourced-fastq-data\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>NCBI SRA sourced fastq data</h1>\n<p>In these <a href=\"/learn/datatypes/#fastq\">FASTQ</a> data:</p>\n<ul>\n<li>The quality score identifier (+) is sometimes not a match for the sequence identifier (@).</li>\n<li>The forward and reverse reads may be interlaced and need to be seperated into distinct datasets.</li>\n<li>Both may be present in a dataset. Correct the first, then the second, as explained below.</li>\n<li>Format problems of any kind can cause tool failures and/or unexpected results.</li>\n<li>Fix the problems before running any other tools (including <strong>FastQC</strong>, <strong>Fastq Groomer</strong>, or other QA tools)</li>\n</ul>\n<h2 id=\"inconsistent-sequence--and-quality--identifiers\"><a href=\"#inconsistent-sequence--and-quality--identifiers\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Inconsistent sequence (@) and quality (+) identifiers</h2>\n<h3 id=\"example\"><a href=\"#example\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Example</h3>\n<p>Notice that the sequence identifier for the quality score name (\"+\" line) is NOT one of these accepted formats:</p>\n<ul>\n<li>The same exact content is present for both the quality score name and the sequence name (\"@\" line)</li>\n<li>Quality score name is a single plus sign (\"+\")</li>\n</ul>\n<pre><code>@MG00HS05:491:C7450ACXX:4:1101:1240:2223_forward/1\nTTTGTGACTAATTGTATAACAGGTTATTTTAGTTTCTGTTCTGTGGAAAGTGCAAAGCATTCCAATAAGGGTTTTTATGTTTGCAAAGGAGAGTTTGTCTA\n+SRR5330501.1 MG00HS05:491:C7450ACXX:4:1101:1240:2223 length=101\n:??>D>,,,CDD8,C&#x3C;EEI@@C;3&#x3C;AF9:C+22+2A4E:11@C11?D9*?BDB*009)9*08?D9BEIDEI.@CA=6=A@A?D===@?;.;?>AAA;>>A#\n</code></pre>\n<h3 id=\"solution\"><a href=\"#solution\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Solution</h3>\n<p>Correct the format by running the tool <strong>Replace Text in entire line</strong> with these options:</p>\n<p>Find pattern: <code>^\\+SRR.+</code></p>\n<p>Replace with: <code>+</code></p>\n<p>Note: If the quality score line is named like \"+ERR\" instead (or other valid options), modify the pattern search to match.</p>\n<h2 id=\"interlaced-forward-and-reverse-reads\"><a href=\"#interlaced-forward-and-reverse-reads\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Interlaced forward and reverse reads</h2>\n<h3 id=\"example-1\"><a href=\"#example-1\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Example</h3>\n<p>The forward and reverse reads were extracted into the same dataset as interlaced sequences. These need to be filtered into two distinct fastq datasets for use with tools as paired-end datasets.</p>\n<pre><code>@1/1\nNTCAAAATCTGCCGTTGATTTTTCATCCAATGGACAGCCACAAGCAATCCCAGTCCTCCTCTTACTCTCCTCAGCCTCCCACTTCTTCTG\n+\n#:9::>&#x3C;&#x3C;>>DDDDDDDDDDDDDDDDDDDDDDDDDDDDD=DDDD@DDDDDDDDDDD@DDDDDDDDDDDDD@@;@@????7:D=7D@@@@@\n@1/2\nGTGGTGGAAGGGTGCCAGCGGAGTGGCGGCGATGGCGACGGAGGCGGGGGGGAGGGGGACAGGAGAAGGGGGGGGGCGGGGGGGGGGAGA\n+\nIFGGCHHEGHHFEHGHHHFHG?E:FECDD#############################################################\n@2/1\nNGCTTGGTTAAGGGAACCCACCGGAGCCGTAGCGAAAGCGAGTCTTCATAGGGCAATTGTCACTGCTTATGGACCCGAACCTGGGTGATC\n+\n#::9:;&#x3C;&#x3C;&#x3C;;DDDDDDDDDDD::DDDDDDDDDDDDDDDDDDDDDDDDDD;DDDB@DDD@D=7???7&#x3C;>&#x3C;&#x3C;=?&#x3C;=?DD;D@@9@@@7:71:\n@2/2\nGGGGAGAACCAGCTAGCTCTGGGTTCGAGTGGCATTTCACCCCTAACCACAACTCATCCGCTGATTCTTCAACATCAGTCGGTTCGGACC\n+\nHHHHHHHHHHHHHHHHHHHHHHHHHHHFHEHHHHHHHFHHHHHHHHHHHHHHHHHHHHHHFHHFHHHHHHHHHHHHFHEHHHFHHHHFBH\n</code></pre>\n<h3 id=\"solution-1-reads-named-1-and-2\"><a href=\"#solution-1-reads-named-1-and-2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Solution 1 (reads named /1 and /2)</h3>\n<p>Use the tool <strong>FASTQ de-interlacer on paired end reads</strong></p>\n<h3 id=\"solution-2-reads-named-1-and-2\"><a href=\"#solution-2-reads-named-1-and-2\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Solution 2 (reads named /1 and /2)</h3>\n<p>Create distinct datasets from an interlaced fastq dataset by running the tool <strong>Manipulate FASTQ reads on various attributes</strong> on the original dataset. It will be run twice.</p>\n<p><em>Note: The solution is NOT use the <strong>FASTQ Splitter</strong> tool. The data to be manipulated are interlaced sequences. This is different in format from data that are joined into a single sequence.</em></p>\n<h4 id=\"use-these-manipulate-fastq-settings-to-produce-a-dataset-that-contains-the-1-reads\"><a href=\"#use-these-manipulate-fastq-settings-to-produce-a-dataset-that-contains-the-1-reads\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Use these Manipulate FASTQ settings to produce a dataset that contains the <code>/1</code> reads</h4>\n<p><em>Match Reads</em></p>\n<p>Match Reads by <code>Name/Indentifier</code></p>\n<p>Identifier Match Type <code>Regular Expression</code></p>\n<p>Match by <code>.+/2</code></p>\n<p><em>Manipulate Reads</em></p>\n<p>Manipulate Reads by <code>Miscellaneous Actions</code></p>\n<p>Miscellaneous Manipulation Type <code>Remove Read</code></p>\n<h4 id=\"use-these-manipulate-fastq-settings-to-produce-a-dataset-that-contains-the-2-reads\"><a href=\"#use-these-manipulate-fastq-settings-to-produce-a-dataset-that-contains-the-2-reads\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Use these Manipulate FASTQ settings to produce a dataset that contains the <code>/2</code> reads</h4>\n<p>Exact same settings as above except for this change:</p>\n<p>Match by <code>.+/1</code></p>\n<h3 id=\"solution-3-reads-named-1-and-3\"><a href=\"#solution-3-reads-named-1-and-3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Solution 3 (reads named /1 and /3)</h3>\n<p>Use the same operations as in Solution 2 above, except change the first <strong>Manipulate FASTQ</strong> query term to be:</p>\n<p>Match by <code>.+/3</code></p>\n<h3 id=\"solution-4-reads-named-without-n\"><a href=\"#solution-4-reads-named-without-n\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Solution 4 (reads named without /N)</h3>\n<p>If your data has differently formatted sequence identifiers, the \"Match by\" expression from <em>Solution 2</em> above can be modified to suit your identifiers.</p>\n<p>Alternative identifiers such as:</p>\n<pre><code>@M00946:180:000000000-ANFB2:1:1107:14919:14410 1:N:0:1\n@M00946:180:000000000-ANFB2:1:1107:14919:14410 2:N:0:1\n</code></pre>\n<p>Can be split with:</p>\n<p>Match by <code>^.+ 1.+$</code></p>\n<p>and</p>\n<p>Match by <code>^.+ 2.+$</code></p>\n<hr>\n</div>\n"}},"context":{}}