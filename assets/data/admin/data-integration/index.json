{"hash":"64a9e8afa68c1466f7ef441294c96aecf9a68066","data":{"article":{"id":"afef8931eaa488112433f161a56046c3","title":"","tease":"","category":null,"date":null,"days":null,"contact":"","contact_url":"","authors":"","location":"","location_url":"","source_blog":"","source_blog_url":"","skip_title_render":null,"links":[],"image":"","images":{},"external_url":"","content":"<div class=\"toc-wrapper col-md-3\">\n<ul>\n<li><a href=\"#data-integration-for-local-instances\">Data Integration for Local Instances</a></li>\n<li>\n<p><a href=\"#how-it-works\">How it works</a></p>\n<ul>\n<li><a href=\"#get-the-data\">Get the data</a></li>\n<li><a href=\"#set-up-the-loc-file\">Set up the loc file</a></li>\n<li><a href=\"#loc-file-examples\">*.loc file examples</a></li>\n<li><a href=\"#add-new-genome-as-galaxy-build\">Add new genome as Galaxy build</a></li>\n<li><a href=\"#restart-the-server\">Restart the server</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<div class=\"body-wrapper col-md-9\">\n<h2 id=\"data-integration-for-local-instances\"><a href=\"#data-integration-for-local-instances\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Data Integration for Local Instances</h2>\n<p>Please note that \"built-in\" or \"cached\" data can now be managed directly from within the Galaxy admin interface. For details, see: <strong><a href=\"/admin/tools/data-managers/\">Data Managers Overview</a></strong> and our <strong><a href=\"https://github.com/galaxyproject/dagobah-training/blob/2017-montpellier/sessions/05-reference-genomes/ex1-reference-genomes.md\" target=\"_blank\" rel=\"noopener noreferrer\">Data Managers Tutorial</a></strong>.</p>\n<p>Built-in data files are critical for many Galaxy tools. This page will describe how to get data into your local instance of Galaxy in a general way. For instructions specific for organizing and indexing data for use with tools, see <strong><a href=\"/admin/data-preparation/\">Data Preparation</a></strong>. Additional instructions are available for reviewing or retrieving the exact data hosted on the public <a href=\"/main/\">Main</a> instance or for performing more complex data prep used by specific tool groups.</p>\n<ul>\n<li>Review or retrieve <a href=\"https://usegalaxy.org\" target=\"_blank\" rel=\"noopener noreferrer\">https://usegalaxy.org</a> reference genomes, indexes, and loc files. All methods are described at <a href=\"http://datacache.galaxyproject.org/\" target=\"_blank\" rel=\"noopener noreferrer\">http://datacache.galaxyproject.org/</a>, with more rsync server help at <strong><a href=\"/admin/use-galaxy-rsync/\">Usegalaxy.org Rsync</a></strong></li>\n<li>\"Fetch Alignment\" tools data prep: <strong><a href=\"/admin/reference-mafs/\">Reference MAFs</a></strong></li>\n</ul>\n<h2 id=\"how-it-works\"><a href=\"#how-it-works\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>How it works</h2>\n<p>There are several steps needed for adding a genome to Galaxy. The first is to get the actual data needed and to put it into an appropriate directory accessible to the Galaxy instance. Then you need to establish the particular <code>.loc</code> (\"location\") file. Finally, make sure that the genome is referenced in the <code>$GALAXYROOT/tool-data/shared/ucsc/builds.txt</code> file.</p>\n<p><strong>Note that as of early 2014, more than a builds.txt file change is needed to establish a new reference genome. If not using</strong> <a href=\"/admin/tools/data-managers/\">Data Managers</a> <strong>, you must make the necessary changes/additions to the new <a href=\"/admin/tools/data-tables\">Data Tables</a> or use the alternative configuration file.</strong></p>\n<h3 id=\"get-the-data\"><a href=\"#get-the-data\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Get the data</h3>\n<p>First you need to determine what type of data you need. Usually these are <code>.fasta</code>, <code>.nib</code>, <code>.2bit</code>, or special index files, but each tool has a specific need. Open up the XML for the particular tool and identify the <code>.loc</code> file referred to in either a validator tag or options tag. Open the <code>$GALAXYROOT/tool-data/&#x26;lt;filename&#x26;gt;.loc.sample</code> file, and read it to discover the type of files necessary. Once you know what you need, you can go acquire it.</p>\n<p>There are several ways to get the data. If you don't already have the right file on your system, you will need to get it from a site such as <a href=\"http://hgdownload.soe.ucsc.edu/downloads.html\" target=\"_blank\" rel=\"noopener noreferrer\">UCSC</a>.</p>\n<p>Or, if you would like to obtain the data as available on the public Galaxy <a href=\"/main/\">Main</a> instance, these can retrieved from the rsync server. Read more here: <strong><a href=\"/admin/use-galaxy-rsync/\">Rsync</a></strong></p>\n<h3 id=\"set-up-the-loc-file\"><a href=\"#set-up-the-loc-file\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Set up the loc file</h3>\n<p>The <code>.loc.sample</code> files themselves include instructions for setting them up. In all cases, there is one reference genome per line, with tab-separated information. Create the needed <code>.loc</code> files, add your sequence and index data, and place these into the <code>$GALAXYROOT/tool-data</code> directory. This can be modified, but is the default location configured in <code>config/galaxy.ini</code> and the other configuration files referenced by it, in this section:</p>\n<pre><code># -- Files and directories\n\n\n# Path where genome builds are stored. This defaults to tool-data/genome\n#genome_data_path = tool-data/genome\n\n\n...&#x3C;skipped>...\n\n\n# XML config file that contains data table entries for the ToolDataTableManager. This file is manually\n# maintained by the Galaxy administrator.\n#tool_data_table_config_path = tool_data_table_conf.xml\n\n\n# XML config file that contains additional data table entries for the ToolDataTableManager. This file\n# is automatically generated based on the current installed tool shed repositories that contain valid\n# tool_data_table_conf.xml.sample files. At the time of installation, these entries are automatically\n# added to the following file, which is parsed and applied to the ToolDataTableManager at server start up.\n#shed_tool_data_table_config = shed_tool_data_table_conf.xml\n</code></pre>\n<h3 id=\"loc-file-examples\"><a href=\"#loc-file-examples\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>*.loc file examples</h3>\n<p>With tabs separating the information:</p>\n<p><strong>alignseq.loc</strong></p>\n<pre><code>align   anoGam1 dm1 /depot/data2/galaxy/anoGam1/align/dm1\nalign   anoGam1 dm2 /depot/data2/galaxy/anoGam1/align/dm2\nalign   canFam1 hg17    /depot/data2/galaxy/canFam1/align/hg17\n</code></pre>\n<p><strong>bowtie2_indexes.loc</strong></p>\n<pre><code>hg38canon hg38 Human (Homo sapiens) (b38): hg38 Canonical /galaxy/data/hg38/hg38canon/bowtie2_index/hg38canon\nhg38 hg38 Human (Homo sapiens) (b38): hg38 /galaxy/data/hg38/hg38full/bowtie2_index/hg38full\ndipOrd1 dipOrd1 Kangaroo rat (Dipodomys ordii): dipOrd1 /galaxy/data/dipOrd1/bowtie2_index/dipOrd1\nbraFlo1 braFlo1 Lancelet (Branchiostoma floridae): braFlo1 /galaxy/data/braFlo1/bowtie2_index/braFlo1\nanoCar1 anoCar1 Lizard (Anolis carolinensis): anoCar1 /galaxy/data/anoCar1/bowtie2_index/anoCar1\nanoCar2 anoCar2 Lizard (Anolis carolinensis): anoCar2 /galaxy/data/anoCar2/bowtie2_index/anoCar2\n</code></pre>\n<p>Also see the <strong><a href=\"/admin/use-galaxy-rsync/\">Rsync</a></strong> wiki if you want to obtain the exact same location files used on <a href=\"https://usegalaxy.org\" target=\"_blank\" rel=\"noopener noreferrer\">https://usegalaxy.org</a> for full size examples or for use as base-line files when configuring your own server.</p>\n<h3 id=\"add-new-genome-as-galaxy-build\"><a href=\"#add-new-genome-as-galaxy-build\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Add new genome as Galaxy build</h3>\n<p>Final and most important item needed is to include any new reference genomes in the builds.txt file. This is the list of reference genomes appear in the Genome or Database/Build search box when you upload a file or change a file's metadata (Where to find these? See the Rsync link directly above for screenshots).</p>\n<p>To modify the builds.txt file, add a line to <code>$GALAXYROOT/tool-data/shared/ucsc/builds.txt</code> for your genome. The format of this line can vary, but should contain enough information to uniquely identify the genome, the source, any external build nomenclature, and the <strong>dbkey</strong> selected for use within your <a href=\"/admin/get-galaxy/\">Galaxy</a> instance. See the public <a href=\"/main/\">Main</a> server for examples: <a href=\"https://usegalaxy.org\" target=\"_blank\" rel=\"noopener noreferrer\">https://usegalaxy.org</a></p>\n<h3 id=\"restart-the-server\"><a href=\"#restart-the-server\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Restart the server</h3>\n<p><strong>Any time you change data information, the server has to be restarted!!!</strong></p>\n<hr>\n</div>\n"}},"context":{}}