{"hash":"c32ecfdb33b075b0057598b5b9118f3554a398cf","data":{"article":{"id":"42652cbe22d346e4e608f076c81382cd","title":"Google Cloud Storage","tease":"","image":"","images":{},"category":null,"contact":"","date":null,"content":"<h1 id=\"google-cloud-storage\"><a href=\"#google-cloud-storage\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Google Cloud Storage</h1>\n<p>A Galaxy admin can configure <a href=\"/src/admin/objectstore/index.md\">ObjectStore</a> to\npersist data on a <a href=\"https://cloud.google.com/storage/\" target=\"_blank\" rel=\"noopener noreferrer\">Google Cloud Storage</a>.\nIn the following, first we explain how to setup a <a href=\"https://cloud.google.com/storage/docs/key-terms#buckets\" target=\"_blank\" rel=\"noopener noreferrer\">bucket</a>\non the Google Cloud Storage, and then we discuss how to configure Galaxy\nObjectStore to leverage that bucket.</p>\n<h2 id=\"step-12-configure-google-cloud-storage\"><a href=\"#step-12-configure-google-cloud-storage\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Step 1/2: Configure Google Cloud Storage</h2>\n<p>In general, to setup Google Cloud Storage, you would first need to create\na <em><a href=\"https://cloud.google.com/compute/docs/access/service-accounts\" target=\"_blank\" rel=\"noopener noreferrer\">service accounts</a></em>\nfrom <em><a href=\"https://console.cloud.google.com\" target=\"_blank\" rel=\"noopener noreferrer\">Google Cloud Console</a></em> and authorize it to read/write\nstorage objects under your account, then obtain the necessary credentials that\nauthorize Galaxy to assume the service account, and finally create a bucket for Galaxy.\nIn order to do so, you may take the following steps:</p>\n<h3 id=\"create-a-service-account\"><a href=\"#create-a-service-account\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Create a Service Account</h3>\n<ol>\n<li>\n<p>Go to <a href=\"https://console.cloud.google.com\" target=\"_blank\" rel=\"noopener noreferrer\">console.cloud.google.com</a> and login\nwith your Google credentials. You will then be redirected to your dashboard\non Google Cloud Platform:</p>\n<pre><code>![image](/src/admin/objectstore/gce/01.png)\n</code></pre>\n</li>\n<li>\n<p>Go to <em><a href=\"https://cloud.google.com/compute/docs/access/service-accounts\" target=\"_blank\" rel=\"noopener noreferrer\">service accounts</a></em>\npage as shown in the following figure:</p>\n<pre><code>![image](/src/admin/objectstore/gce/02.png)\n</code></pre>\n</li>\n<li>\n<p>Create a <em>service account</em> by clicking on the <code>CREATE SERVICE ACCOUNT</code> button: </p>\n<p><img src=\"/src/admin/objectstore/gce/03.png\" alt=\"image\"> </p>\n<p>This will create a service account under currently selected project (e.g.,\nthe <code>first Test</code> project as shown in our example figures). You can select a\ndifferent project by clicking on the drop-down icon next to the currently\nselected project and choose a different project from the pop-up window.</p>\n</li>\n<li>\n<p>Fill in the required fields for the service account details, then\nclick on the <code>CREATE</code> button. </p>\n<pre><code>![image](/src/admin/objectstore/gce/04.png)\n</code></pre>\n</li>\n<li>\n<p>Grant the <em>service account</em> with permission to read/write\nobjects in a bucket under your account (e.g., by assigning the\n<a href=\"https://cloud.google.com/iam/docs/understanding-roles#storage-roles\" target=\"_blank\" rel=\"noopener noreferrer\"><code>Storage Admin</code></a>\nrole to the <em>service account</em>), then click on the <code>CONTINUE</code> button.\nSee the following figure:</p>\n<pre><code>![image](/src/admin/objectstore/gce/05.png)\n\nYou may refer to the [roles documentation page](https://cloud.google.com/iam/docs/understanding-roles)\nfor a complete list of roles and their permissions. \n</code></pre>\n</li>\n<li>\n<p>On the service account page, click on the <code>CREATE KEY</code> button,\nthen choose <code>JSON</code>, and then click on the <code>CREATE</code> button, and then\nclick on the <code>DONE</code> button.</p>\n<pre><code>![image](/src/admin/objectstore/gce/06.png) \n\nThis will create a private key and downloads a json file containing all the \nrequired information to access your Google cloud storage under your account. \n</code></pre>\n</li>\n</ol>\n<h3 id=\"create-a-bucket-for-galaxy\"><a href=\"#create-a-bucket-for-galaxy\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Create a Bucket for Galaxy</h3>\n<ol>\n<li>\n<p>On the <a href=\"https://console.cloud.google.com/\" target=\"_blank\" rel=\"noopener noreferrer\"><em>console page</em></a>, click on the <em>navigation menu</em>\nbutton (<code>â˜°</code>), and go to <code>Storage > Browse</code>. See the following figure:</p>\n<pre><code>![image](/src/admin/objectstore/gce/07.png) \n</code></pre>\n</li>\n<li>\n<p>On the <em>Storage</em> page, click on the <code>CREATE BUCKET</code> button, see the following\nfigure:</p>\n<pre><code>![image](/src/admin/objectstore/gce/08.png) \n\n> Note: in order to create a bucket, you would need to have an active subscription \nand have set-up payment options. \n</code></pre>\n</li>\n<li>\n<p>On the <em>create bucket</em> page, enter the required fields, and note the <strong>bucket name</strong>,\nand then click on the <code>Create</code> button.</p>\n<pre><code>![image](/src/admin/objectstore/gce/09.png)\n</code></pre>\n</li>\n</ol>\n<h2 id=\"step-22-configure-galaxy-objectstore\"><a href=\"#step-22-configure-galaxy-objectstore\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Step 2/2: Configure Galaxy ObjectStore</h2>\n<p>In order to setup Galaxy to persist data on a Google bucket, you may take the\nfollowing steps:</p>\n<ol>\n<li>\n<p>Enable Galaxy ObjectStore configuration by setting the following key\non the <code>config/galaxy.yml</code> file (not <code>config/galaxy.yml.sample</code>):</p>\n<pre><code>object_store_config_file: config/object_store_conf.xml\n</code></pre>\n</li>\n<li>\n<p>Create the <code>object_store_conf.xml</code> file and set it as the following:</p>\n<pre><code class=\"language-xml\">&#x3C;?xml version=\"1.0\"?>\n&#x3C;object_store type=\"cloud\" provider=\"google\">\n    &#x3C;auth credentials_file=\"THE_PATH_TO_THE_JSON_FILE_YOU_OBTAINED_FROM_GOOGLE\" />\n    &#x3C;bucket name=\"BUCKET_NAME\" use_reduced_redundancy=\"False\" />\n    &#x3C;cache path=\"database/object_store_cache\" size=\"1000\" />\n    &#x3C;extra_dir type=\"job_work\" path=\"database/job_working_directory_gce\"/>\n    &#x3C;extra_dir type=\"temp\" path=\"database/tmp_gce\"/>\n&#x3C;/object_store>\n</code></pre>\n<blockquote>\n<p>Note; the above configuration is the minimum set-up required for Galaxy\nto persist data on a Google bucket; for advanced options (e.g., defining a\nhierarchy of multiple backends) see\n<a href=\"/src/admin/objectstore/index.md\">Galaxy ObjectStore configuration page</a>.</p>\n</blockquote>\n</li>\n<li>\n<p>Restart Galaxy for configuration to take place. At this point, any new dataset\nuploaded to Galaxy, or generated by Galaxy (as a result of tool/workflow execution)\nwill be uploaded to the specified bucket. See the following figure: </p>\n<pre><code>![image](/src/admin/objectstore/gce/10.png)\n</code></pre>\n</li>\n</ol>\n"}},"context":{}}