{"hash":"eaf962330836a104724e8b210d95933603316eda","data":{"article":{"id":"93cf7087b095b9429929624d48ae626c","title":"","tease":"","category":null,"date":null,"days":null,"contact":"","contact_url":"","authors":"","location":"","location_url":"","source_blog":"","source_blog_url":"","skip_title_render":null,"redirect":"","links":[],"image":"","images":{},"external_url":"","content":"<div class=\"toc-wrapper col-md-3\">\n<ul>\n<li>\n<p><a href=\"#managing-and-scrambling-galaxy-eggs\">Managing and Scrambling Galaxy Eggs</a></p>\n<ul>\n<li>\n<p><a href=\"#how-to-get-eggs\">How to get eggs</a></p>\n<ul>\n<li><a href=\"#the-first-time-you-run-galaxy\">The first time you run Galaxy</a></li>\n<li><a href=\"#when-you-update-galaxy\">When you update Galaxy</a></li>\n<li><a href=\"#if-your-galaxy-server-does-not-have-internet-access\">If your Galaxy server does not have Internet access</a></li>\n</ul>\n</li>\n<li><a href=\"#how-it-works\">How it works</a></li>\n<li>\n<p><a href=\"#eggsini\">eggs.ini</a></p>\n<ul>\n<li><a href=\"#the-sources-section\">The [sources] section</a></li>\n</ul>\n</li>\n<li><a href=\"#scriptscheck_eggspy\">scripts/check_eggs.py</a></li>\n<li><a href=\"#scriptsfetch_eggspy\">scripts/fetch_eggs.py</a></li>\n<li><a href=\"#scriptsscramblepy\">scripts/scramble.py</a></li>\n<li><a href=\"#scrambling-eggs-for-distribution\">Scrambling Eggs for Distribution</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<div class=\"body-wrapper col-md-9\">\n<h2 id=\"managing-and-scrambling-galaxy-eggs\"><a href=\"#managing-and-scrambling-galaxy-eggs\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Managing and Scrambling Galaxy Eggs</h2>\n<hr>\n<p><a href=\"http://peak.telecommunity.com/DevCenter/PythonEggs\" target=\"_blank\" rel=\"noopener noreferrer\">Python Eggs</a> are Python modules which have been compiled and packaged in to a single file.</p>\n<p>Galaxy depends on a number of external modules. The Galaxy developers provide eggs for a variety of platforms, including 32-bit and 64-bit Linux, Solaris and Mac OS X, under the versions of Python that Galaxy currently supports. These eggs can be downloaded automatically when starting Galaxy.</p>\n<p>Some versions of the modules which Galaxy depends on are not the most recent versions of those modules. We extensively test Galaxy with the module versions we define in the egg configuration file. Using different versions of Galaxy's dependencies can cause Galaxy to break. Please only use the module versions that are intended for your specific revision of Galaxy!</p>\n<h3 id=\"how-to-get-eggs\"><a href=\"#how-to-get-eggs\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>How to get eggs</h3>\n<h4 id=\"the-first-time-you-run-galaxy\"><a href=\"#the-first-time-you-run-galaxy\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>The first time you run Galaxy</h4>\n<p>When you run Galaxy for the first time, it will attempt to automatically download eggs for you from the Galaxy Eggs distribution site. Assuming your platform is supported by the Galaxy developers, this should all go smoothly, and Galaxy will start without any problems.</p>\n<h4 id=\"when-you-update-galaxy\"><a href=\"#when-you-update-galaxy\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>When you update Galaxy</h4>\n<p>Upon updating Galaxy (via <code>hg pull -u</code>), it's possible that an egg has been added, or an existing egg version has changed since your old Galaxy revision. When starting Galaxy after updating, any new eggs that are missing will be downloaded automatically.</p>\n<h4 id=\"if-your-galaxy-server-does-not-have-internet-access\"><a href=\"#if-your-galaxy-server-does-not-have-internet-access\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>If your Galaxy server does not have Internet access</h4>\n<p>Since eggs are downloaded from our repository at <a href=\"http://eggs.g2.bx.psu.edu\" target=\"_blank\" rel=\"noopener noreferrer\">eggs.g2.bx.psu.edu</a>, if your server does not have Internet access, it will not be able to retrieve them. However, we provide a script to fetch the eggs you need from a system that does have Internet access, and then you can transfer those eggs to the Galaxy server. Here's how it works:</p>\n<p>If installing Galaxy for the first time, ensure you have a <code>config/galaxy.ini</code>. You can create <code>config/galaxy.ini</code> by copying it from <code>config/galaxy.ini.sample</code>.</p>\n<pre><code>cp config/galaxy.ini.sample config/galaxy.ini\n</code></pre>\n<p>To create an egg downloader, run:</p>\n<pre><code>python ./scripts/make_egg_packager.py\n</code></pre>\n<p>This creates a script in the current directory, named:</p>\n<pre><code>egg_package-&#x3C;your_platform>.py\n</code></pre>\n<p>This script can be copied to a system with Internet access and executed. It will download all of the eggs for the original platform and place them in an archive named:</p>\n<pre><code>galaxy_eggs-&#x3C;your_platform>.zip\n</code></pre>\n<p>This file should be copied back to the Galaxy server and unzipped in the root of the Galaxy installation, where it will create the <code>eggs/</code> subdirectory.</p>\n<h3 id=\"how-it-works\"><a href=\"#how-it-works\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>How it works</h3>\n<p>For the most part, Galaxy handles your eggs for you. If you are attempting to run Galaxy on a platform which is not supported by the Galaxy developers, you may need more information on the underlying components of Galaxy's egg handling code.</p>\n<h3 id=\"eggsini\"><a href=\"#eggsini\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>eggs.ini</h3>\n<p>The config file which contains all the information needed to maintain the correct versions of eggs, as well as how to build (or \"scramble\") them.</p>\n<p><em>You should not make changes to <code>eggs.ini</code></em>. This is the file which tells Galaxy what versions of its dependencies should be used for your exact revision of Galaxy. Changes will be merged when you update from the upstream source repository and can cause egg information to become incorrect.</p>\n<p>The python scripts below can be run to check, download and build eggs.</p>\n<h4 id=\"the-sources-section\"><a href=\"#the-sources-section\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>The [sources] section</h4>\n<p>Entries in the [sources] section of the config file can be a relative path. If relative, the repo specified under the [general] section will be prepended. Also, if the path specified in the config results in a 404 Not Found error, the build system will try appending (in this order) '.tar.gz', '.tgz', and '.zip' to the path, to make it easier to provide source without having to change file formats. Multiple dependent sources for a single egg can be separated by spaces.</p>\n<h3 id=\"scriptscheck_eggspy\"><a href=\"#scriptscheck_eggspy\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>scripts/check_eggs.py</h3>\n<p>Checks your eggs against the versions listed in <code>eggs.ini</code>. If <code>check_eggs.py</code> determines that eggs are missing or out of date, it will direct you to run <code>fetch_eggs.py</code>.</p>\n<h3 id=\"scriptsfetch_eggspy\"><a href=\"#scriptsfetch_eggspy\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>scripts/fetch_eggs.py</h3>\n<p>Connects to <a href=\"http://eggs.g2.bx.psu.edu/\" target=\"_blank\" rel=\"noopener noreferrer\">the Galaxy Eggs distribution site</a> and downloads any eggs that you need. If eggs for your platform are unavailable, <code>fetch_eggs.py</code> will direct you to run <code>scramble.py</code></p>\n<h3 id=\"scriptsscramblepy\"><a href=\"#scriptsscramblepy\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>scripts/scramble.py</h3>\n<p>Scrambles (builds) eggs for your platform. Using <code>scramble.py</code> should only necessary if pre-built eggs are not available for your platform.</p>\n<p><code>scramble.py</code> uses build scripts in the <code>scripts/scramble/scripts</code> directory to download and build modules. Module source and successfully built binaries of dependencies like PostgreSQL and MySQL are stored in <code>scripts/scramble/archive</code>. The <code>scripts/scramble/build</code> directory contains the latest unpacked/built source for each module you scrambled. Both <code>archives</code> and <code>build</code> can grow quite large over time, so please be aware of this, and clean as necessary.</p>\n<h3 id=\"scrambling-eggs-for-distribution\"><a href=\"#scrambling-eggs-for-distribution\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Scrambling Eggs for Distribution</h3>\n<p>A separate script, <code>scripts/dist-scramble.py</code> exists for building on multiple platforms. This is mostly designed for use by Galaxy Developers at Penn State who are building eggs for distribution via <a href=\"http://eggs.g2.bx.psu.edu\" target=\"_blank\" rel=\"noopener noreferrer\">the Galaxy Eggs distribution site</a>. <code>dist-scramble.py</code> uses the <code>dist-eggs.ini</code> config file to determine what platforms to build for, and which hosts to build on.</p>\n<p><code>dist-scramble.py</code> works the same way as <code>scramble.py</code>:</p>\n<p><code>% python scripts/dist-scramble.py galaxy_egg</code></p>\n<p>Called with only the egg argument, <code>dist-scramble.py</code> will build for all the platforms under the <strong>all</strong> group in its config file (for platform-specific eggs) or the <strong>noplatform</strong> group (for platform-inspecific eggs). The <code>[[hosts]</code>|section contains information about which hosts will be used for building on each desired platform. If you don't want to build for all the platforms listed under the <strong>all</strong> group, you can add a platform argument (any lvalue in the <code>[hosts]]</code> or <code>[groups]</code> section is valid):</p>\n<p><code>% python scripts/dist-scramble.py galaxy_egg linux</code></p>\n<p>The platform argument is ignored for platform-inspecific eggs. An assumption is made that your Galaxy distribution is located at the same place on all of the hosts on which you're building (i.e. via a network filesystem).</p>\n<p>Once <code>dist-scramble.py</code> finishes, it will output a list of platforms on which it failed to scramble the egg. Successful eggs will be put in a new <code>dist-eggs</code> subdirectory of your Galaxy distribution. These eggs can then be copied to your distribution site.</p>\n</div>\n"}},"context":{}}