{"hash":"fe50d2d58b71effa03c01b08cdaab48b91e9d3d3","data":{"article":{"id":"5daf812679df32607889c613c89543e0","title":"","tease":"","category":null,"date":null,"days":null,"contact":"","contact_url":"","authors":"","location":"","location_url":"","source_blog":"","source_blog_url":"","skip_title_render":null,"links":[],"image":"","images":{},"external_url":"","content":"<div class=\"toc-wrapper col-md-3\">\n<ul>\n<li>\n<p><a href=\"#tool-dependencies\">Tool Dependencies</a></p>\n<ul>\n<li><a href=\"#path\">$PATH</a></li>\n<li><a href=\"#galaxy-specific-environment-file\">Galaxy-specific environment file</a></li>\n<li><a href=\"#local-jobs\">Local Jobs</a></li>\n<li><a href=\"#cluster-jobs\">Cluster Jobs</a></li>\n<li><a href=\"#managed-tool-dependencies\">Managed Tool Dependencies</a></li>\n<li><a href=\"#using-the-bin-subdirectory\">Using the bin/ subdirectory</a></li>\n<li><a href=\"#using-the-envsh-file\">Using the env.sh file</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<div class=\"body-wrapper col-md-9\">\n<h2 id=\"tool-dependencies\"><a href=\"#tool-dependencies\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Tool Dependencies</h2>\n<p>Galaxy provides a method for managing the dependencies of Galaxy tools installed from the <a href=\"/toolshed/\">Tool Shed</a>.  In this case, it is simply necessary to set the <code>tool_dependency_dir</code> option of <code>config/galaxy.ini</code> to a path writable by the Galaxy server.</p>\n<p>However, some tools which have not been migrated to the Tool Shed still require manual installation of dependent binaries. In addition, administrators may choose to utilize existing versions of dependencies already installed on the system, rather than rely on versions installed from the Tool Shed. The documentation below covers these cases.</p>\n<p>A list of dependencies for unmigrated tools can be found on the <a href=\"/admin/config/tool-dependencies-list/\">Admin/Tools/Tool-Dependencies-List</a> page.</p>\n<h3 id=\"path\"><a href=\"#path\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>$PATH</h3>\n<p><code>$PATH</code> is the shell environment variable that instructs the shell (i.e. bash) what directories to search for binaries.  Originally, Galaxy expected all binaries to be located on the <code>$PATH</code> set when the Galaxy server starts.  This is still an acceptable method to provide dependencies to Galaxy.  You can manipulate this variable as in this example:</p>\n<pre><code class=\"language-sh\">$ echo $PATH\n/usr/bin:/bin:/usr/sbin:/sbin\n$ type bowtie\nbowtie not found\n$ export PATH=\"/galaxy/software/linux2.6-x86_64/bin:$PATH\"\n$ echo $PATH\n/galaxy/software/linux2.6-x86_64/bin:/usr/bin:/bin:/usr/sbin:/sbin\n$ type bowtie\nbowtie is /galaxy/software/linux2.6-x86_64/bin/bowtie\n</code></pre>\n<h3 id=\"galaxy-specific-environment-file\"><a href=\"#galaxy-specific-environment-file\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Galaxy-specific environment file</h3>\n<p>The galaxy configuration file contains an option <code>environment_setup_file</code> that if set to the path of a file, will cause that file to be sourced prior to running a job. You may find it more convenient to persist your environment changes in this file as opposed to the user's startup files due to the complications described below.</p>\n<h3 id=\"local-jobs\"><a href=\"#local-jobs\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Local Jobs</h3>\n<p>Changes to <code>$PATH</code> can be persisted by setting them in your shell's startup file(s).  This typically means <code>~/.bash_profile</code> for bash, but please see the <a href=\"http://www.gnu.org/software/bash/manual/bashref.html#Bash-Startup-Files\" target=\"_blank\" rel=\"noopener noreferrer\">bash documentation on startup files</a> or the <strong>INVOCATION</strong> section of the <code>bash(1) man</code> page to understand the intricacies of how that file is read.  Of particular importance, if you are starting Galaxy in a method other than manual invocation from a shell prompt (with <code>sh run.sh</code>) such as with an init script, it is likely that your startup file will not be read.  In this instance, you should set <code>$PATH</code> in the startup file or use.</p>\n<h3 id=\"cluster-jobs\"><a href=\"#cluster-jobs\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Cluster Jobs</h3>\n<p>Setting <code>$PATH</code> in your shell startup files may work depending on your DRM - this is how we set up the environment for the <a href=\"http://usegalaxy.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Public Galaxy Site</a> which runs TORQUE PBS.  However, this may not work for other DRMs such as Sun Grid Engine (SGE).  For SGE, please see the <code>-v</code> and <code>-V</code> options to <a href=\"http://gridscheduler.sourceforge.net/htmlman/htmlman1/qsub.html\" target=\"_blank\" rel=\"noopener noreferrer\">qsub</a> and how to set these in <a href=\"http://gridscheduler.sourceforge.net/htmlman/htmlman5/sge_request.html\" target=\"_blank\" rel=\"noopener noreferrer\">sge_request</a> or <a href=\"/admin/config/performance/cluster/\">the job runner URL</a>.</p>\n<h3 id=\"managed-tool-dependencies\"><a href=\"#managed-tool-dependencies\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Managed Tool Dependencies</h3>\n<p>Individual tool configurations should contain <code>&#x3C;requirement type=\"package\"></code> tags which can be used by the tool dependency system.  This system works by taking the following steps:</p>\n<ol>\n<li>Create a directory accessible to Galaxy and any cluster on which Galaxy runs tools</li>\n<li>Set <code>tool_dependency_dir</code> in the Galaxy config file (<code>galaxy.ini</code>) to the above path</li>\n<li>Create a subdirectory of the above directory that matches the string in the <code>&#x3C;requirement></code> tags of tool you want to use</li>\n<li>Create a subdirectory of the subdirectory you just contained matching the version number of the package you have installed or are installing</li>\n<li>Create a symbolic link from the name <code>default</code> to the version directory you just created (this is used for tools which have a package requirement but do not specify a version of that package; most tools behave this way). Note: <code>default</code> <strong>must</strong> be a sybolic link, an actual directory named <code>default</code> will be ignored.</li>\n<li>In the version subdirectory create either:</li>\n</ol>\n<ul>\n<li>a <code>bin/</code> directory or</li>\n<li>an <code>env.sh</code> file as described below</li>\n</ul>\n<p>For example, if the <code>&#x3C;requirement></code> is <code>&#x3C;requirement type=\"package\">bowtie&#x3C;/requirement></code> and you have installed or plan to install version 0.12.7:</p>\n<pre><code class=\"language-sh\">$ cd &#x3C;tool_dependency_dir>\n$ mkdir bowtie\n$ cd bowtie\n$ mkdir 0.12.7\n$ ln -s 0.12.7 default\n</code></pre>\n<h3 id=\"using-the-bin-subdirectory\"><a href=\"#using-the-bin-subdirectory\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Using the bin/ subdirectory</h3>\n<p>Since most *nix tools install to a <code>bin/</code> subdirectory of their package root, a simple shortcut exists for installing tools directly into the <code>tool_dependency_dir</code>.  With the bowtie example above, simply:</p>\n<pre><code class=\"language-sh\">$ cd &#x3C;tool_dependency_dir>/bowtie/0.12.7\n$ mkdir bin\n$ cp /path/to/bowtie-0.12.7_binaries\n</code></pre>\n<p>In this case, Galaxy will prepend <code>&#x3C;tool_dependency_dir>/bowtie/0.12.7/bin</code> to <code>$PATH</code> immediately before it runs the bowtie tool.</p>\n<p>If you prefer, you could also symlink the <code>bin/</code> directory to the location of your bowtie bin directory if you already have bowtie installed elsewhere on your system, or symlink the <code>0.12.7</code> directory to the location of the real bin directory's parent directory.</p>\n<h3 id=\"using-the-envsh-file\"><a href=\"#using-the-envsh-file\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Using the env.sh file</h3>\n<p>For more complete control over how the environment is configured, you can instead choose to create an <code>env.sh</code> file.  This is a file that is sourced (<strong>not</strong> executed) by the shell to set up any appropriate environment variables needed to execute the software.  In the bowtie example, this would be <code>&#x3C;tool_dependency_dir>/bowtie/0.12.7/env.sh</code> and would look like this:</p>\n<pre><code># configure PATH to bowtie binaries\nPATH=\"/path/to/bowtie-0.12.8_binaries:$PATH\"\nexport PATH\n</code></pre>\n<p>This file will then be sourced immediately before Galaxy runs the bowtie tool.  More complex software may require you to set up other environment variables, and <code>env.sh</code> is the appropriate place to do that.</p>\n</div>\n"}},"context":{}}