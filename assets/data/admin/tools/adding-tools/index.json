{"hash":"fe50d2d58b71effa03c01b08cdaab48b91e9d3d3","data":{"article":{"id":"074f414c1bb0f39bc7feff223150eaf6","title":"","tease":"","category":null,"date":null,"days":null,"contact":"","contact_url":"","authors":"","location":"","location_url":"","source_blog":"","source_blog_url":"","skip_title_render":null,"links":[],"image":"","images":{},"external_url":"","content":"<div class=\"toc-wrapper col-md-3\">\n<ul>\n<li>\n<p><a href=\"#creating-a-histogram-tool-tutorial\">Creating a histogram tool tutorial.</a></p>\n<ul>\n<li><a href=\"#introduction\">Introduction</a></li>\n<li><a href=\"#how-galaxy-displays-the-tools\">How Galaxy displays the tools</a></li>\n<li><a href=\"#advanced-topics\">Advanced Topics</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<div class=\"body-wrapper col-md-9\">\n<h1 id=\"creating-a-histogram-tool-tutorial\"><a href=\"#creating-a-histogram-tool-tutorial\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Creating a histogram tool tutorial.</h1>\n<p>See also the general <a href=\"/admin/tools/add-tool-tutorial/\"> tutorial for adding custom tools</a>.</p>\n<h2 id=\"introduction\"><a href=\"#introduction\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Introduction</h2>\n<p>You can think of Galaxy as a web-based framework that allows you to run programs while providing an interface to collect data, select the inputs and parameters, execute processes in the background, save and annotate the results that are produced.</p>\n<p>The most important feature from a developer's perspective is that <strong>everything</strong> that galaxy shows and runs can be <strong>controlled externally</strong> and no knowledge about the internals of the system are necessary to deploy a tool.</p>\n<p>To demonstrate this we'll walk you through the steps of creating a histogram tool, one that generates a histogram based on the values in a text file. First of all you'll need a program that can create histograms of the kind that you need. Let's say this program is called  <strong>histogram</strong> and to create a histogram on column 2 and with 10 bins you would need to run it as:</p>\n<pre><code>histogram -input=genes.bed -col=2 -bins=10 -output=image.png\n</code></pre>\n<p>The actual calling sequence for the program may simpler or a lot more complicated, it does not matter as long as the command can be run from a command line, Galaxy can do it for you too.</p>\n<h2 id=\"how-galaxy-displays-the-tools\"><a href=\"#how-galaxy-displays-the-tools\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>How Galaxy displays the tools</h2>\n<p>To deploy this tool one needs to inform Galaxy about it. This is accomplished by listing it in the main tool configuration file called <strong>tool_conf.xml</strong> found in the main server directory. The contents of this file shown on the left will instruct Galaxy to generate the HTML shown on the right with the Statistics tab expanded:</p>\n<pre><code class=\"language-html\">&#x3C;img src=\"http://www.bx.psu.edu/trac/local/tut_img1.png\"align=\"right\">\n</code></pre>\n<pre><code>&#x3C;?xml version=\"1.0\"?>\n&#x3C;toolbox>\n    &#x3C;section name=\"Data Sources\" id=\"source100\">\n        &#x3C;tool file=\"data_source/upload.xml\"/>\n    &#x3C;/section>\n\n     &#x3C;section name=\"Statistics\" id=\"stat1\">\n        &#x3C;tool file=\"plotting/histogram.xml\"/>\n        &#x3C;tool file=\"plotting/scatter.xml\"/>\n    &#x3C;/section>\n\n     &#x3C;section name=\"Operations on genomic intervals\" id=\"genome1\">\n        &#x3C;tool file=\"operations/complement.xml\"/>\n        &#x3C;tool file=\"operations/restrict.xml\"/>\n    &#x3C;/section>\n\n&#x3C;/toolbox>\n</code></pre>\n<p>Each of the section tags corresponds to a section displayed by Galaxy. Within each section each tool entry points to another xml file that contains the tool specification. In the file above note the line <code>&#x3C;tool file=\"plotting/histogram.xml\"/></code>. This is the individual tool configuration file that is needed to define how the tool is displayed and how it behaves. This file needs to be located in the <code>tools/plotting</code> directory relative to the server root while the content of this file could be the following:</p>\n<pre><code>&#x3C;tool id=\"Histogram1\" name=\"Histogram\">\n  \n    &#x3C;description>for any numeric column&#x3C;/description>\n  \n    &#x3C;command>\n        histogram -input=$input_data -col=$col -bins=$bins -output=$output_data\n    &#x3C;/command>\n    \n    &#x3C;inputs>    \n       &#x3C;param name=\"input_data\"   type=\"data\" format=\"text\" label=\"Select Query\" />    \n       &#x3C;param name=\"col\" size=\"4\" type=\"integer\" value=\"5\" label=\"Column to plot\" />    \n       &#x3C;param name=\"bins\" size=\"4\" type=\"integer\" value=\"10\" label=\"Number of bins\" />\n   &#x3C;/inputs>\n  \n   &#x3C;outputs>  \n       &#x3C;data format=\"png\" name=\"output_data\" />\n   &#x3C;/outputs>\n \n &#x3C;help>\nThis tool builds a simple histogram for a given data column using a specified number of bins:\n\n----\n\n**Syntax**\n\n- **Column to plot** is an integer. The first column is **1**\n- **Number of bins** is an integer between 1 and 99\n\n----\n\n**Example**\n\n.. image:: static/images/histogram.png\n\n&#x3C;/help>\n&#x3C;/tool>\n</code></pre>\n<p>Here is the net result (displayed in the middle frame when the tool is clicked) of this configuration file. The example above is fairly complex since it also contains nicely formatted (but optional) help information that can be deployed with the tool.</p>\n<pre><code class=\"language-html\">&#x3C;p align=\"center\">&#x3C;img src=\"http://www.bx.psu.edu/trac/local/tut_img2.png\" align=\"center\">&#x3C;/p>\n</code></pre>\n<p>Note how the HTML parameters listed within the <code>inputs</code> tag of the XML above generated their corresponding HTML counterparts. The contents of the <code>&#x3C;command></code> tag will be invoked when the <code>Execute</code> button is pressed. The actual values collected from the inputs will be substituted into the command line and executed (<strong>Note:</strong> due to security reasons shell metacharacters will be filtered out and will not be passed down into the command line).</p>\n<h2 id=\"advanced-topics\"><a href=\"#advanced-topics\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Advanced Topics</h2>\n<p>This was just a high level summary of what Galaxy can do; many usage scenarios may be much more complex. <strong>Galaxy</strong> has built-in support for:</p>\n<ul>\n<li><strong>parameter validation</strong> that checks that parameters conform to requirements: integer, float, regular expression match etc. and produces graceful error messages pointing to the error</li>\n<li>Custom code execution at various time points of the workflow that allows a fine grained control over the execution process</li>\n<li>Data deposit protocols for connecting to data repositories</li>\n<li><strong>multi-page parameter selection</strong> for tools that allow subsequent options to depend on previously selected ones</li>\n</ul>\n<p>We'll be adding documentation for these, in the meantime check the <code>tools</code> folder in the server directory containing <strong>hundreds</strong> of examples.</p>\n</div>\n"}},"context":{}}