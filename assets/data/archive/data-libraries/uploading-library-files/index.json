{"hash":"4f66c62fb6940f4cd6ecf5e4a1e2d62361ec5ff4","data":{"article":{"id":"5cc5c6c9d0ae759faffe22dc38bc335f","title":"","tease":"","category":null,"date":null,"days":null,"contact":"","contact_url":"","fileInfo":{"path":"build/content-md/archive/data-libraries/uploading-library-files/index.md"},"authors":"","location":"","location_url":"","source_blog":"","source_blog_url":"","skip_title_render":null,"redirect":"","autotoc":null,"links":[],"image":"","images":{},"external_url":"","content":"<div class=\"toc-wrapper col-md-3\">\n<ul>\n<li>\n<p><a href=\"#uploading-files-to-a-data-library\">Uploading Files to a Data Library</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#options-for-uploading-files-from-the-admin-perspective\">Options for Uploading Files from the Admin Perspective</a></li>\n<li><a href=\"#upload-files\">Upload files</a></li>\n<li><a href=\"#upload-directory-of-files\">Upload directory of files</a></li>\n<li><a href=\"#upload-files-from-filesystem-paths\">Upload files from filesystem paths</a></li>\n<li><a href=\"#import-datasets-from-your-current-history\">Import datasets from your current history</a></li>\n<li><a href=\"#options-for-uploading-files-from-the-data-libraries-view\">Options for Uploading Files from the Data Libraries View</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div>\n<div class=\"body-wrapper col-md-9\">\n<h1 id=\"uploading-files-to-a-data-library\"><a href=\"#uploading-files-to-a-data-library\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Uploading Files to a Data Library</h1>\n<hr>\n<h3 id=\"options-for-uploading-files-from-the-admin-perspective\"><a href=\"#options-for-uploading-files-from-the-admin-perspective\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Options for Uploading Files from the Admin Perspective</h3>\n<p>There are currently four options available to a Galaxy <a href=\"/admin/\">admin</a> user for uploading files to a data library.\nSome of these same options are available to all regular users that have been granted permission to add items to a Data Library or folder,\nbut this section describes the features from the Galaxy admin perspective which is accessed by clicking on the \"Admin\" link in the top\nGalaxy menu bar.</p>\n<p>By default, only the first option (Upload files) is available. To allow uploading directory of files or upload from from filesystem paths, change the options <code>library_import_dir</code> and <code>allow_library_path_paste</code>, respectively in the Data Libraries section of your config (<code>config/galaxy.ini</code> or <code>config/galaxy.ini</code>) See below for more details on the values for these options.</p>\n<p>From the Data Library, clicking the Add datasets button will display this page (this same process for uploading files to a folder is\naccessed from the folder's pop-up menu).</p>\n<p><code>![](/src/data-libraries/upload_form.png)</code></p>\n<p>The different options for uploading files are available in the pop-up menu when you click the \"down arrow\" next to the\n\"Create new data library datasets\" page title.</p>\n<p><code>![](/src/data-libraries/upload_options.png)</code></p>\n<p>Here are the details for each option.</p>\n<h3 id=\"upload-files\"><a href=\"#upload-files\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Upload files</h3>\n<p>This is the default, and displays the form above.  It enables you to upload locally accessible files, or URLs for retrieving data\nfrom remote sources.  This option creates a copy of the data files on the Galaxy server (the default directory is <code>database/files/</code>),\nand although it works for files of any size, the options described below are better suited for very large files.</p>\n<h3 id=\"upload-directory-of-files\"><a href=\"#upload-directory-of-files\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Upload directory of files</h3>\n<p>Here is a partial view of the form that is displayed when this option is selected.</p>\n<p><code>![](/src/data-libraries/upload_directory.png)</code></p>\n<p>The desired directory for this option must be specified in the Galaxy configuration file <code>config/galaxy.ini</code>.</p>\n<pre><code># Directories of files contained in the following directory can be uploaded to a library from the Admin view\nlibrary_import_dir = /some_local_directory_of_files\n</code></pre>\n<p>The setting for <code>library_import_dir</code> should be a directory that contains files or other directories, the contents of which can be\nselected for upload to the Data Library.</p>\n<p>The above form also includes a checkbox labeled \"Copy data into Galaxy?\" that, if checked, will prevent Galaxy from copying data\nto its files directory.  This is useful for large library datasets that live in their own managed locations on the filesystem, and will\nprevent the existence of duplicate copies of datasets.  However, using this feature requires administrators to take responsibility for\nmanaging these files - moving or removing the data from its Galaxy-external location will render these datasets invalid within Galaxy.</p>\n<p>Also, when the \"Copy data into Galaxy?\" checkbox is checked, any symbolic links encountered in the chosen import directory will be\nmade absolute and dereferenced <strong>once</strong>.  This allows administrators to link large datasets to the import directory rather than having\nto make copies of the files, and these links can be deleted after importing.  Only the first symlink (the one in the import directory\nitself) is dereferenced, all others remain.  Here is an example:</p>\n<pre><code>library_import_dir = /galaxy/import\n\n% ls -lR /galaxy/import\n/galaxy/import:\ntotal 6\ndrwxr-xr-x   2 nate     nate         512 Oct  1 11:31 link/\n\n/galaxy/import/link:\ntotal 10\nlrwxrwxrwx   1 nate     nate          71 Oct  1 10:38 1.bed -> ../../../home/nate/galaxy/test-data/1.bed\nlrwxrwxrwx   1 nate     nate          60 Oct  1 10:38 2.bed -> /home/nate/galaxy/test-data/2.bed\nlrwxrwxrwx   1 nate     nate          11 Oct  1 10:38 3.bed -> ../../3.bed\nlrwxrwxrwx   1 nate     nate          35 Oct  1 11:30 4.bed -> ../../galaxy_symlink/test-data/4.bed\nlrwxrwxrwx   1 nate     nate          41 Oct  1 11:31 5.bed -> /galaxy/galaxy_symlink/test-data/5.bed\n\n% ls -l /galaxy/3.bed\nlrwxrwxrwx   1 nate     nate          60 Oct  1 10:39 /galaxy/3.bed -> /home/nate/galaxy/test-data/3.bed\n\n% ls -l /galaxy/galaxy_symlink\nlrwxrwxrwx   1 nate     nate          44 Oct  1 11:30 /galaxy/galaxy_symlink -> /home/nate/galaxy/\n</code></pre>\n<p>In this example:</p>\n<ul>\n<li><code>1.bed</code> is a relative symbolic link to the real <code>1.bed</code>.</li>\n<li><code>2.bed</code> is an absolute symlink to the real <code>2.bed</code>.</li>\n<li><code>3.bed</code> is a relative symlink to <code>../../3.bed</code>, aka <code>/galaxy/3.bed</code>, which itself is a symlink to the real <code>3.bed</code>.</li>\n<li><code>4.bed</code> is a relative symlink which follows another symlink (<code>/galaxy/galaxy_symlink</code>) to the real <code>4.bed</code>.</li>\n<li><code>5.bed</code> is an absolute symlink in the same fashion as <code>4.bed</code></li>\n</ul>\n<p>If the <code>link</code> server directory is selected in the \"Server Directory\" select list and the \"Copy data into Galaxy?\"\ncheckbox is checked, then the following files will be referenced by Galaxy:</p>\n<pre><code>/home/nate/galaxy/test-data/1.bed\n/home/nate/galaxy/test-data/2.bed\n/galaxy/3.bed\n/galaxy/galaxy_symlink/test-data/4.bed\n/galaxy/galaxy_symlink/test-data/5.bed\n</code></pre>\n<p>The Galaxy administrator may now safely delete <code>/galaxy/import/link</code>, but should take care not to remove the referenced\nsymbolic links ( <code>/galaxy/3.bed</code> and <code>/galaxy/galaxy_symlink</code> ).</p>\n<p>Not all symbolic links are dereferenced because it is assumed that if an administrator links to a path in the import\ndirectory which itself is (or contains) links, that is the preferred path for accessing the data.</p>\n<h3 id=\"upload-files-from-filesystem-paths\"><a href=\"#upload-files-from-filesystem-paths\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Upload files from filesystem paths</h3>\n<p>Here is a partial view of the form that is displayed when this option is selected. Please note that files and directories must be uncompressed to be included in a library.</p>\n<p><code>![](/src/data-libraries/upload_filesystem_paths.png)</code></p>\n<p>This form contains a text area that allows for pasting any number of filesystem paths (files or directories) from which\nGalaxy will import library datasets, saving the directory structure if desired.  Since this allows a Galaxy admin user access to any file (on the Galaxy server) which is readable by the Galaxy system user, this option is disabled by default, and system administrators should take care in assigning Galaxy admin users when this feature is enabled.  Controls on what files are accessible to this tool based on ownership or other properties can be added at a later date if there is sufficient interest in them by the community.</p>\n<p>This needs to be enabled in the Galaxy configuration file <code>config/galaxy.ini</code>.</p>\n<pre><code>allow_library_path_paste = True\n</code></pre>\n<h3 id=\"import-datasets-from-your-current-history\"><a href=\"#import-datasets-from-your-current-history\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Import datasets from your current history</h3>\n<p>This option display a list of the items in your current history, allowing you to select any number of files for uploading into\nthe data library.  This option creates a copy of the data files on the Galaxy server.</p>\n<h3 id=\"options-for-uploading-files-from-the-data-libraries-view\"><a href=\"#options-for-uploading-files-from-the-data-libraries-view\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Options for Uploading Files from the Data Libraries View</h3>\n<p>to be completed...</p>\n</div>\n"}},"context":{}}