(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{UQSp:function(e,t,a){"use strict";t.a={name:"VueRemarkRoot",render:function(e){return e("div",null,this.$slots.default)}}},ZL5j:function(e,t,a){"use strict";a.r(t);var s=a("KHd+"),i=a("UQSp"),o=a("Kw5r");function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}o.a.config.optionMergeStrategies;var r={VueRemarkRoot:i.a},u=function(e){var t=e.options.components=e.options.components||{},a=e.options.computed=e.options.computed||{};Object.keys(r).forEach((function(e){"object"===n(r[e])&&"function"==typeof r[e].render||"function"==typeof r[e]&&"function"==typeof r[e].options.render?t[e]=r[e]:a[e]=function(){return r[e]}}))},d=o.a.config.optionMergeStrategies,c="__vueRemarkFrontMatter",l={excerpt:null};var h=function(e){e.options[c]&&(e.options[c]=l),o.a.util.defineReactive(e.options,c,l),e.options.computed=d.computed({$frontmatter:function(){return e.options[c]}},e.options.computed)},f=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("VueRemarkRoot",[e._t("/admin/linkbox"),a("h1",{attrs:{id:"data-management-accounting-and-disk-quotas"}},[a("a",{attrs:{href:"#data-management-accounting-and-disk-quotas","aria-hidden":"true"}},[a("span",{staticClass:"icon icon-link"})]),e._v("Data management: accounting and disk quotas")]),a("p",[e._v("Before tackling quotas or disk accounting, it's important to understand that when data is copied in Galaxy it is never duplicated.  This means that importing a dataset from a Data Library, sharing datasets with another user, or making copies of your datasets within your own histories only creates new references to the original file.")]),a("p",[e._v("It's now possible for users to force datasets to be removed from disk, which was previously only done by cleanup scripts.  This is explained in detail at "),a("a",{attrs:{href:"/learn/managing-datasets/#actions"}},[e._v("Managing Datasets")]),e._v(".")]),a("h2",{attrs:{id:"disk-accounting"}},[a("a",{attrs:{href:"#disk-accounting","aria-hidden":"true"}},[a("span",{staticClass:"icon icon-link"})]),e._v("Disk Accounting")]),a("p",[e._v("Galaxy keeps track of how much data is used by each dataset, and makes this information available in a couple of ways.  The first is as a total amount of disk space used by the user.  The second is the amount of disk space used by a single history.  These numbers may not always agree, and here's why:")]),a("p",[e._v("The total amount of disk space used by a user is calculated by finding all "),a("em",[e._v("unique")]),e._v(" datasets for which the user has an association (i.e. it's in a history) which are not in a library and which have not yet been purged.  The implications of this are:")]),a("ul",[a("li",[e._v('A dataset for which a user has multiple associations (a dataset has been "copied" from one history to another, or the same history) will only be counted once')]),a("li",[e._v("Datasets imported from a Data Library never count against a user's total disk usage")]),a("li",[e._v("Datasets which have been deleted but not yet removed from disk still count against a user's total disk usage")])]),a("p",[e._v("User disk usage is stored in a column in the galaxy_user table of the database and is updated whenever a user acquires new unique data or purges data.")]),a("p",[e._v("Likewise, the total amount of disk space used by a single history is calculated by finding all "),a("em",[e._v("unique")]),e._v(" datasets for which the user has an association and which have not yet been purged.  Note the slightly different implications:")]),a("ul",[a("li",[e._v("A dataset for which a user has multiple associations will be counted only once in each history in which it appears")]),a("li",[e._v("Datasets imported from a Data Library do count in the history usage total")])]),a("p",[e._v('History disk usage is calculated "on the fly" via a database query that sums the usage of all containing datasets.')]),a("p",[e._v("Galaxy defines two classes of users: unregistered/anonymous and registered.  When determining the disk usage of an unregistered user, the history usage is used since unregistered users can only have one history.")]),a("p",[e._v("There are two scripts in the Galaxy source which assist with managing disk accounting:")]),a("ul",[a("li",[a("code",{pre:!0},[e._v("galaxy-dist/scripts/set_dataset_sizes.py")]),e._v(" - recalculate the disk usage of all datasets in the Galaxy instance, most useful if you had a Galaxy instance that predated the disk accounting code added in changeset 5700:70e2b1c95a69 on June 14, 2011")]),a("li",[a("code",{pre:!0},[e._v("galaxy-dist/scripts/set_user_disk_usage.py")]),e._v(" - recalculate one or all users' disk usage, also useful if your Galaxy installation predates disk accounting, and also useful in cases where a user's usage seems to be incorrect (i.e. you've found a bug in disk accounting) and needs to be recalculated")])]),a("h2",{attrs:{id:"quotas"}},[a("a",{attrs:{href:"#quotas","aria-hidden":"true"}},[a("span",{staticClass:"icon icon-link"})]),e._v("Quotas")]),a("p",[e._v('Users are assigned quotas are configured by creating Quota definitions and then associating these definitions with users or groups.  Quota definitions consist of a name, optional description, amount, and an operation (one of "=", "+", or "-").  Default quotas can be specified for both classes of users: unregistered and registered.')]),a("p",[e._v("The first step in managing quotas is to enable them by setting the following in "),a("code",{pre:!0},[e._v("galaxy.yml")]),e._v(":")]),a("pre",[a("code",{pre:!0,attrs:{class:"language-yaml"}},[e._v("galaxy:\n  enable_quotas: true\n  allow_user_dataset_purge: true\n")])]),a("p",[a("code",{pre:!0},[e._v("allow_user_dataset_purge")]),e._v(" is not explicitly required for quotas but strongly encouraged, since without it users will have to wait for cleanup scripts to expire and purge their data to lower their disk usage.")]),a("p",[e._v("Once enabled, you can create quotas in the "),a("a",{attrs:{href:"/admin/"}},[e._v("administration interface")]),e._v(' by clicking the link for "Manage quotas" in the left panel.  Quotas can have one of three "operations":')]),a("ul",[a("li",[a("code",{pre:!0},[e._v("=")]),e._v(" : The quota is exactly the amount specified")]),a("li",[a("code",{pre:!0},[e._v("+")]),e._v(" : The amount specified will be added to the amounts of the user's other associated quota definitions")]),a("li",[a("code",{pre:!0},[e._v("-")]),e._v(" : The amount specified will be subtracted from the amounts of the user's other associated quota definitions")])]),a("p",[e._v("The logic used when determining a user's quota is the following:")]),a("ul",[a("li",[e._v('Anonymous/unregistered users get the quota specified as the "default for unregistered users" or unlimited if no default is set')]),a("li",[e._v("Registered users:"),a("ol",[a("li",[e._v('Get a "base quota" determined by finding all directly associated quota definitions with an '),a("strong",[e._v("=")]),e._v(" operation and setting it to the one with the largest amount")]),a("li",[e._v("If any directly associated quota is found with an "),a("strong",[e._v("=")]),e._v(" operation and "),a("strong",[e._v("unlimited")]),e._v(" amount, the user has no quota")]),a("li",[e._v("If the user has no "),a("strong",[e._v("=")]),e._v(' quotas directly associated, his or her base quota is set to the amount of the "default for registered users" quota, if it exists')]),a("li",[e._v("If the user has no "),a("strong",[e._v("=")]),e._v(' quotas directly associated and no "default for registered users" quota is set, the user has no quota')]),a("li",[e._v("The base quota is increased or decreased by the amount of any "),a("strong",[e._v("+")]),e._v(" or "),a("strong",[e._v("-")]),e._v(" operation quota with which they are associated")])])])])],2)}),[],!1,null,null,null);"function"==typeof u&&u(f),"function"==typeof h&&h(f);t.default=f.exports}}]);